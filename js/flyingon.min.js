/*
* flyingon javascript library v0.0.1.0
* https://github.com/freeoasoft/flyingon
*
* Copyright 2014, yaozhengyang
* licensed under the MIT license
*/
"use strict";var flyingon;!function(t){"function"==typeof require&&"object"==typeof module&&module?t(module.exports=flyingon={}):"function"==typeof define&&define.amd?(flyingon={},define(function(e,i,n){t(n.exports=flyingon)})):t(flyingon=window.flyingon||(window.flyingon={}))}(function(t){function e(){}t.version="1.0.1",t.create=Object.create||function(t){return t?(e.prototype=t,new e):{}},t.extend=function i(t,e,n){var r,s=arguments.length-1;for(t=t||{},arguments[s]===!0&&(n=!0,s--);s>0&&(r=arguments[s--]);)if(n)for(var o in r){var a=r[o];a&&"object"==typeof a?t[o]=i(t[o],a,!0):t[o]=a}else for(var o in r)t[o]=r[o];return t},t.each=function(e,i,n){if(e){"string"==typeof e&&(e=e.match(/\w+/g));for(var r=0,s=e.length;r<s;r++)i.call(n||t,e[r],r)}}}),function(t){function e(t){var e,i,n,r=B;if(i=r[t])return i;if(e=t.match(/\w+/g)){i=j[j.length-1]||r;for(var s=0,o=e.length;s<o;s++)(n=i[t=e[s]])?i=n:(n=(n=i.moduleName)?n+"."+t:t,i=r[n]=i[t]=L(null),i.moduleName=n);return i}throw"module name can use only letters and numbers!"}function i(e,i){try{j.push(N=e),i.call(e,e,t)}finally{t.endModule()}}function n(e,i,n,h){function f(){var t=this.init;t&&t.apply(this,arguments)}var f,v,H,B,j,O;return H=L(v=i.prototype||Object.prototype),H.base=v,O=!v.__flyingon_class,(h||null==h&&O||v.__defaults)&&(H.__defaults=L(v.__defaults||null),H.__properties=L(v.__properties||null),O&&(H.defineProperty=l,H.storage=c,H.get=u,H.set=d,H.defaultValue=_,H.properties=g,H.getOwnPropertyNames=C,H.notify=p,H.watch=y,H.unwatch=m)),O&&(H.__flyingon_class=!0,H.on=w,H.once=b,H.off=x,H.trigger=k,H.is=o,H.toString=a,H.dispose=T),B=N||t,j=e?B.moduleName+"-"+e:"anonymous-type-"+S++,H[j]=!0,H.Class=H.constructor=f,f.__class_fn=n,H.init=r,e&&(f.typeName=e,B[e]=z[j]=f),f.fullName=j,f.prototype=H,f.module=B,f.superclass=i,f.register=i.register||P,f.init=s,f.extend=Object.extend,f}function r(){var t;this.Class.init(),(t=this.init)&&t.apply(this,arguments)}function s(){var t,e=this.prototype,i=e.base;return(t=this.superclass)&&t.__class_fn&&t.init(),(t=this.__class_fn)&&(t.call(e,i,e),(t=e.__class_init)&&t.call(e,this,i,e),delete this.__class_fn,e.init===r&&delete e.init),this}function o(t){return t&&(this instanceof t||(t=t.fullName)&&this[t])}function a(){return"[object "+this.fullName+"]"}function l(t,e,i){var n,r;if(!/^[a-z][\w$]*$/.test(t))throw'property name "'+t+'" is not legal!';return i?i.name=t:i={name:t},"function"==typeof e?(i.fn=e,i.defaultValue=e=null):i.defaultValue=e,(this.__defaults||(this.__defaults=L(null)))[t]=e,(this.__properties||(this.__properties=L(null)))[t]=i,(r=i.dataType)||(r=i.dataType=typeof e),this[t]=n=i.fn||h(t,r,i.check,i.set),n.property=!0,(r=this.__selector_extend)&&((r.prototype||r)[t]=f(t)),n}function h(t,e,i,n){return function(r){var s=this.__storage,o=t,a=(s||this.__defaults)[o];if(void 0===r)return a;switch(e){case"boolean":r=!!r&&"false"!==r;break;case"int":r=0|r;break;case"number":r=+r||0;break;case"string":r=""+r;break;case"date":r=r?Date.create(r):null}return i&&(r=i.call(this,r)),a!==r&&((s||(this.__storage=L(this.__defaults)))[o]=r,n&&n.call(this,r,a),(s=this.__watches)&&(s[o]||s["*"])&&this.notify(o,r,a)),this}}function f(t){return function(e){var i,n,r=0,s=t;if(void 0===e)for(;i=this[r++];)if(n=i[s])return n.call(i);for(;i=this[r++];)(n=i[s])&&n.apply(i,arguments);return this}}function c(){return this.__storage||(this.__storage=L(this.__defaults))}function u(t){var e;return void 0!==(e=(this.__storage||this.__defaults)[t])?e:(e=this.__custom_get)?e.call(this,t):void 0}function d(t,e){var i;return(i=this[t])&&i.property?i.call(this,e):(i=this.__custom_set)?i.call(this,t,e):(this.__storage||(this.__storage=L(this.__defaults)))[t]=e,this}function _(e,i){var n=this.__defaults;return void 0===i?n[e]:(n[e]=i,n=this.__properties,(n[e]=t.extend({},n[e])).defaultValue=i,this)}function g(t,e){var i,n=this.__properties,r=[];"function"==typeof t&&(e=t),t=t===!1?this.base.__properties:null;for(var s in n)!(i=n[s])||t&&t[s]===i||e&&!e(i)||r.push(i);return r}function p(t,e,i){var n,r=this.__watches;return r&&((n=r[t])&&v.call(this,n,t,e,i),"*"!==t&&(n=r["*"])&&v.call(this,n,"*",e,i)),this}function v(t,e,i,n){var r=t[0],s=1;for(r&&this.pushBack(r,i);r=t[s++];)r.call(this,e,i,n)}function y(t,e){if("function"==typeof t)e=t,t="*";else if("function"!=typeof e)return;var i=this.__watches||(this.__watches={}),n=i[t];return n?n.push(e):i[t]=["",e],this}function m(t,e){"function"==typeof t&&(e=t,t="*");var i,n=this.__watches;if(n&&(i=n[t])){if(e)for(var r=i.length-1;r>=1;r--)i[r]===e&&i.splice(r,1);else i.splice(r,1);1!==i.length||i[0]||delete n[t]}return this}function w(t,e){if(t&&"function"==typeof e){var i=this.__events||(this.__events=L(null));(i[t]||(i[t]=[])).push(e),(e=this.__event_on)&&e.apply(this,t)}return this}function b(t,e){function i(){e.apply(n,arguments),n.off(t,i)}var n=this;return this.on(t,i)}function x(t,e){var i,n=this.__events;if(n){if(t)if(e){if(i=n[t]){for(var r=i.length-1;r>=0;r--)i[r]===e&&i.splice(r,1);i.length||(n[t]=null)}}else n[t]&&(n[t]=null);else{for(var t in n)this.off(t);this.__events=null}(e=this.__event_off)&&e.call(this,t)}return this}function k(e){var i,n,r,s,o,a=e.type||(e=new t.Event(e)).type,l=1;for(e.target=this;i=arguments[l++];)e[i]=arguments[l++];i=n=t;do{if((r=n.__events)&&(r=r[a])&&(s=r.length)){l=0;do if((o=r[l++])&&!o.disabled&&(o.call(n,e)===!1&&(e.defaultPrevented=!0),e.cancelBubble))return!e.defaultPrevented;while(l<s)}if(i!==n)n=(o=n.eventBubble)&&n[o];else{if(i===this)break;n=this}}while(n);return!e.defaultPrevented}function C(){var t,e,i=this.__storage;if(i){if(e=Object.getOwnPropertyNames)return e(i);t=this.__defaults,e=[];for(var n in i)i[n]!==t[n]&&e.push(n);return e}return[]}function T(){return this.__events&&this.off(),this}function P(t,e){if(t||(t=this.typeName)){if(!e&&z[t])throw'component "'+t+'" has exist';return z[this.nickName=t]=this}return this}var N,L=t.create,H=(t.extend,[].slice),z=t.components||(t.components=L(null)),S=1,B=L(null),j=[],O=t.fragments||(t.fragments=L(null)),A="class name can use only letters and numbers and begin with a upper letter!",W="class fn must be a function!";t.moduleName="flyingon",t.className="f",B.flyingon=t,t.use=function(i){switch(typeof i){case"string":return e(i);case"object":return i||t}return t},t.defineModule=function(n,r){var s,o;switch(typeof n){case"string":s=e(n);break;case"function":s=N||t,r=n;break;case"object":s=n||t;default:s=t}return"function"==typeof r?(o=t.require)&&(o=o.callback)&&o(i,[s,r])||i(s,r):j.push(N=s),s},t.endModule=function(){var e=j;return e.pop(),N=e[e.length-1]||t},t.fragment=function(t,e){var i;"function"==typeof e?O[t]=e:(i=O[t])&&i.apply(e,H.call(arguments,2))},t.defineClass=function(t,e,i,r){if("string"!=typeof t)r=i,i=e,e=t,t=null;else if(!/^[A-Z]\w*$/.test(t))throw A;if("function"!=typeof i){if("function"!=typeof e)throw W;r=i,i=e,e=Object}else e&&"function"==typeof e||(e=Object);return n(t,e,i,r)},Object.extend=function(t,e,i){if("string"!=typeof t)i=e,e=t,t=null;else if(!/^[A-Z]\w*$/.test(t))throw A;if("function"!=typeof e)throw W;return n(t,this,e,i)},Object.extend._=function(t,e){function i(){}e||(e=t,t=Object);var n=t.prototype,r=i.prototype=L(n);return r.Class=i,e.call(r,n,r),i},t.defaultValue=function(t,e,i){var n,r=(t=t.prototype||t).__properties;if(r&&(n=r[e])){if(void 0===i)return n.defaultValue;if(typeof i!==n.dataType)throw"type is defferent!";n.defaultValue=t.__defaults[e]=i}},t.on=w,t.once=b,t.off=x,t.trigger=k}(flyingon),Object.extend("Event",function(){this.init=function(t){this.type=t},this.type=null,this.target=null,this.cancelBubble=!1,this.defaultPrevented=!1,this.stop=function(t){return this.cancelBubble=!0,t&&(this.defaultPrevented=!0),arguments[1]!==!1&&this.original_event&&flyingon.dom_stop(this.original_event,t),this},this.prevent=function(){return this.defaultPrevented=!0,arguments[0]!==!1&&this.original_event&&flyingon.dom_prevent(this.original_event),this}},!1),flyingon.encode=function t(e){if(!e)return"";var i,n,r=[],s=encodeURIComponent;for(var o in e)if(i=e[o],o=s(o),null!==i)switch(typeof i){case"undefined":r.push(o,"=&");break;case"boolean":case"number":r.push(o,"=",i,"&");break;case"string":case"function":r.push(o,"=",s(i),"&");break;default:if(i instanceof Array)for(var a=0,l=i.length;a<l;a++)void 0===(n=i[a])?r.push(o,"=&"):r.push(o,"=",s(n),"&");else r.push(o,"=",t(i),"&")}else r.push(o,"=null","&");return r.pop(),r.join("")},flyingon.html_encode=function(){var t=flyingon.create(null);return t["&"]="&amp;",t["<"]="&lt;",t[">"]="&gt;",t["'"]="&apos;",t['"']="&quot;",function(e){if(e&&"string"==typeof e){var i=t;return e.replace(/([&<>'"])/g,function(t,e){return i[e]})}return""+e}}(),flyingon.html_decode=function(){var t=flyingon.create(null);return t.amp="&",t.lt="<",t.gt=">",t.apos="'",t.quot='"',function(e){var i=t;return e&&e.replace(/&(\w+);/g,function(t,e){return i[e]||e})}}(),flyingon.parseJSON="undefined"!=typeof JSON?function(t){return JSON.parse(t)}:function(t){if("string"==typeof t){if(/[a-zA-Z_$]/.test(t.replace(/"(?:\\"|[^"])*?"|null|true|false|\d+[Ee][-+]?\d+/g,"")))throw"json parse error!";return new Function("return "+t)()}return t},flyingon.Async=Object.extend(function(){function t(t,e,n,r){if(n||(n=e,e=!1),n){var s=t.__list||(t.__list=[]);s.push([e,n,r,0]),t.__state&&i(t)}return t}function e(t,e,n,r){t.__list;return t.__state=e,t.__value=n,t.__error=r,i(t),t}function i(t){var e,n,r=t.__list,s=0;if(r){for(;e=r[s++];){if(!e[0]&&(s>1||e[3]))return;if(!e[3]){if("function"==typeof(n=e[1]))try{switch(e[2]){case 1:n=1===t.__state&&n.call(t,t.__value);break;case 2:n=2===t.__state&&n.call(t,t.__error);break;case 3:n=n.call(t,t.__value,t.__error)}}catch(o){t.__state=2,t.__error=o,r.splice(0,s),s=0;continue}n&&n["flyingon.Async"]&&!n.__state?(e[3]=1,(n.__back_list||(n.__back_list=[])).push(r,e,t)):r.splice(--s,1)}}if(r.length>0)return;s=0}if(r=t.__back_list){for(;e=r[s++];)e.splice(e.indexOf(r[s++]),1),e=r[s++],t.__error&&t.bubble&&(e.__state=2,e.__error=t.__error),i(e);r.length=0,t.__back_list=null}}this.sleep=function(e,i,n){if(i!==!1||n!==!1){var r=function(t){var i=new flyingon.Async;return setTimeout(function(){i.resolve(t),i=null},0|e),i};return i=i!==!1?1:0,n!==!1&&(i+=2),t(this,!1,r,i)}return this},this.done=function(e,i){return t(this,e,i,1)},this.fail=function(e,i){return t(this,e,i,2)},this.complete=function(e,i){return t(this,e,i,3)},this.resolve=function(t){return e(this,1,t)},this.reject=function(t,i){return this.bubble=i,e(this,2,void 0,t)},this.progress=function(t){return"function"==typeof t&&(this.__progress||(this.__progress=[])).push(t),this},this.notify=function(t){var e=this.__progress;if(e)for(var i=0,n=e.length;i<n;i++)e[i].call(this,t);return this}},!1),flyingon.delay=function(t,e){var i=new flyingon.Async;return setTimeout(function(){"function"==typeof e?(e.call(i),e=null):i.resolve(),i=null},0|t),i},function(){this.pair=function(t){var e=flyingon.create(null);void 0===t&&(t=!0);for(var i=0,n=this.length;i<n;i++)e[this[i]]=t;return e},this.indexOf||(this.indexOf=function(t,e){if((e|=0)<0)return-1;for(var i=this.length;e<i;){if(this[e]===t)return e;e++}return-1}),this.lastIndexOf||(this.lastIndexOf=function(t,e){if((e|=0)>0)return-1;if(!e){if(arguments.length>1)return-1;e=-1}for(e+=this.length;e>=0;){if(this[e]===t)return e;e--}return-1}),this.forEach||(this.forEach=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)t.call(e,this[i],i,this)}),this.map||(this.map=function(t){for(var e=arguments[1],i=this.length,n=new Array(i),r=0;r<i;r++)n[r]=t.call(e,this[r],r,this);return n}),this.filter||(this.filter=function(t){for(var e=arguments[1],i=[],n=0,r=this.length;n<r;n++)t.call(e,this[n],n,this)&&i.push(this[n]);return i}),this.some||(this.some=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)if(t.call(e,this[i],i,this))return!0;return!1}),this.every||(this.every=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)if(!t.call(e,this[i],i,this))return!1;return!0}),this.reduce||(this.reduce=function(t){var e=arguments[1],i=0,n=this.length;for(void 0===e&&(e=this[0],i=1);i<n;)e=t(e,this[i],i++,this);return e}),this.reduceRight||(this.reduceRight=function(t){var e=arguments[1],i=this.length-1;for(void 0===e&&(e=this[i--]);i>=0;)e=t(e,this[i],i--,this);return e})}.call(Array.prototype),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(arguments.length>1){var i=[].slice.call(arguments,1),n=i.push;return function(){var r=i.slice(0);return arguments.length>0&&n.apply(r,arguments),e.apply(t||this,r)}}return function(){return e.apply(t||this,arguments)}}),function(){var t=/([yMdhmsSq]+)/g,e={GMT:"toGMTString",ISO:"toISOString",UTC:"toUTCString",date:"toDateString",time:"toTimeString",locale:"toLocaleString","locale-date":"toLocaleDateString","locale-time":"toLocaleTimeString"},i={y:"getFullYear",d:"getDate",h:"getHours",m:"getMinutes",s:"getSeconds",S:"getMilliseconds"};this.format=function(n){var r;return n?(r=e[n])?this[r]():(r=this,n.replace(t,function(t,e){var n=e.length;switch(e=e.charAt(0)){case"M":e=r.getMonth()+1;break;case"q":e=(r.getMonth()+3)/3|0;break;default:e=r[i[e]]()}return e=""+e,1===n||(n-=e.length)<=0?e:"0000".substring(0,n)+e})):this.toString()},this.addYear=function(t){return this.setFullYear(this.getFullYear()+(0|t)),this},this.addMonth=function(t){return this.setMonth(this.getMonth()+(0|t)),this},this.addDate=function(t){return this.setDate(this.getDate()+(0|t)),this},Date.create=function(t){if(t){var e=new Date(t),i=e.valueOf();if(i===i)return e;if("string"==typeof t&&(t=t.match(/\d+/g)))return i=0|t[1],new Date(t[0],i>0?i-1:0,0|t[2],0|t[3],0|t[4],0|t[5])}return null}}.call(Date.prototype),flyingon.fragment("f-collection",function(){var t=Array.prototype;this.length=0,this.indexOf=this.lastIndexOf=[].indexOf,this.push=function(){return arguments.length>0&&(this.__check_items(this.length,arguments,0),t.push.apply(this,arguments)),this.length},this.pop=function(){var e=t.pop.call(this);return e&&this.__remove_items(this.length-1,[e]),e},this.unshift=function(){return arguments.length>0&&(this.__check_items(0,arguments,0),t.unshift.apply(this,arguments)),this.length},this.shift=function(){var e=t.shift.call(this);return e&&this.__remove_items(0,[e]),e},this.splice=function(e,i){var n=this.length;return arguments.length>2?((e|=0)<0&&(e+=n),e<0?e=0:e>n&&(e=n),this.__check_items(e,arguments,2),n=t.splice.apply(this,arguments)):n=t.splice.call(this,0,void 0===i?n:i),n.length>0&&this.__remove_items(e,n),n},this.__check_items=function(t,e,i){},this.__remove_items=function(t,e){},this.children=function(){return t.slice.call(this,0)}}),flyingon.fragment("f-serialize",function(){this.deserialize_Class=!0,this.serialize=function(t){var e;(e=this.Class)&&(e=e.nickName||e.Class)&&t.writeProperty("Class",e),(e=this.__storage)&&t.writeProperties(e,this.getOwnPropertyNames(),this.__watches)},this.deserialize=function(t,e){var i,n,r=this.addBind;for(var s in e)void 0!==(i=e[s])&&(r&&"string"==typeof i&&"{"===i.charAt(0)&&(n=i.match(/^\{\{(\w+)\}\}$/))?this.addBind(s,n[1]):(n=this["deserialize_"+s])?n!==!0&&n.call(this,t,i):this.set(s,i))}}),flyingon.SerializeReader=Object.extend(function(){function t(t,e){var i=this.callback;if((this.all||(this.all={}))[e]=t,i&&(i=i[e])){for(var n=0,r=i.length;n<r;n++)i[n](t);i[e]=t=null}}var e=flyingon.components,i=window.Array;this.deserialize=function(t){return t&&("string"==typeof t&&(t=flyingon.parseJSON(t)),"object"==typeof t&&(t=t instanceof i?this.readArray(t):this.readObject(t),this.all=this.callback=null)),t},this.readArray=function(t,e){if(t){for(var n,r=[],s=0,o=t.length;s<o;s++)(n=t[s])&&"object"==typeof n&&(n=!e&&n instanceof i?this.readArray(n):this.readObject(n,e)),r.push(n);return r}return null},this.readObject=function(i,n){if(i){var r,s;return(s=i.Class)?((s=e[s])?r=new s:(r=new flyingon.HtmlElement,r.tagName=i.Class),r.deserialize(this,i),(s=i.id)&&t.call(this,r,s)):n?(r=new n).deserialize?(r.deserialize(this,i),(s=i.id)&&t.call(this,r,s)):this.readProperties(r,i):this.readProperties(r={},i),r}return null},this.readProperties=function(t,e){var n;for(var r in e)(n=e[r])&&"object"==typeof n&&(n=n instanceof i?this.readArray(n):this.readObject(n)),t[r]=n},this.readReference=function(t,e){var i,n=this.all;n&&(i=n[t])?e(i):(i=this.callback)?(i[t]||(i[t]=[])).push(e):(this.callback={})[t]=[e]}},!1),flyingon.SerializeWriter=Object.extend(function(){var t=window.Array;this.serialize=function(e){if(e&&"object"==typeof e){var i=this.data=[];return e instanceof t?this.writeArray(e):this.writeObject(e),i.pop(),i.join("")}return""+e},this.write=function(e){if(null!=e)switch(typeof e){case"boolean":this.data.push(!!e,",");break;case"number":this.data.push(+e||0,",");break;case"string":this.data.push('"',e.replace(/"/g,'\\"'),'"',",");break;case"function":this.data.push('"',(""+e).replace(/"/g,'\\"'),'"',",");break;default:e instanceof t?this.writeArray(e):this.writeObject(e)}else this.data.push(null,",")},this.writeArray=function(t){var e,i=this.data;if(null!=t)if((e=t.length)>0){i.push("[");for(var n=0;n<e;n++)this.write(t[n]);i.pop(),i.push("]",",")}else i.push("[]",",");else i.push(null,",")},this.writeObject=function(t){var e=this.data;if(null!=t){if(t instanceof Date)return void writer.push('"',t,'"',",");if(e.push("{"),t.serialize)t.serialize(this);else for(var i in t)e.push('"',i,'":'),this.write(t[i]);e.push(","===e.pop()?"}":"{}",",")}else e.push(null,",")},this.writeProperties=function(t,e,i){for(var n,r,s=this.data,o=0,a=e.length;o<a;o++)n=e[o],i&&(r=i[n])&&(r=r[0])?s.push('"',n,'":"{{',r.replace(/"/g,'\\"'),'}}"',","):(s.push('"',n,'":'),this.write(t[n]))},this.writeProperty=function(t,e,i){t&&(this.data.push('"',t,'":'),i?this.writeArray(e):this.write(e))},this.writeReference=function(t,e){if(t&&e){var i=e.id;i&&"function"==typeof i&&(i=i()),this.data.push('"',t,'":',i||"__auto_id_"+i++)}}},!1),function(t){function e(t){var e=[];"value"in t&&(e.push("value"),"text"in t&&e.push("text"));for(var i in t)if(e.push(i),e.length>1)break;return new flyingon.DataList(i=e[0]||"value",e[1]||i)}var i=t.wait=flyingon.create(null);t.all=flyingon.create(null),t.create=function(n,r,s){if(n){var o;return n instanceof t?(r&&r.call(s,n),n):"string"==typeof n?((o=t.all[n])?r&&r.call(s,o):r&&(i[name]||(i[name]=[])).push(r,s),o):(n=n instanceof Array?n:null==n?[]:[n],o=(o=n[0])&&"object"==typeof o?e(o):new flyingon.DataList,o.load(n),r&&r.call(s,o),o)}}}(flyingon.DataList=Object.extend(function(){function t(e,i,n,r){for(var s=0,o=n.length;s<o;s++){var a,l=n[s];l&&null!=(a=l[i])&&(e[a]=l,r&&(a=l[r])&&a.length>0&&t(e,i,a,r))}}var e=this.Class.wait,i=Array.prototype;this.init=function(t,e){(this.valueField=t||"")?(this.displayField=e||t,this.keys=flyingon.create(null)):this.displayField=""},this.length=0,this.load=function(e,n){var r;return e&&e.length>0&&(i.push.apply(this,e),(r=this.keys)&&t(r,this.valueField,e,n),this.trigger("load")),this},this.clear=function(){return this.keys&&(this.keys=flyingon.create(null)),i.splice.call(this,0),this},this.value=function(t){var e=this.valueField;return e?t?t[e]:"":t},this.text=function(t,e,i){var n=this.keys;if(n){var r,s=this.displayField;if(e){t=t?t.split(e):[t];for(var o=0,a=t.length;o<a;o++)t[o]=(r=n[t[o]])&&r[s]||"";return t.join(i||e)}if(r=n[t])return s?r[s]:r}return t},this.find=function(t){var e=this.keys;return e?e[t]:t},this.select=function(t,e){var i=this.keys;if(t=i?t.split(e||","):[t],i)for(var n=0,r=t.length;n<r;n++)t[n]=i[t[n]];return t},this.register=function(t,i){if(t){var n=Class.all;if(!i&&n[t])throw'register name "'+t+'" has exist!';if(n[t]=this,n=e[t]){delete e[t];for(var r=n.length-1;r>=0;r--)e[r++].call(e[r],this)}}return this},this.dispose=function(){this.keys=null,i.splice.call(this,0)}},!1)),flyingon.RowCollection=Object.extend._(function(){function t(t,e){var n;t.push("{");for(var r in e)n?t.push(","):n=!0,t.push('"',r,'":'),i(t,e[r]);t.push("}")}function e(t,e){t.push("[");for(var n=0,r=e.length;n<r;n++)n>0&&t.push(","),i(t,e[n]);t.push("]")}function i(i,n){if(null==n)return void i.push("null");switch(typeof n){case"string":i.push('"',n.replace(/"/g,'\\"'),'"');break;case"object":n instanceof Array?e(i,n):n instanceof Date?i.push('"',n,'"'):t(i,n);break;default:i.push(n)}}function n(i,n,r,s,o){var a,l;i.push("{");for(var h in n)if(a=n[h],l=r[h],a!==l||s&&s.test(h)){if(null==a){i.push('"',h,'":null',",");continue}switch(typeof a){case"string":i.push('"',h,'":"',a.replace(/"/g,'\\"'),'"',",");break;case"object":o&&(l=o[h])?(l=l.toJSON(!0),l.length>2&&i.push('"',h,'":',l,",")):(i.push('"',h,'":'),a instanceof Array?e(i,a):a instanceof Date?i.push('"',a,'"'):t(i,a),i.push(","));break;default:i.push('"',h,'":',a,",")}}i.push(","===i.pop()?"}":"{}")}this.length=0,this.find=function(t){for(var e,i=new flyingon.RowCollection,n=0,r=this.length,s=0;s<r;s++)!(e=this[s])||t&&!t(e)||(i[n++]=e);return i.length=n,i},this.findAll=function(t){for(var e,i=arguments[1]||new flyingon.RowCollection,n=0,r=this.length;n<r;n++)!(e=this[n])||t&&!t(e)||(i[i.length++]=e),e.length>0&&e.findAll(t,i);return i},this.toJSON=function(e,i){var r,s,o,a,l=["["];e&&i&&("string"==typeof i&&(i=i.match(/\w+/g)),i=i&&i.length>0?new RegExp("^("+i.join("|")+")$","i"):null);for(var h=0,f=this.length;h<f;h++)(r=this[h])&&(s=r.data)&&(o?l.push(","):o=!0,e&&(a=r.originalData)?n(l,s,a,i,this.tables):t(l,s));return l.push("]"),l.join("")}}),flyingon.fragment("f-dataset",function(){function t(e,i,n,r,s,o){for(var a,l,h=i||e,f=flyingon.DataRow,c=e.__keys1,u=e.__keys2,d=h.length,_=n.length,g=0;g<_;g++)l=new f,l.dataset=e,i&&(l.parent=i),l.data=a=n[g]||{},c[l.uniqueId=o++]=l,r&&(u[l.id=a[r]]=l),h[d++]=l,s&&(a=a[s])&&a.length>0&&(o=t(e,l,a,r,null,s,o));return h.length=d,o}this.load=function(e,i,n){if(e&&e.length>0){var r=this.dataset,s=r?this:null;r=r||this,r.__new_id=t(r,s,e,r.primaryKey=i,n,r.__new_id++),r.trigger("load","parent",s)}return this},flyingon.fragment("f-collection",this),this.__check_items=function(t,e,i){var n,r,s,o,a,l=flyingon.DataRow,h=[],f=this.dataset,c=null;f?c=this:f=this,n=f.__keys1,r=(s=f.primaryKey)&&f.__keys2;for(var u=i,d=e.length;u<d;u++)(a=e[u])&&a.dataset?o=a:(o=new l,o.dataset=f,o.parent=c,o.data=a=a||{},o.state="add"),n[o.uniqueId=f.__new_id++]=o,s&&(r[o.id=a[s]]=o),f.__change_rows.push(o),h.push(o);f.trigger("add","parent",c,"index",t,"rows",h)},this.__remove_items=function(t,e){var i,n,r,s,o=this.dataset,a=null;o?a=this:o=this,i=o.__keys1,n=o.primaryKey&&o.__keys2,o.trigger("remove","parent",a,"index",t,"rows",e);for(var l=0,h=e.length;l<h;l++)s=this[l],delete i[s.uniqueId],r&&delete n[s.id],s.dataset=s.parent=null;s.uniqueId===o.__current_id&&o.moveTo(this[t]||this[--t])},this.removeProperty=function(t){if(t)for(var e,i,n=this.length-1;n>=0;n--)(e=this[n])&&(i=e.data)&&(delete i[t],(i=e.originalData)&&delete i[t],e.length>0&&e.removeProperty(t));return this}}),flyingon.DataRow=Object.extend._(flyingon.RowCollection,function(){var t=new flyingon.Event;this.dataset=null,this.parent=null,this.id=null,this.uniqueId=0,this.data=null,this.originalData=null,this.state="normal",this.get=function(t){var e;if(e=t&&this.data)return e[t]},this.originalValue=function(t){var e;if(t&&(e=this.originalData||this.data))return e[t]},this.set=function(e,i,n){var r,s;if(e&&void 0!==i&&(r=this.data)&&i!==(s=r[e])){var o,a,l,h=this.dataset;if(n!==!1){if(o=t,o.type="change",o.row=this,o.name=e,o.value=i,o.oldValue=s,h.trigger(o)===!1)return this;(l=o.value)!==i&&void 0!==l&&(i=l)}if("normal"===this.state){this.originalData=l={};for(a in r)l[a]=r[a];this.state="change",h.__change_rows.push(this)}r[e]=i,h.dispatch("change",this,e)}return this},this.rollback=function(t){var e=t&&this.originalData;e&&(this.data[t]=e[t])},this.remove=function(){var t=this.parent||this.dataset;return t&&t.splice(t.indexOf(this),1),this},flyingon.fragment("f-dataset",this),this.level=function(){for(var t=0,e=this;e=e.parent;)t++;return t},this.total=function(){var t=this.length,e=t;if(t>0)for(var i=0;i<t;i++){var n=this[i];n.length>0&&(e+=n.count())}return e}}),flyingon.DataSet=flyingon.defineClass(flyingon.RowCollection,function(){this.init=function(){this.__new_id=1,this.__keys1=flyingon.create(null),this.__keys2=flyingon.create(null),this.__change_rows=[]},this.primaryKey="",flyingon.fragment("f-dataset",this),this.current=function(){var t=this.__current_id;return t&&this.__keys1[t]||null},this.first=function(){var t=this[0];return t&&this.moveTo(t),this},this.previous=function(){var t=this.current(),e=t&&t.parent||this,i=t?e.indexOf(t)-1:0;return(t=e[i])&&this.moveTo(t),this},this.next=function(){var t=this.current(),e=t&&t.parent||this,i=t?e.indexOf(t)+1:0;return(t=e[i])&&this.moveTo(t),this},this.last=function(){var t=this[this.length-1];return t&&this.moveTo(t),this},this.moveTo=function(t){var e=this.__current_id,i=e&&this.__keys1[e]||null;return i!==t&&this.trigger("move","value",t,"oldValue",i)!==!1&&(this.__current_id=t&&t.uniqueId,this.dispatch("move",t)),this},this.id=function(t){return this.__keys2(t)||null},this.uniqueId=function(t){return this.__keys1[t]||null},this.getChanges=function(t){var e=new flyingon.RowCollection,i=this.__change_rows,n=i.length;if(n>0)if(t&&"string"==typeof t){for(var r,s=0,o=0;o<n;o++)(r=i[o])&&t.indexOf(r.state)>=0&&(e[s++]=r);e.length=s}else i.push.apply(e,i);return e},this.acceptChanges=function(){var t,e=this.__change_rows,i=e.length;if(i>0){for(var n=0;n<i;n++)(t=e[n])&&(t.originalData=null,t.state="normal");e.length=0}return this},this.rejectChanges=function(){var t,e,i,n=this.__change_rows,r=n.length;if(r>0){for(var s=r-1;s>=0;s--)if(t=n[s])if(i=t.originalData){e=t.data;for(var o in i)e[o]=i[o];t.originalData=null,t.state="normal",this.dispatch("change",t)}else t.remove();n.length=0}return this},this.subscribe=function(t,e){if(t&&t.subscribeBind){var i,n=this.__subscribe;n?(i=n.indexOf(t),e?i>=0&&n.splice(i,1):i<0&&n.push(t)):e||(this.__subscribe=[]).push(t)}return this};var t={type:"",row:null,name:null,current:!1};this.dispatch=function(e,i,n){var r;if(e&&(r=this.__subscribe)){var s,o=t;o.type=e,o.name=n||null,(o.row=i)?s=!!i&&i.uniqueId===this.__current_id:(o.row=this.current(),s=!0);for(var a=0,l=r.length;a<l;a++)(s||r[a].__subscribe_all)&&r[a].subscribeBind(this,o)}return this},this.bind=function(){var t;return!this.__current_id&&(t=this[0])&&(this.__current_id=t&&t.uniqueId),this.dispatch("bind"),this},this.expression=function(t,e,i){var n;return t&&"string"==typeof t&&("function"==typeof e?("function"!=typeof i&&(i=null),n=this.__expression_keys||(this.__expression_keys=flyingon.create(null)),n[t]=[e,i]):(n=this.__expression_keys)&&delete n[t]),this},this.getBindingValue=function(t,e){var i=this.__expression_keys;return i&&(i=i[t])?i[0].call(this,e.row):(i=(i=e.row.data)&&i[t],void 0!==i?i:"")},this.setBindingValue=function(t,e,i){var n=this.__expression_keys;return n&&(n=n[t])?(n=n[1])&&n.call(this,e,i||this.current()):(i||this.current()).set(t,e),this}},!1),flyingon.fragment("f-bindable",function(){this.defineProperty("dataset",null,{fn:function(t){var e=this.__dataset||null;return void 0===t?e:e===t?this:this.__watch_list&&flyingon.__do_watch(this,"dataset",t)===!1?this:(this.__dataset=t,e&&e.subscribe(this,!0),t&&t.subscribe(this),this)}}),this.addBind=function(t,e){if(t&&e){var i,n=this.__watches||(this.__watches={});(i=n[t])?i[0]=e:n[t]=[e]}return this},this.removeBind=function(t){var e,i=this.__watches;return i&&(e=i[t])&&e[0]&&(e[1]?e[0]="":delete i[t]),this},this.subscribeBind=function(t,e){var i=this.__watches;if(i){var n,r,s=e.name;for(var o in i)if((r=i[o])&&(n=r[0])&&(!s||n===s)){r[0]="";try{this.set(o,t.getBindingValue(n,e))}finally{r[0]=n}}}return this},this.pushBack=function(t,e){var i,n=this;do if(i=n.__dataset)return i.setBindingValue(t,e),this;while(n=n.parent);return this}}),function(){var t=flyingon.components,e=new flyingon.SerializeReader;flyingon.__uniqueId||((flyingon.__uniqueId=flyingon.create(null)).id=1),flyingon.ui=function(i){var n=new(t[i.Class]||arguments[1]||flyingon.HtmlElement);return n.deserialize(e,i),n},flyingon.__find_id=function(t,e){for(var i,n,r=[],s=0;i=t[s++];)(n=i.__storage)&&n.id===e&&r.push(i);return r},flyingon.__find_type=function(t,e){var i,n=flyingon.components[e],r=[],s=0;if(n)for(;i=t[s++];)i instanceof n&&r.push(i);return r},flyingon.__find_class=function(t,e){for(var i,n,r=[],s=0;i=t[s++];)(n=i.__class_keys)&&n[e]&&r.push(i);return r}}(),flyingon.fragment("f-visual",function(){function t(t,e){for(var i,n=t.__class_keys={},r=0;i=e[r++];)n[i]=!0;t.className(e.join(" "))}function e(t,e,i){var n=[];for(var r in e)e[r]&&n.push(r);t.className(n.join(" "))}var i=flyingon.__uniqueId,n=flyingon.create(null);this.__selector_extend=flyingon.Query,this.eventBubble="parent",this.parent=null,this.rendered=!1,this.__uniqueId=0,this.uniqueId=function(){var t=this.__uniqueId;return t||(i[this.__uniqueId=t=i.id++]=this,t)},this.__custom_get=function(t){var e,i;if(t&&(i=t.indexOf(":"))>0){if(!(e=this[t.substring(0,++i)]))throw'"'+t+'" is not a valid property!';e.call(this,t.substring(i))}return(this.__storage||this.__defaults)[t]},this.__custom_set=function(t,e){var i,r;if(t&&(r=t.indexOf(":"))>0){if(!(i=this[t.substring(0,++r)]))throw'"'+t+'" is not a valid property!';i.call(this,t.substring(r),e)}else(this.__storage||(this.__storage=flyingon.create(this.__defaults)))[t]=e,((r=n[t])===!0||null==r&&(n[t]=flyingon.__check_attribute(t)))&&((r=this.__view_patch)?r[t]=e:this.renderer.set(this,t,e))},this.remove=function(){var t,e=this.parent;e&&(t=e.indexOf(this))>=0&&e.splice(t,1)},this.alone=function(){var t,e=this.parent;e&&(t=e.indexOf(this))>=0&&(e.splice(t,1),this.autoDispose=!1)},this.defineProperty("id","",{set:function(t,e){var i;this.rendered&&((i=this.__view_patch)?i.id=t:this.renderer.set(this,"id",t))}}),this["class"]=this.defineProperty("className","",{set:function(t){var e;this.fullClassName=t=t?this.defaultClassName+" "+t:this.defaultClassName,this.rendered&&((e=this.__view_patch)?e["class"]=t:this.renderer.set(this,"class",t))}}),this.hasClass=function(t){var e;return t&&(e=this.__class_keys)&&e[t]||!1},this.addClass=function(e){var i,n,r;if(e&&(i=e.match(/[\w-]+/g)))if(n=this.__class_keys){for(r=i.length;r--;)n[e=i[r]]?i.splice(r,1):n[e]=!0;i.length>0&&this.className(this.__storage.className+" "+i.join(" "))}else t(this,i);return this},this.removeClass=function(t){var i,n,r;if(t&&(i=t.match(/\w+/g))&&(n=this.__class_keys)){for(r=i.length;r--;)n[t=i[r]]?n[t]=!1:i.splice(r,1);i.length>0&&e(this,n,i)}return this},this.toggleClass=function(i){var n,r,s;if(i&&(n=i.match(/\w+/g)))if(r=this.__class_keys){for(s=n.length;s--;)r[i=n[s]]=!r[i];e(this,r,n)}else t(this,n);return this},this["class:"]=function(t,e){e?this.addClass(t):this.removeClass(t)},this["#model"]=function(t,e){this.on("change",function(i){t.$set(e,i.value)})},this.__class_init=function(t,e){var i=t.module,n=t.typeName;this.renderer===e.renderer&&flyingon.renderer.bind(this,n),n&&(n=((i.className||i.moduleName)+"-"+n).toLowerCase(),(e=e.defaultClassName)&&(n=e+" "+n),this.fullClassName=this.defaultClassName=n)}}),flyingon.globalEval=function(t){window.execScript?window.execScript(t):window.eval(t)},flyingon.absoluteUrl=function(){var t,e=document.createElement("a"),i=location.href.replace(/[?#][\s\S]*/,"");return e.href="",e.href||(e=document.createElement("div"),t=/"/g),function(n,r){return n?t?(e.innerHTML='<a href="'+n.replace(t,"%22")+'"></a>',n=e.firstChild.href):(e.href=n,n=e.href):n=i,r?n.substring(0,n.lastIndexOf("/")+1):n}}(),flyingon.__script_src=function(){var t;if(t=document.currentScript)return t.src;try{t()}catch(e){if((t=e.fileName||e.sourceURL||e.stack||e.stacktrace)&&(t=/((?:http|https|file):\/\/.*?\/[^:]+)(?::\d+)?:\d+/.exec(t)))return t[1]}t=document.scripts;for(var i=t.length-1;i>=0;i--)if("interactive"===t[i].readyState)return flyingon.absoluteUrl(t[i].src)},document.head||(document.head=document.getElementsByTagName("head")[0]),flyingon.script=-[1]&&9!==document.documentMode?function(t,e){var i=document.createElement("script");return i.onload=i.onerror=function(){i=i.onload=i.onerror=null,e&&(e.call(this),e=null)},i.async=!1,i.src=t,document.head.appendChild(i),i}:function(){function t(){for(var t,n;(t=e[0])&&"loaded"===t.readyState;)e.shift(),t.onreadystatechange=null,i.insertBefore(t,i.lastChild||null),(n=e.shift())&&n.call(t)}var e=[],i=document.head;return function(i,n){var r=document.createElement("script");return e.push(r,n),r.onreadystatechange=t,r.src=i,r}}(),flyingon.link=function(t,e,i){var n=document.createElement("link");return n.href=t,n.type=e||"text/css",n.rel=i||"stylesheet",document.head.appendChild(n),n},flyingon.style=function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.head.appendChild(e),e},function(t,e){function i(t){var i,n=this.__events;if(n=n&&n[t.type]){t.target||(t.target=t.srcElement);for(var r=0,s=n.length;r<s&&(!(i=n[r])||i.disabled||(i.call(this,t)===!1&&t.returnValue!==!1&&e.dom_prevent(t),!t.cancelBubble));r++);}}function n(e){function n(e){i.call(n.dom,e||t.event)}return n.dom=e,e=null,n}function r(t){e.dom_stop(t)}var s="addEventListener";t[s]||(s=!1),e.dom_prevent=function(t){t.returnValue=!1,t.preventDefault&&t.preventDefault()},e.dom_stop=function(t,e){e&&(t.returnValue=!1,t.preventDefault&&t.preventDefault()),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()},e.dom_once=function(t,i,n){function r(){n.apply(this,arguments),e.dom_off(t,i,r)}e.dom_on(t,i,r)},e.dom_on=function(t,e,r,o){if(t&&e&&r){var a,l=t.__events;if(l){if(a=l[e])return a.push(r),this}else l=t.__events={};l[e]=[r],s?t[s](e,i,o):t.attachEvent("on"+e,l.trigger||(l.trigger=n(t)))}},e.dom_suspend=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i.unshift(r)},e.dom_resume=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i[0]===r&&i.shift()},e.dom_off=function(t,e,n){var r,o=t&&t.__events;if(r=o&&o[e]){if(n){for(var a=r.length-1;a>=0;a--)r[a]===n&&r.splice(a,1);if(r.length>0)return}s?t.removeEventListener(e,i):t.detachEvent("on"+e,o.trigger),delete o[e];for(e in o)return;(n=o.trigger)&&(o.trigger=n.dom=null),t.__events=void 0}},e.dom_trigger=function(t,e){if(t&&e)return i.call(t,e.type?e:{type:e})}}(window,flyingon),function(t,e){var i=e.create(null),n=e.create(null),r=e.create(null);!function(e,i){var n,r,s,o=t.documentElement.style,a=[];for(var l in o)switch(l){case"cssFloat":case"styleFloat":a.push("float");break;case"cssText":break;default:a.push(l)}s=a.join(","),(l=s.match(/\b(webkit|ms|moz|o)[A-Z]/))?(l=l[1],s=s.replace(new RegExp("\\b"+l+"(?=[A-Z])","g"),"-"+l),s=s.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}),n=s.split(","),r=s.replace(new RegExp("-"+l+"-","g"),"").split(",")):n=r=a;for(var h=0,f=a.length;h<f;h++)s=r[h],e[s]=a[h],i[s]=n[h]}(i,n),e.css_name=function(t,e){return(e?n:i)[t]||""},e.css_map=function(t){return t?n:i},e.css_value=function(t,e,n){var s;(s=i[e])?t.style[s]=n:(s=r[e])&&s(n,t)},e.css_fixed=function(t,e){t&&e&&!i[t]&&(r[t]=e)},e.css_fixed("user-select",function(){function e(){return!1}return function(i,n){n&&((n===t.body?t:n).onselectstart="none"===i?e:null)}}())}(document,flyingon),flyingon.__check_attribute=function(){var t=document.createElement("div");return function(e){try{return t.setAttribute(e,""),!0}catch(i){return!1}}}(),flyingon.ready=function(){function t(){var i=e;if(i){i.ready=!0,flyingon.dom_off(document,"DOMContentLoaded",t),flyingon.dom_off(window,"load",t);for(var n=0;n<i.length;n++)i[n++].call(i[n]);e=null}}var e;return"complete"!==document.readyState&&(e=[],flyingon.dom_on(document,"DOMContentLoaded",t),flyingon.dom_on(window,"load",t)),function(i,n){"function"==typeof i?e?e.push(i,n):i.call(n):e&&!e.ready&&t()}}(),flyingon.dom_id=function(t){if(t)return"#"===t.charAt(0)&&(t=t.substring(1)),document.getElementById(t)},flyingon.dom_test=function(){var t,e=document.createElement("div");return e.id="f-dom-test",e.style.cssText="position:absolute;overflow:hidden;margin:0;border:0;padding:0;left:-10px;top:0;width:0;height:0;",document.body?document.body.appendChild(e):(t=[],flyingon.ready(function(){var i,n=0;for(t=null,document.body.appendChild(e);i=this[n++];)i.call(this[n++],e)},t)),function(i,n){t?t.push(i,n):i.call(n,e)}}(),flyingon.dom_html=function(t,e,i){if(t&&e){var n,r,s;return i||(i=t.lastChild)&&(n=1)?(r=n?i:i.previousSibling,(s=i.insertAdjacentHTML)?s.call(i,n?"afterend":"beforebegin",e):(s=document.createRange(),e=s.createContextualFragment(e),n?(s.setStartAfter(i),t.appendChild(e)):(s.setStartBefore(i),t.insertBefore(e,i))),r?r.nextSibling:t.firstChild):(t.innerHTML=e,t.firstChild)}},flyingon.dom_drag=function(t,e,i,n,r,s,o){function a(e){i&&(e.dom=_,i.call(t,e),_=e.dom),(c=_&&_.style)&&(u=_.offsetLeft,d=_.offsetTop),flyingon.dom_suspend(_,"click",!0),flyingon.css_value(document.body,"user-select","none"),_.setCapture&&_.setCapture(),a=null}function l(e){var i=e.clientX-v,r=e.clientY-y;(!a||(i<-2||i>2||r<-2||r>2)&&a(e))&&(n&&(e.dom=_,e.distanceX=i,e.distanceY=r,n.call(t,e),i=e.distanceX,r=e.distanceY),m=i,w=r,c&&s!==!0&&("x"!==s&&(c.left=u+i+"px"),"y"!==s&&(c.top=d+r+"px")),flyingon.dom_stop(e,!0))}function h(e){p(document,"mousemove",l),p(document,"mouseup",h),a||(flyingon.css_value(document.body,"user-select",""),_.setCapture&&_.releaseCapture(),setTimeout(f,0),r&&(e.dom=_,e.distanceX=m,e.distanceY=w,r.call(t,e)),t=_=null)}function f(){flyingon.dom_resume(_,"click",!0)}var c,u,d,_=e.dom||e.target||e.srcElement,g=flyingon.dom_on,p=flyingon.dom_off,v=e.clientX,y=e.clientY,m=0,w=0;o===!1&&a(e),g(document,"mousemove",l),g(document,"mouseup",h),flyingon.dom_stop(e,!0)},flyingon.dom_align=function(t,e,i,n,r){var s=t.offsetWidth,o=t.offsetHeight,a=t.style,l=document.body.scrollLeft,h=document.body.scrollTop,f=l+e.left,c=h+e.top,u=l+e.right,d=h+e.bottom;if(r!==!1)switch(t=document.documentElement,l=window.innerWidth||t.offsetWidth||0,h=window.innerHeight||t.offsetHeight||0,i){case"left":f<s&&l-u>=s&&(i="right");break;case"top":c<o&&h-d>=o&&(i="bottom");break;case"right":f>=s&&l<u+s&&(i="left");break;default:c>=o&&h<d+o&&(i="top")}if("left"===i||"right"===i)switch(l="left"===i?f-s:u,n){case"middle":h=c+(d-c-o>>1);break;case"bottom":h=d-o;break;default:h=c}else{switch(n){case"center":l=f-(u-f-s>>1);break;case"right":l=u-s;break;default:l=f}h="top"===i?c-o:d}return a.left=l+"px",a.top=h+"px",{left:l,top:h}},flyingon.dom_overlay=function(){var t=[],e=document.createElement("div");return e.className="f-overlay",function(i,n){if(i){var r;if(n===!1){if(t[t.length-1]===i){for(i.flyingon_overlay=!1,t.pop();i=t[t.length-1];){if(e.style.zIndex=i.style.zIndex,r=i.parentNode)return void r.insertBefore(e,i);i.flyingon_overlay=!1,t.pop()}(r=e.parentNode)&&r.removeChild(e)}}else(r=i.parentNode)&&(e.style.zIndex=i.style.zIndex,r.insertBefore(e,i),i.flyingon_overlay=!0,t.push(i))}}}(),function(t){function e(t,e){if(void 0===e)return o[t];if(o[t]!==e){var i=a;o[t]=e;for(var n in i)n.indexOf(t)>0&&(i[n]=void 0)}}function i(t,e){var i,n=a[t];if(void 0!==n)return n;if(n=l[t])return n*e/100+.5|0;if(n=t.match(/[+-]?\d+(.\d+)?|[\w%]+/g))if(i=n[1]){if("%"===i)return(l[t]=n[0])*e/100+.5|0;n=n[0]*(i[i.toLowerCase()]||1)+.5|0}else n=+n[0]+.5|0;else n=0;return a[t]=n}function n(t,e){var i=h[t];return i?i:(i=f[t])?r(t,i,e):(i=+t,i!==i&&(i=t.match(/[+-]?[\w%.]+/g))?t.indexOf("%")<0?h[t]=r(i,e):r(f[t]=i,e):h[t]={left:i|=0,top:i,right:i,bottom:i})}function r(t,e){var n={},r=i;switch(t.length){case 1:n.left=n.top=n.right=n.bottom=r(t[0],e);break;case 2:n.left=n.right=r(t[1],e),n.top=n.bottom=r(t[0],e);break;case 3:n.left=n.right=r(t[1],e),n.top=r(t[0],e),n.bottom=r(t[2],e);break;default:n.left=r(t[3],e),n.top=r(t[0],e),n.right=r(t[1],e),n.bottom=r(t[2],e)}return n}var s=t.create,o=(t.pixel_unit=e).unit=s(null),a=(t.pixel=i).cache=s(null),l=s(null),h=(t.pixel_sides=n).cache=s(null),f=s(null);o.em=o.rem=12,o.ex=6,o.pc=16,o.px=1,o.pt=4/3,o.mm=(o.cm=96/2.54)/10,o["in"]=96}(flyingon),flyingon.dom_test(function(t){var e=flyingon.pixel_unit.unit;t.innerHTML='<div style="position:absolute;left:-10000in;"></div><div style="position:absolute;overflow:scroll;left:-10000em;top:-10000ex;width:100px;height:100px;"><div style="width:200px;height:200px;"></div></div>',e.px=1,e.pt=(e.pc=(e["in"]=-t.children[0].offsetLeft/1e4)/6)/12,e.mm=(e.cm=e["in"]/2.54)/10,t=t.children[1],e.em=e.rem=-t.offsetLeft/1e4,e.ex=-t.offsetTop/1e4,flyingon.vscroll_width=t.offsetWidth-t.clientWidth,flyingon.hscroll_height=t.offsetHeight-t.clientHeight}),flyingon.MouseEvent=flyingon.Event.extend(function(){this.init=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,(this.which=t.which)||(this.which=1&t.button?1:2&t.button?3:2),this.clientX=t.clientX,this.clientY=t.clientY}}),flyingon.KeyEvent=flyingon.Event.extend(function(){this.init=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.which=t.which||t.charCode||t.keyCode}}),flyingon.Ajax=flyingon.Async.extend(function(){function t(t,i,n,r){var s,o=t.xhr=new XMLHttpRequest;if(n.start&&(i=i+n.start+n.join("&")),t.CORS&&("withCredentials"in o?o.withCredentials=!0:(s=window.XDomainRequest)&&(o=new s)),(s=t.timeout)>0&&(t.__timer=setTimeout(function(){o.abort(),t.fail("timeout")},s)),o.onreadystatechange=function(){e(t,o,i)},o.open(t.method,i,t.async),s=t.header)for(var a in s)o.setRequestHeader(a,s[a]);o.setRequestHeader("Content-Type",t.contentType),r&&(r=flyingon.encode(r),o.setRequestHeader("Content-Length",r.length)),o.send(r)}function e(t,e,n){var r=e.readyState;if(4===r){if((r=t.__timer)&&(clearTimeout(r),t.__timer=0,r=void 0),e.status<300)try{switch(t.dataType){case"json":t.resolve(flyingon.parseJSON(e.responseText));break;case"xml":t.resolve(e.responseXML);break;default:t.resolve(e.responseText)}}catch(s){t.reject(s)}else t.reject(r=e.statusText);i(t,n,r),t.xhr=t.onreadystatechange=null}else t.notify(r)}function i(t,e,i){var n=flyingon.Ajax.end;if(n)for(var r=0,s=n.length;r<s;r++)n[r].call(t,e,i)}function n(t,e,r){var s=n,o=s.cache||(s.cache=[]),a=o.pop()||"flyingon_callback"+(++s.id||(s.id=1));window[a]=function(n){t.resolve(n),i(t,e)},r.push(t.jsonp||"jsonp","=",a),t.version||r.push("jsonp-version="+(++s.version||(s.version=1))),flyingon.script(e=e+r.start+r.join("&"),function(n,r){o.push(a),r&&(t.reject(r),i(t,e,r)),window[a]=void 0,this.parentNode.removeChild(this),t=null})}function r(t,e,i,n){function r(){l?(this.contentWindow.location="about:blank",a(t,e,this.contentWindow.name),s(this),flyingon.dom_off(this,"load",r),t=h=i=n=null):(l=1,this.contentWindow.name=this.name,o(this,e,n,t.method))}var l,h=s();i.push("jsonp=post"),e=e+i.start+i.join("&"),flyingon.dom_on(h,"load",r),h.src="about:blank",document.head.appendChild(h)}function s(t){var e=s.cache||(s.cache=[]);return t?(e.push(t),void t.parentNode.removeChild(t)):(t=e.pop(),t||(t=document.createElement("iframe"),t.name="jsonp-iframe"),t)}function o(t,e,i,n){var r=['<form id="form" enctype="application/x-www-form-urlencoded"'];r.push(' action="',e,'" method="',"GET",'">');for(var s in i)r.push('<input type="hidden" name="',s,'"'),"string"==typeof(s=i[s])&&(s=s.replace(/"/g,'\\"')),r.push(' value="',s,'" />');r.push("</form>","<script>form.submit();</script>"),t.contentWindow.document.write(r.join(""))}function a(t,e,n){try{t.resolve(flyingon.parseJSON(n)),i(t,e)}catch(r){t.reject(r),i(t,e,r)}}this.url="",this.version="",this.method="GET",this.dataType="text",this.contentType="application/x-www-form-urlencoded",this.header=null,this.async=!0,this.CORS=!1,this.jsonp="jsonp",this.timeout=0,this.send=function(e,i){var s,o,a,l=[];if(i)for(var h in i)"data"!==h?this[h]=i[h]:s=i[h];if(a=flyingon.Ajax.start){for(var f=0,c=a.length;f<c;f++)if(a[f].call(this,e)===!1)return!1;e=this.url}return!!(this.url=e)&&((o=/get|head|options/i.test(this.method))&&s&&(l.push(flyingon.encode(s)),s=null),a="jsonp"===this.dataType,this.version&&l.push("ajax-version=",this.version),(a||l.length>0)&&(l.start=e.indexOf("?")>=0?"&":"?"),a=a?o?n:r:t,a(this,e,l,s),this)}}),flyingon.ajaxStart=function(t){(flyingon.Ajax.start||(flyingon.Ajax.start=[])).push(t)},flyingon.ajaxEnd=function(t){(flyingon.Ajax.end||(flyingon.Ajax.end=[])).push(t)},flyingon.ajax=function(t,e){return(new flyingon.Ajax).send(t,e)},flyingon.ajaxPost=function(t,e){return e=e||{},e.method="POST",(new flyingon.Ajax).send(t,e)},flyingon.jsonp=function(t,e){return e=e||{},e.dataType="jsonp",(new flyingon.Ajax).send(t,e)},flyingon.jsonpPost=function(t,e){return e=e||{},e.dataType="jsonp",e.method="POST",(new flyingon.Ajax).send(t,e)},function(t){function e(i,n){if(i){switch(typeof i){case"string":return void e.require([e.path(i)],n);case"function":return void i.call(t,t)}if(i instanceof Array){for(var r,s=[],o=0,a=i.length;o<a;o++)(r=i[o])&&"string"==typeof r&&s.push(e.path(r));if(s.length>0)return void e.require(s,n)}}"function"==typeof n&&n.call(t,t)}function i(t,e){var i=l;if(t){t+=".";for(var n in e)i[t+n]=e[n]}else for(t in e)i[t]=e[t]}var n=t.create,r="",s=n(null),o=n(null),a=n(null),l=n(null),h=n(null),f={layout:"default",skin:"default",i18n:navigator.language||"zh-CN"};e.__root_path="",e.__base_path="",e.base=function(t){return void 0===t?e.__base_path:(t&&"string"==typeof t?("/"===t.charAt(0)?t=e.__root_path+t.substring(1):t.indexOf("://")<0&&(t=e.__root_path+t),"/"!==t.charAt(t.length-1)&&(t+="/")):t=e.__root_path,void(e.__base_path=t))},e.version=function(t,e){if("string"==typeof t?r=t:e=t,e){var i=s;for(var n in e)i[n]=e[n]}},e.merge=function(t){if(t){var e,i=a;for(var n in t)if("string"==typeof(e=t[n]))i[e]=n;else for(var r=0,s=e.length;r<s;r++)i[e[r]]=n}},e.path=function(t){var i,n,l,c,u=t=a[t]||t;if(c=o[u])return c;if((l=t.indexOf("{"))>=0&&(c=t.indexOf("}"))>l&&(n=t.substring(l+1,c))&&(c=f[n])){if(u=t.replace("{"+n+"}",c),c=o[u])return c}else i=!1;return c=(c=s[t]||r)?u+(t.indexOf("?")>=0?"&":"?")+"require-version="+c:u,"/"===t.charAt(0)?c=e.__root_path+c.substring(1):t.indexOf("://")<0&&(c=e.__base_path+c),i!==!1&&((h[n]||(h[n]={}))[c]=t),o[u]=c},e.key=function(t,i,n,r){var s=f;return i?void(i&&s[t]!==i&&(s[t]=i,r&&r(),(s=h[t])&&e.__change(s,t,n))):s[t]},t.skin=function(t){return e.key("skin",t)},t.i18ntext=function(t,e){return l[t]||(null!=e?e:t)},t.i18n=function(t,r){if(r&&"object"==typeof r)i(t,r);else{if("object"!=typeof t)return e.key("i18n",t,null,function(){l=n(null),"function"==typeof r&&r()});i(null,t)}},t.require=e}(flyingon),function(t){function e(e){for(var n,r=h,s=0,o=e.length;s<o;s++)r[n=e[s]]||(r[n]=1,c++,t.script(n,i))}function i(){var t=h,i=f,s=u,o=--c,a=this.src,d=s.indexOf(a);d>=0&&s.splice(d,1),s.length>0?(u=[],t[a]=2,s.src=a,e(s)):(t[a]=3,n(t,i,a)),o||(r(t,i),l.wait&&(l.wait(),l.wait=null))}function n(e,i,r){var s,o,a,l=i[r];if(delete i[r],l){for(var h=l.length-1;h>=0;h--)if(s=l[h],(a=s.indexOf(r))>=0&&s.splice(a,1),!(s.length>0)&&(l.splice(h,1),(a=s.src)&&(e[a]=3,(o||(o=[])).push(a)),a=s.callback)){s.callback=null;for(var f=0,c=a.length;f<c;f++)a[f++].apply(t,a[f])}if(o)for(var h=0,c=o.length;h<c;h++)n(e,i,o[h])}}function r(t,e){var i,r,o=[];for(i in e)o.push(i);for(var a=o.length-1;a>=0;a--)if((r=e[i=o[a]])&&s(e,r,i))for(var l=a;l>=0;l--)if(r=e[o[l]])for(var h=r.length-1;h>=0;h--)if(r[h]&&r[h].src===i){n(t,e,i);break}}function s(t,e,i){for(var n,r,o=e.length-1;o>=0;o--)if((r=e[o])&&(n=r.src)){if(n===i)return!0;if((r=t[n])&&s(t,r,i))return!0}}function o(e,i,n){var r={},s=[];if(i.replace(/<(script|template|style)([^>]*)>\s*([\s\S]*?)\s*<\/\1>/gm,function(e,i,n,o){switch(i){case"template":(n=n.match(/id="([^"]+)"|'([^']+)'/))&&(r["#"+(n[1]||n[2])]=o.replace(/[\r\n]+\s*/gm,"").replace(/(['"])/gm,"\\$1"));break;case"link":(n=n.match(/href="([^"]+)"|'([^']+)'/))&&t.link(n[1]||n[2]);break;case"style":t.style(o);break;case"script":(n=n.match(/src=("[^"]"|'[^']')/))?s.push("flyingon.require(",n[1],");\n"):s.push("flyingon.defineModule(function () {\n\n\n\n",o,"\n\n\n\n});\n\n")}}),s.length>0){s.push("\n\n//# sourceURL=",e),i=s.join("");for(var o in r)i=i.replace(new RegExp(o,"gm"),r[o]);t.globalEval(i)}t.require.done(n)}var a=t.create,l=t.require,h=a(null),f=a(null),c=0,u=[];l.__root_path=t.absoluteUrl("/"),l.__base_path=function(){var e=t.__script_src()||t.absoluteUrl(""),i=e.indexOf("flyingon/");return i>=0?e.substring(0,i):l.__root_path}(),l.__change=function(t,e,i){for(var n,r=document.getElementsByTagName("skin"===e?"link":"script"),s=r.length-1;s>=0;s--)(n=r[s])&&t[n.src||n.href]&&n.parentNode.removeChild(n);r=[];for(n in t)t[n]&&(r.push(l.path(t[n])),h[n]=0);l.require(r,i||function(){})},l.callback=function(e,i){var n=u;if(n&&n.length>0)return(n.callback||(n.callback=[])).push(e,i||[t]),!0},l.require=function(i,n){var r,s,o,a,l=h,c=f;r=n?[]:u;for(var d=0,_=i.length;d<_;d++)(s=i[d])&&3!==(a=l[s])&&(s.indexOf(o||".css")>0?a||(l[s]=3,t.link(s)):r[s]||(r[s]=!0,r.push(s),(c[s]||(c[s]=[])).push(r)));n&&(r.length>0?(r.callback=[n,[t]],e(r)):n.call(t,t))},l.done=function(t){c>0?l.wait=t:t()},t.load=function(e,i){e&&(e.indexOf(".js")>0?t.require(e,i):t.ajax(t.require.path(e)).done(function(t){t&&o(e,t,i)}).fail(function(t){console&&console.error(t)}))}}(flyingon),function(){function t(e,r){var s=i[e];return s?void(s instanceof Array?r&&s.push(r):r&&r(s)):(n.push(e,r),void(n.length>2||(s=i[e]=[],r&&s.push(r),flyingon.__load_plugin=function(t){i[e]=t},flyingon.load(e,function(){var r=i[e],o=s;if(flyingon.__load_plugin=null,n.splice(0,2),r instanceof Array)throw i[e]=null,'"'+e+'" not include any flyingon.Plugin!';for(var a=0,l=o.length;a<l;a++)o[a](r);(o=n).length>0&&t(o.shift(),o.shift())}))))}function e(t,i,n){var s,i,o;if(!(t&&t instanceof flyingon.Tab))throw"rout tab must be a flyingon.Tab!";if(!i||!(i=i.replace(/^[#!]+/g,"")))throw"route options.url can not be empty!";switch(t.__on_route||(t.on("tab-change",e.__tab_change),t.__on_route=!0),o=t.header()?n.target:"_self"){case"_blank":o=null;break;case"_self":if((s=t.selectedPage())&&s.url===i)return;o=null;break;default:if((s=t.findByKey(o))&&s.url===i)return void(s.selected()||(t.selectedPage(s,"route"),s.route.update(),s[0].openPlugin(s.route.next(),!1)))}s?(s[0].closePlugin(),s.splice(0)):t.push(s=(new flyingon.TabPage).layout("fill")),o&&s.key(o),(new r).load(e.current=s,i,n)}var i=flyingon.create(null),n=[];e.preload=function(e){e&&(e=e.replace(/^[#!]+/g,""))&&t(e.split("#")[0])},flyingon.route=e;var r=Object.extend(function(){this.plugin="",this.load=function(i,n,r){var s;i.route=this,e.__update(i.url=this.url=n),0===n.indexOf("iframe:")?n=n.substring(7):(this.parse(n),(s=r.icon)&&i.icon(s),(s=r.text)?i.text(s):i.parent.header(0),i.closable(r.closable!==!1),i.parent.selectedPage(i,"route"),s=this,t(this.plugin,function(t){var e,n=s;i.push(e=new t),e.loadPlugin(n=n.next()),e.openPlugin(n,!0),i=s=null,flyingon.update()}))},this.parse=function(t){var e,i=t.split("#"),n=this;this.plugin=i[0];for(var r=1,o=i.length;r<o;r++)(e=i[r])&&(n=n.__next=new s(this,e))},this.next=function(){return this.__next||(this.__next=new s(this,""))},this.update=function(){for(var t,i=this.plugin,n=this;(n=n.__next)&&(t=n.value);)i+="#"+t;e.__update(i)}},!1),s=Object.extend(function(){this.value="",this.init=function(t,e){this.__root=t,this.value=e},this.change=function(t){this.value=""+t,this.__root.update()},this.clear=function(){this.__next=null,this.__root.update()},this.next=function(){return this.__next||(this.__next=new s(this.__root,""))},this.dispatch=function(t){var e;if(t)if(e=t.subscribeRoute)e.call(t,this);else for(var i=0,n=t.length;i<n;i++)(e=t[i].subscribeRoute)&&e.call(t[i],this)}},!1)}(),function(){function t(t,e){for(var i=n,r=0,s=i.length;r<s;r++)i[r](t,e)}function e(){location.hash!==r&&t(location.hash.replace(/^[#!]+/g,""),!1)}function i(){e(),setTimeout(i,200)}var n=[],r=location.hash.replace(/^[#!]+/,"");(n.hash=r)&&flyingon.route.preload(r),this.listen=function(e){if("function"==typeof e){var i=n.hash;n.push(e),i&&(n.hash="",t(i,!1))}},this.__tab_change=function(e){if(e.target===this){var i=flyingon.route.current=e.current;i?(i.route.update(),"route"!==e.tag&&t(i.url,!0)):t(location.hash=r="",!0)}},this.__update=function(t){location.hash=r=t?"#!"+t:""},"onhashchange"in window?flyingon.dom_on(window,"hashchange",e):setTimeout(i,200)}.call(flyingon.route),function(){function t(t,n){for(var r,s,o,a=flyingon.Selector_node,l=" ";o=t[n++];)switch(o){case"#":case".":s=new a(l,o,t[n++],s),l="";break;case"*":s=new a(l,"*","*",s),l="";break;case" ":case"\t":l||(l=" ");break;case">":case"+":case"~":l=o;break;case",":s&&(r=r||new flyingon.Selector_nodes,r[r.length++]=s.top),s=null,l=" ";break;case"[":s&&!l||(s=new a(l,"*","*",s),l=""),n=e(s,t,n);break;case":":s&&!l||(s=new a(l,"*","*",s),l=""),o=new flyingon.Selector_pseudo(s,t[n++]),"("===t[n]&&(n=i(o,t,++n));break;default:s=new a(l,"",o,s),l=""}return r?(s&&(r[r.length++]=s.top),r):s&&s.top||s}function e(t,e,i){for(var n,r,s;r=e[i++];)switch(r){case"]":return i;case"*":case"^":case"$":case"~":case"|":n&&(n.relation=r);break;case"=":n&&(n.relation+="=");break;case" ":case"\t":break;default:if(n){switch(r){case"undefined":r=void 0;break;case"null":r=null;break;case"true":r=!0;break;case"false":r=!1;break;default:r='"'===(s=r.charAt(0))||"'"===s?r.substring(1,r.length-1):+r}n.value=r}else n=new flyingon.Selector_property(t,r)}return i}function i(t,e,i){for(var n,r=i,s=1;s&&(n=e[i++]);)switch(n){case"(":s++;break;case")":s--}switch(n=e.slice(r,i-1).join(""),t.name){case"eq":case"gt":case"lt":n|=0}return t.value=n,i}var n=flyingon.create(null);flyingon.__parse_selector=function(e,i){return e&&"string"==typeof e?i!==!1&&(i=n[e])?i:(i=e.match(/"[^"]*"|'[^']*'|[\w-]+|[*.#\[\]:(), \t>+~=|^$]/g),n[e]=t(i,0)):null}}(),flyingon.Selector_node=Object.extend(function(){this.init=function(t,e,i,n){this.find=this[this.relation=t],this.filter=this[this.type=e],this.name=i,n?(t?n.next=this:n[n.length++]=this,this.top=n.top||n):this.top=this},this.relation="",this.type="",this.name="",this.length=0,this.next=null,this.select=function(t){var e,i;if(t=this.find(t),t[0]){for(e=0;i=this[e++];)t=i.filter(t);t[0]&&(i=this.next)&&(t=i.select(t))}return t},this.check=function(t){for(var e,i=0;e=this[i++];)if(!(t=e.filter(t,[])).length)return t;return(e=this.next)?e.find(t):t},this[""]=function(t,e){var i=this.name;return i?flyingon.__find_type(t,i):[]},this["*"]=function(t,e){return t},this["."]=function(t,e){var i=this.name;return i?flyingon.__find_class(t,i):[]},this["#"]=function(t,e){var i=this.name;return i?flyingon.__find_id(t,i):[]},this[" "]=function(t){for(var e,i,n,r=0;i=t[r++];)i.length>0&&i.all&&(n=i.all(),e?n.push.apply(e,n):e=n);return e&&e[0]?this.filter(e,1):e||[]},this[">"]=function(t){for(var e,i=0,n=[];e=t[i++];)e.length>0&&n.push.apply(n,e);return n[0]&&this.filter(n,2)||n},this["+"]=function(t){for(var e,i=[],n=0,r=0;e=t[n++];)(e=e.nextSibling)&&(i[r++]=e);return i[0]?this.filter(i):i},this["~"]=function(t){for(var e,i=[],n=0,r=0;e=t[n++];)for(;e=e.nextSibling;)i[r++]=e;return i[0]?this.filter(i):i}},!1),flyingon.Selector_nodes=Object.extend(function(){this.type=",",this.length=0,this.select=function(t,e){var i,n,r=1;if(n=this[0])for(e=n.select(t,e);n=this[r++];)i=n.select(t,[]),i.length>0&&e.push.apply(e,i);return e}},!1),flyingon.Selector_property=Object.extend(function(){this.init=function(t,e){this.name=e,t[t.length++]=this},this.type="[]",this.name="",this.relation="",this.value="",this.filter=function(t){var e,i=[],n=this.name;return n&&(e=this[this.relation])&&e.call(this,t,n,i,0),i},this[""]=function(t,e,i,n){for(var r,s=0;r=t[s++];)void 0!==r[e]&&(i[n++]=r)},this["="]=function(t,e,i,n){for(var r,s,o=this.value,a=0;r=t[a++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),s===o&&(i[n++]=r))},this["*="]=function(t,e,i,n){for(var r,s,o=this.value,a=0;r=t[a++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),s=""+s,s.indexOf(o)>=0&&(i[n++]=r))},this["^="]=function(t,e,i,n){for(var r,s,o=this.value,a=0;r=t[a++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),s=""+s,0===s.indexOf(o)&&(i[n++]=r))},this["$="]=function(t,e,i,n){for(var r,s,o=this.value,a=o.length,l=0;r=t[l++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),s=""+s,s.lastIndexOf(o)===s.length-a&&(i[n++]=r))},this["~="]=function(t,e,i,n){for(var r,s,o=this.regex||(this.regex=new RegExp("(?:^|s+)"+this.value+"(?:s+|$)")),a=0;r=t[a++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),o.text(s)&&(i[n++]=r))},this["|="]=function(t,e,i,n){for(var r,s,o=this.regex||(this.regex=new RegExp("\b"+this.value+"\b")),a=0;r=t[a++];)void 0!==(s=r[e])&&("function"==typeof s&&(s=s.call(r)),o.text(s)&&(i[n++]=r))}},!1),flyingon.Selector_pseudo=Object.extend(function(){this.init=function(t,e){this.name=e,t[t.length++]=this},this.type=":",this.name="",this.value=0,this.filter=function(t){var e,i=[],n=this.name;return n&&(e=this[n])&&e.call(this,t,i,0),i},this.active=function(t,e,i){},this.disabled=function(t,e,i){for(var n,r=0;n=t[r++];)(n.__storage||n.__defaults).disabled&&(e[i++]=n)},this.enabled=function(t,e,i){for(var n,r=0;n=t[r++];)(n.__storage||n.__defaults).disabled||(e[i++]=n)},this.checked=function(t,e,i){for(var n,r=0;n=t[r++];)(n.__storage||n.__defaults).checked&&(e[i++]=n)},this.has=function(t,e,i){var n=this.value;return n&&(n=flyingon.__parse_selector(n)),t},this.not=function(t,e,i){},this.empty=function(t,e,i){for(var n,r=0;n=t[r++];)n.length<=0&&(e[i++]=n)},this.only=function(t,e,i){for(var n,r=0;n=t[r++];)1===n.parent.length&&(e[i++]=n)},this.first=function(t,e,i){for(var n,r=0;n=t[r++];)(n=n.parent[0])&&(e[i++]=n)},this.last=function(t,e,i){for(var n,r=0;n=t[r++];)n.nextSibling||(e[i++]=n)},this.odd=function(t,e,i){for(var n,r,s=(this.value,0);n=t[s++];)1&((r=n.parent)&&r.indexOf(n))||(e[i++]=n)},this.even=function(t,e,i){for(var n,r,s=(this.value,0);n=t[s++];)1&((r=n.parent)&&r.indexOf(n))&&(e[i++]=n)},this.eq=function(t,e,i){for(var n,r=this.value,s=0;n=t[s++];)((any=n.parent)&&any.indexOf(n))===r&&(e[i++]=n)},this.gt=function(t,e,i){for(var n,r=this.value,s=0;n=t[s++];)((any=n.parent)&&any.indexOf(n))>r&&(e[i++]=n)},this.lt=function(t,e,i){for(var n,r,s=this.value,o=0;n=t[o++];)((r=n.parent)&&r.indexOf(n))<s&&(e[i++]=n)}},!1),flyingon.Query=Object.extend(function(){var t=flyingon.__parse_selector;this.length=0,this.init=function(e,i){var n,r,s,o,a,l;if(i&&(l=t(e))&&(n=l.select(i))&&(o=n.length)>0){s=this.length,a=flyingon.create(null);for(var h=0;h<o;h++)(r=n[h])&&(l=r.__uniqueId||r.uniqueId())&&!a[l]&&(a[l]=!0,this[s++]=r)}},this.find=function(t){var e=new this.Class(t,this);return e.previous=this,e},this.children=function(t,e,i){},this.end=function(){return this.previous||this},this.on=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.on(t,e);return this},this.once=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.once(t,e);return this},this.off=function(t,e){for(var i,n=0;i=this[n++];)i.off(t,e);return this},this.trigger=function(t){if(t)for(var e,i=0;e=this[i++];)e.trigger.apply(e,arguments);return this},this.hasClass=function(t){var e;return!(!t||!(e=this[0]))&&e.hasClass(t)},this.addClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.addClass(t);return this},this.removeClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.removeClass(t);return this},this.toggleClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.toggleClass(t);return this}},!1),function(){function t(t){var e=+t;return e===e?a[t]=(0|e)+"px":a[t]=t?t.replace(/(\d+)(\s+|$)/g,"$1px$2"):""}function e(t){t.__arrange_dirty=0;for(var i=0,n=t.length;i<n;i++){var r=t[i];switch(r.__arrange_dirty){case 2:r.renderer.update(r);break;case 1:e(r)}}}function i(t){var e,s,o=t.__parent;if(o=o&&i(o)||n,s=t.__name)return e=flyingon.create(o),t.call(e,o),r[s]=e}flyingon.rtl=!1;var n=this,r=flyingon.create(null),s=flyingon.__uniqueId,o=document.createElement("div"),a=flyingon.create(null),l=flyingon.css_map(!0),h=flyingon.css_map(),f={32:["minWidth","min-width"],64:["maxWidth","max-width"],128:["minHeight","min-height"],256:["maxHeight","max-height"]};this.__scroll_html='<div class="f-scroll" style="position:static;overflow:hidden;visibility:hidden;margin:0;border:0;padding:0;width:1px;height:1px;"></div>',this.__text_name="textContent"in document.head?"textContent":"innerText",this.__auto_size=1,this.padding=1,this.createView=function(t,e){var i,n,r=o;return this.render(n=[],t),r.innerHTML=n.join(""),i=r.firstChild,r.removeChild(i),r.innerHTML="",e===!1||(n=i.style).position||(n.position="relative"),this.mount(t,i),i},this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push("></div>")},this.renderDefault=function(e,i,n,r){var s,o=i.__storage||i.__defaults,l=flyingon.html_encode,h=i.__as_html;i.rendered=!0,(s=i.__id||o.id)&&e.push(' id="',l(s),'"'),e.push(' class="',l(i.fullClassName),h?" f-html":" f-absolute",n?" "+n:"",'" style="'),r&&e.push(r),(s=i.__style)&&this.__render_style(e,i,s,l),(s=i.__location_dirty)&&(i.__location_dirty=0,h&&this.__render_location(e,i,s)),(s=o.border)&&e.push("border-width:",a[s]||t(s),";"),(s=o.padding)&&this.padding&&e.push("padding:",a[s]||t(s),";"),o.visible||e.push("display:none;"),e.push('"')},this.__render_style=function(t,e,i,r){var s,o,a=l;for(var h in i)if("cssText"!==h&&""!==(s=i[h]))switch(o=this[h]){case 1:t.push(h,":",r(s),";");break;case 2:t.push(a[h],":",r(s),";");break;case 9:(e.__style_patch||(e.__style_patch={}))[h]=s;break;default:if("function"!=typeof o){if(o=a[h]){t.push(o,":",r(s),";"),n[h]=o===h?1:2;break}n[h]=9}(o=e.__style_patch)||(o=e.__view_patch||(e.__view_patch={}),o=o.__style_patch=u.__style_patch={}),o[h]=s}},this.__render_location=function(e,i,n){for(var r,s,o,l=i.__storage||i.__defaults,h=1;n>=h;){if(n&h)switch(h){case 1:case 2:(s=l[r=1===h?"width":"height"])&&("default"===s||"auto"===s?e.push(r,":auto;"):e.push(r,":",s>=0?s+"px":s,";"));break;case 4:(s=l.margin)&&e.push("margin:",a[s]||t(s),";");break;case 8:(s=l.border)&&e.push("border-width:",a[s]||t(s),";");break;case 16:this.padding&&(s=l.padding)&&e.push("padding:",a[s]||t(s),";");break;case 32:case 64:case 128:case 256:o=f[h],(s=l[o[0]])&&e.push(o[1],":",s>0?s+"px":s,";");break;case 512:case 1024:(s=l[r=h<1e3?"left":"top"])&&e.push(r,":",(o=+s)===o?s+"px":s,";")}h<<=1}},this.mount=function(t,e){var i;t.view=e,(i=t.__uniqueId)||(i=s,i[i=i.id++]=t),e.flyingon_id=i,(i=t.__view_patch)&&(t.__view_patch=null,this.__apply_patch(t,e,i)),(i=t.onmount)&&i.call(t,e)},this.unmount=function(t,e){var i,n=t.view;n&&((i=t.onunmount)&&i.call(t,n),t.view=null,e!==!1&&(i=n.parentNode)&&i.removeChild(n))},this.__update_top=function(t,e,i){var n=t.view,r=n.className.indexOf(" f-rtl");t.__location_values=null,t.left=t.top=0,t.measure(e,i,e,i,i?3:1),flyingon.rtl?r<0&&(n.className+=" f-rtl"):r>=0&&(n.className=n.className.replace(" f-rtl","")),(t.__update_dirty||t.__arrange_dirty)&&this.update(t)},this.update=function(t){t.__as_html?this.locate_html(t):this.locate(t)},this.locate_html=function(t){var e=t.__location_dirty;e&&this.__locate_html(t),t.__update_dirty=!1},this.__locate_html=function(e){var i,n,r,s=e.view.style,o=e.__storage||e.__defaults,l=e.__location_dirty,h=1;for(e.__location_dirty=0;l>=h;){if(l&h)switch(h){case 1:case 2:(n=o[i=1===h?"width":"height"])&&("default"===n||"auto"===n?s[i]="auto":s[i]=n>=0?n+"px":n);break;case 4:case 16:n=o[i=4===h?"margin":"padding"],s[i]=a[n]||t(n);break;case 8:n=o.border,s.borderWidth=a[n]||t(n);break;case 32:case 64:case 128:case 256:r=f[h],n=o[i=r[0]],s[i]=n>0?n+"px":n;break;case 512:case 1024:n=o[i=h<1e3?"left":"top"],s[i]=(r=+n)===r?n+"px":n}h<<=1}},this.locate=function(e){var i,n=e.view.style,r=e.__style_cache,s=this.__auto_size&&e.__auto_size,o=e.offsetLeft,l=e.offsetTop,h=1&s?"auto":e.offsetWidth,f=2&s?"auto":e.offsetHeight;return e.__update_dirty=!1,(i=!r)&&(r=e.__style_cache={}),(i||o!==r.left)&&(n[flyingon.rtl?"right":"left"]=(r.left=o)+"px"),(i||l!==r.top)&&(n.top=(r.top=l)+"px"),(i||h!==r.width)&&(r.width=h,n.width=1&s?h:h+"px"),(i||f!==r.height)&&(r.height=f,n.height=2&s?f:f+"px"),(i=e.__location_dirty)&&(e.__location_dirty=0,8&i&&(s=e.border(),n.borderWidth=a[s]||t(s)),16&i&&this.padding&&(s=e.padding(),n.padding=a[s]||t(s))),r};var c,u=[],d=[],_=[];flyingon.update=function(){var t,i,n=_,r=0;for(c&&clearTimeout(c),flyingon.__update_patch();t=n[r++];)if(t.__update_dirty)(i=t.view)&&(i=i.parentNode)&&t.renderer.__update_top(t,i.clientWidth,i.clientHeight);else switch(t.__arrange_dirty){case 2:t.renderer.update(t);break;case 1:e(t)}n.length=c=0},flyingon.__update_delay=function(t){_.indexOf(t)<0&&(_.push(t),c||(c=setTimeout(flyingon.update,0)))},flyingon.__update_patch=function(){for(var t,e,i,n=d,r=0;t=n[r++];)(i=t.__children_patch)&&(t.__children_patch=null,t.renderer.__children_patch(t,i));for(n=u,r=0;t=n[r++];)(i=t.__view_patch)&&(e=t.view)&&(t.__view_patch=null,t.renderer.__apply_patch(t,e,i));d.length=u.length=0},this.set=function(t,e,i){var n=t.__view_patch;n?n[e]=i:((t.__view_patch={})[e]=i,t.view&&(u.push(t),c||(c=setTimeout(flyingon.update,0))))},this.__apply_patch=function(t,e,i){var n,r;for(var s in i)null!==(r=i[s])&&((n=this[s])?"function"==typeof n&&n.call(this,t,e,r):r||0===r?e.setAttribute(s,r):e.removeAttribute(s))},this.__style_patch=function(t,e,i){var r,s=h,o=e.style;t.__style_patch=null;for(var a in i)switch(r=this[a]){case 0:break;case 1:o[a]=i[a];break;case 2:o[s[a]]=i[a];break;case 9:flyingon.css_value(e,a,i[a]);break;default:"function"!=typeof r?(r=s[a])?(o[r]=i[a],n[a]=r===a?1:2):(flyingon.css_value(e,a,i[a]),n[a]=9):r.call(this,t,e,i[a])}},this.visible=function(t,e,i){e.style.display=i?"":"none"},this.focus=function(t){t.view.focus()},this.blur=function(t){t.view.blur()},this.__render_children=function(t,e,i,n,r){for(var s;n<r;)(s=i[n++])&&(s.view||s.renderer.render(t,s))},this.__mount_children=function(t,e,i,n,r,s){for(var o,a;n<r;)(o=i[n++])&&((a=o.view)?e.insertBefore(a,s):(o.renderer.mount(o,s),s=s.nextSibling))},this.__unmount_children=function(t){for(var e=t.length-1;e>=0;e--){var i=t[e];i&&i.view&&!i.parent&&i.renderer.unmount(i,!1)}},this.__arrange=function(t){var e,i,n,r=[],s=t.__style,o=t.__auto_size;if(1&o)t.__hscroll=!1;else switch(s&&(s["overflow-x"]||s.overflow)){case"scroll":t.__hscroll=!0;break;case"hidden":t.__hscroll=!1;break;default:e=!0}if(2&o)t.__vscroll=!1;else switch(s&&(s["overflow-y"]||s.overflow)){case"scroll":t.__vscroll=!0;break;case"hidden":t.__vscroll=!1;break;default:i=!0}for(var a=0,l=t.length;a<l;a++)(n=t[a])&&(n.__storage||n.__defaults).visible&&r.push(n);flyingon.arrange(t,r,e,i),this.__sync_scroll(t),t.__arrange_dirty=0},this.__sync_scroll=function(t){var e=(t.view_content||t.view).style;e.overflowX=t.__hscroll?"scroll":"hidden",e.overflowY=t.__vscroll?"scroll":"hidden"},this.__children_dirty=function(t){d.push(t),c||(c=setTimeout(flyingon.update,0))},this.__children_patch=function(t,e){for(var i=0,n=e.length;i<n;i++)switch(e[i++]){case 1:this.__insert_patch(t,e[i++],e[i]);break;case 2:this.__remove_patch(t,e[++i])}},this.__insert_patch=function(t,e,i){var n=t.view_content||t.view;this.__unmount_html(t,n,i,0,i.length,n.children[e]||null)},this.__unmount_html=function(t,e,i,n,r,s){var o=[],a=s&&s.previousSibling;this.__render_children(o,t,i,n,r),o[0]&&flyingon.dom_html(e,o.join(""),s),a=a&&a.nextSibling||e.firstChild,this.__mount_children(t,e,i,n,r,a)},this.__remove_patch=function(t,e){for(var i,n,r=0,s=e.length;r<s;r++)(i=e[r])&&(i.autoDispose&&!i.parent?i.dispose():(n=i.view)&&(i=n.parentNode)&&i.removeChild(n))},this.__view_order=function(t,e){var i,n,r,s;e=t.view_content||e,(n=e.lastChild)&&"f-scroll"===n.className&&(s=n,n=n.previousSibling);for(var o=t.length-1;o>=0;o--)(i=t[o])&&(r=i.view)&&(r!==n&&e.insertBefore(r,s||null),n=(s=r).previousSibling)},this.dispose=function(t){var e,i=t.view;i&&((e=i.parentNode)&&e.removeChild(i),this.unmount(t),i.innerHTML="")},flyingon.renderer=function(t,e,i){if(!t)throw"renderer name not allow empty!";if("function"==typeof e)i=e,e="";else if("function"!=typeof i)return;e&&(e=r[e])&&(i.__parent=e),r[i.__name=t]=i},flyingon.renderer.bind=function(t,e){var s=r[e];s&&"function"==typeof s&&(s=i(s)),s?t.renderer=s:t.renderer||(t.renderer=n)}}.call(flyingon.create(null)),flyingon.renderer("HtmlElement",function(t){var e=flyingon.create(null),i=document.createElement("div");e.div="div",e.span="span",e.input="input",this.__scroll_html="",this.render=function(t,n,r,s){var o,a,l=n.__storage||n.__defaults;(o=e[a=n.tagName])||(i.innerHTML="<"+a+"></"+a+">",e[a]=o=i.firstChild?a:"div"),n.__content_render=!0,t.push("<",o),this.renderDefault(t,n,r,s),t.push(">"),(a=l.text)?(l.html||(a=flyingon.html_encode(a)),t.push(a)):n.length>0&&n.__visible&&this.__render_children(t,n,n,0,n.length),t.push("</",o,">")},this.mount=function(e,i){t.mount.call(this,e,i),e.__content_render&&this.__mount_children(e,i,e,0,e.length,i.firstChild)},this.unmount=function(e){this.__unmount_children(e),t.unmount.call(this,e)},this.locate=function(e){t.locate.call(this,e),e.length>0&&this.__locate_children(e)},this.locate_html=function(t){var e=t.__location_dirty;e&&this.__locate_html(t),t.__update_dirty=!1,t.length>0&&this.__locate_children(t)},this.__locate_children=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n&&n.view&&n.renderer.locate_html(n)}t.__arrange_dirty=0},this.__measure_auto=function(t,e){var i=t.view;2&e&&(t.__content_render&&this.locate(t),t.offsetHeight=i&&i.offsetHeight||0)},this.text=function(t,e,i){t.html()?e.innerHTML=i:e[this.__text_name]=i}}),flyingon.renderer("Label",function(t){this.render=function(t,e,i,n){var r=e.__storage||e.__defaults,s=r.text;s&&!r.html&&(s=flyingon.html_encode(s)),t.push("<span"),this.renderDefault(t,e,i,n),t.push(">",s,"</span>")},this.locate=function(e){var i=t.locate.call(this,e),n=e.offsetHeight;return i.lineHeight!==n&&(e.view.style.lineHeight=(i.lineHeight=n)+"px"),i},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.text=function(t,e){var i=t.__storage||t.__defaults;i.html?e.innerHTML=i.text:e[this.__text_name]=i.text}}),flyingon.renderer("Button",function(t){this.render=function(t,e,i,n){t.push('<button type="button"'),this.renderDefault(t,e,i,n),t.push(">"),this.__render_content(t,e),t.push("</button>")},this.__render_content=function(t,e){var i,n=flyingon.html_encode,r=e.__storage||e.__defaults;(i=r.icon)&&(t.push('<span class="',n(i),'" style="width:',i=r.iconSize,"px;height:",i,'px;">',"</span>"),i=!0),(i=r.text)&&(i&&r.vertical&&t.push("<br/>"),r.html||(i=n(i)),t.push("<span>",i,"</span>"))},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.icon=this.iconSize=this.vertical=function(t,e,i){var n=[];this.__render_content(n,t),e.innerHTML=n.join("")},this.text=this.html=function(t,e){var i=t.__storage||t.__defaults;i.html?e.lastChild.innerHTML=i.text:e.lastChild[this.__text_name]=i.text}}),flyingon.renderer("LinkButton",function(t){this.render=function(t,e,i,n){var r,s=e.__storage||e.__defaults;t.push('<a type="button"'),this.renderDefault(t,e,i,n),(r=s.href)&&t.push(' href="',flyingon.html_encode(r),'"'),t.push(">"),(r=s.text)&&(s.html||(r=flyingon.html_encode(r)),t.push(r)),t.push("</a>")},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.text=this.html=function(t,e){var i=t.__storage||t.__defaults;i.html?e.innerHTML=i.text:e[this.__text_name]=i.text},this.href=function(t,e,i){e.href=i}}),flyingon.renderer("Image",function(t){this.render=function(t,e,i,n){var r=flyingon.html_encode,s=e.__storage||e.__defaults,o=s.src,a=s.alt;o&&(o=r(o)),a&&(a=r(a)),t.push("<img"),this.renderDefault(t,e,i,n),t.push(' src="',o,'" alt="',a,'"></img>')},this.src=function(t,e,i){e.src=i},this.alt=function(t,e,i){e.alt=i}}),flyingon.renderer("Slider",function(t){function e(t){var e=t.distanceX;e<this.min?t.distanceX=this.min:e>this.max&&(t.distanceX=this.max)}function i(t){var e=this.control,i=e.__storage||e.__defaults,n=t.distanceX-this.min;n=(i.max-i.min)*n/this.size|0,e.value(n),e.trigger("change","value",n)}this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push(">",'<div class="f-slider-bar" onclick="flyingon.Slider.onclick.call(this, event)"><div></div></div>','<div class="f-slider-button" onmousedown="flyingon.Slider.onmousedown.call(this, event)"><div></div></div>',"</div>")},this.locate=function(e){t.locate.call(this,e),this.refresh(e)},flyingon.Slider.onclick=function(t){var e=flyingon.findControl(this),i=e.__storage||e.__defaults,n=e.view.offsetWidth-i.buttonSize,r=t.offsetX;void 0===r&&(r=t.clientX-e.view.getBoundingClientRect().left),r/=n,r=(i.max-i.min)*(r>1?1:r)|0,e.value(r),e.trigger("change","value",r)},flyingon.Slider.onmousedown=function(t){var n=flyingon.findControl(this),r=n.__storage||n.__defaults,s={control:n},o=s.size=n.view.offsetWidth-r.buttonSize,a=r.value*o/(r.max-r.min)+.5|0;t.dom=this,s.min=-a,s.max=o-a,flyingon.dom_drag(s,t,null,e,i,"y")},this.refresh=function(t){var e=t.__storage||t.__defaults,i=t.view,n=i.lastChild.style,r=i.offsetWidth-e.buttonSize;n.left=(e.value*r/(e.max-e.min)|0)+"px",n.width=e.buttonSize+"px"}}),flyingon.renderer("ProgressBar",function(t){this.render=function(t,e,i,n){var r=(e.__storage||e.__defaults).value;t.push("<div"),this.renderDefault(t,e,i,n),t.push(">",'<div class="f-progressbar-back" style="width:',r,'%;"></div>','<div class="f-progressbar-text"><span>',r,"%</span></div>","</div>")},this.value=function(t,e,i){e.firstChild.style.width=i+"px",e.lastChild.firstChild[this.__text_name]=i+"%"},this.text=function(t,e,i){e.lastChild.style.display=i?"":"none"}}),flyingon.renderer("Panel",function(t){this.__auto_size=0,this.padding=0,this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push(' onscroll="flyingon.__dom_scroll.call(this, event)">'),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,e,0,e.length)),t.push(this.__scroll_html,"</div>")},this.__render_content=function(t,e){var i=[];t.__content_render=!0,this.__render_children(i,t,t,0,t.length),i.push(this.__scroll_html),e.innerHTML=i.join(""),this.mount(t,e)},this.mount=function(e,i){t.mount.call(this,e,i),e.__content_render&&(i=e.view_content||i,this.__mount_children(e,i,e,0,e.length,i.firstChild))},this.unmount=function(e){e.view=e.view_content=null,this.__unmount_children(e),t.unmount.call(this,e)},this.locate_html=function(t){var e=t.__location_dirty,i=0,n=0;e&&this.__locate_html(t),t.__update_dirty=!1,(e=t.view)&&(e=e.parentNode)&&t.adaption()&&(i=e.clientWidth,n=e.clientHeight),t.measure(i,n,i,n),this.locate(t)},this.locate=function(e){t.locate.call(this,e),e.length>0&&!e.__content_render&&this.__render_content(e,e.view_content||e.view),e.__arrange_dirty>1&&(this.__arrange(e),this.__locate_scroll(e));for(var i=0,n=e.length;i<n;i++){var r=e[i];r&&r.view&&r.renderer.locate(r)}},this.__locate_scroll=function(t){var e,i=(t.view_content||t.view).lastChild.style;t.__scroll_cache||(t.__scroll_cache={});t.__hscroll_length!==(e=t.arrangeRight)&&(i.width=(t.__hscroll_length=e)+"px"),t.__vscroll_length!==(e=t.arrangeBottom)&&(i.height=(t.__vscroll_length=e)+"px")}}),flyingon.renderer("GroupBox","Panel",function(t){this.render=function(t,e,i,n){var r,s=e.__storage||e.__defaults,o=s.header,a=s.text;t.push("<div"),this.renderDefault(t,e,i,n),a&&(a=flyingon.html_encode(a)),(r=e.format)&&(a=r.call(e,a)),t.push(">",'<div class="f-groupbox-head" style="height:',o,"px;line-height:",o,"px;text-align:",s.align,';" onclick="flyingon.GroupBox.onclick.call(this, event)">','<span class="f-groupbox-icon ',(r=s.icon)?r:'" style="display:none;','"></span>','<span class="f-groupbox-text">',a,"</span>",'<span class="f-groupbox-flag f-groupbox-',s.collapsed?'close"':'open"',2===s.collapsable?"":' style="display:none;"',"></span>",'<span class="f-groupbox-line"></span>',"</div>",'<div class="f-groupbox-body" style="top:',o,"px;overflow:auto;",(s.collapsed,""),'">'),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,e,0,e.length)),t.push(this.__scroll_html,"</div></div>")},this.mount=function(e,i){e.view_content=i.lastChild,t.mount.call(this,e,i)},flyingon.GroupBox.onclick=function(t){var e=flyingon.findControl(this);e.collapsable()&&e.collapsed(!e.collapsed())},this.header=function(t,e,i){e.firstChild.style.height=e.lastChild.style.top=i+"px"},this.text=function(t,e,i){e=e.firstChild.firstChild.nextSibling,t.format?(i&&(i=flyingon.html_encode(i)),e.innerHTML=t.format(i)):e[this.__text_name]=i},this.icon=function(t,e,i){e=e.firstChild.firstChild,e.className="f-groupbox-icon"+(i?" "+i:""),e.style.display=i?"":"none"},this.collapsable=function(t,e,i){e.firstChild.lastChild.style.display=2===i?"":"none"},this.collapsed=function(t,e,i){e.firstChild.lastChild.previousSibling.className="f-groupbox-flag f-groupbox-"+(i?"close":"open"),e.lastChild.style.display=i?"none":""},this.align=function(t,e,i){e.firstChild.style.textAlign=i}}),flyingon.renderer("ScrollPanel",function(t){function e(t){this.view.firstChild.scrollTop-=100*t.wheelDelta/120,flyingon.dom_stop(t)}this.__auto_size=0,this.padding=0,this.render=function(t,e,i,n){var r=this.__scroll_html;t.push("<div"),this.renderDefault(t,e,i,n),t.push(">",'<div class="f-scrollpanel-scroll" onscroll="flyingon.__dom_scroll.call(this, event)">',r,"</div>",'<div class="f-scrollpanel-body" style="overflow:hidden;">',r,"</div>","</div>")},this.mount=function(i,n){i.view_content=n.lastChild,t.mount.call(this,i,n),i.on("mousewheel",e)},this.unmount=function(e,i){e.view_content=null,this.__unmount_children(e),t.unmount.call(this,e,i)},this.locate=function(e){var i,n,r,s=t.locate.call(this,e);if(e.__arrange_dirty>1&&(i=e.__visible_start,n=e.__visible_end+1,this.__arrange(e),e.__compute_visible(),i>=0))for(;i<=n;)(r=e[i++])&&!r.__visible_area&&this.__locate_position(r);if(r=e.view_content.style,r[flyingon.rtl?"left":"right"]=(e.__vscroll?flyingon.vscroll_width:0)+"px",r.bottom=(e.__hscroll?flyingon.hscroll_height:0)+"px",i=e.__visible_start,n=e.__visible_end+1,i>=0)for(e.__visible_unmount&&(e.__visible_unmount=!1,this.__insert_children(e,e.view_content,i,n));i<n;)r=e[i++],r&&r.view&&r.renderer.locate(r);return s},this.__locate_position=function(t){var e,i=t.view.style,n=t.__locate_cache;n&&(n.left!==(e=t.offsetLeft)&&(i.left=(n.left=e)+"px"),n.top!==(e=t.offsetTop)&&(i.top=(n.top=e)+"px"))},this.__sync_scroll=function(t){var e=t.view,i=e.firstChild.firstChild.style,n=e.lastChild.lastChild.style;i.overflowX=t.__hscroll?"scroll":"hidden",i.overflowY=t.__vscroll?"scroll":"hidden",i.width=n.width=t.arrangeRight+"px",i.height=n.height=t.arrangeBottom+"px"},this.__insert_children=function(t,e,i,n){for(var r,s,o=e.lastChild||null,a=-1,l=n-1;l>=i;l--)(r=t[l])&&((s=r.view)?(s.parentNode!==e&&e.insertBefore(s,o||null),a>0&&(this.__unmount_html(t,e,t,l+1,a,o),a=-1),o=s):a<0&&(a=l+1));a>0&&this.__unmount_html(t,e,t,i,a,o)},this.scroll=function(t,e,i){var n=t.view.lastChild;this.locate(t),n.scrollLeft!==e&&(n.scrollLeft=e),n.scrollTop!==i&&(n.scrollTop=i)}}),flyingon.renderer("Splitter",function(t){function e(t){var e=t.parent,i=t.vertical,n=(t.__storage||t.__defaults).dock;if(e&&(t=e[e.indexOf(t)-1]))return[t,i,i?t.offsetHeight:t.offsetWidth,"right"===n||"bottom"===n]}function i(t){var e=this[0],i=this[1],n=e.__style,r=i?"distanceY":"distanceX",s=this[2]+(this[3]?-t[r]:t[r]),o="visible";s<4&&(s=0,o="hidden"),n&&!n.visibility===o||e.style("visibility",o),e[i?"height":"width"](s)}this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,(n||"")+"cursor:ew-resize;"),t.push(' onmousedown="flyingon.Splitter.onmousedown.call(this, event)"><div></div></div>')},this.locate=function(e){var i=e.offsetWidth>e.offsetHeight;t.locate.call(this,e),e.vertical!==i&&(e.vertical=i,e.view.style.cursor=i?"ns-resize":"ew-resize")},flyingon.Splitter.onmousedown=function(t){var n=flyingon.findControl(this),r=e(n);r&&flyingon.dom_drag(r,t,null,i,null,!0)}}),flyingon.renderer("ListBox",function(t){function e(t,e,n){var r,s=t.storage(),o=s.checked,a=t.__selected,l=n>=0?(l=t.__list).value(l[n]):"";if("checkbox"===o)a&&(r=a.indexOf(n))>=0?(a.splice(r,1),i(e,n,!1,o),r=s.value.split(s.separator),r.splice(r.indexOf(l),1),s.value=r.join(s.separator)):(i(e,n,!0,o),a?a.push(n):a=[n],s.value=(r=s.value)?r+s.separator+l:l),n=a;else{if(n===a)return;a>=0&&i(e,a,!1,o),n>=0&&i(e,n,!0,o),s.value=l}t.__selected=n,t.trigger("change","value",s.value)}function i(t,e,i,n){if(t=t.children[e]){var r=" f-listbox-selected",e=t.className.indexOf(r);if(i)e<0&&(t.className+=r);else{if(!(e>=0))return;t.className=t.className.replace(r,"")}"none"!==n&&(t=t.firstChild)&&(t.checked=i)}}function n(t,e,i,r,s){var o,a,l=r.Class||"div";t.push("<",l);for(var h in r)switch(h){case"Class":case"children":break;default:null!=(a=r[h])&&(":"===h.charAt(0)&&(h=h.substring(1),a="{{index}}"===a?i:"{{item}}"===a?e:e?e[a]:""),a&&"string"==typeof a&&(a=s(a)),"text"===h?o=a:t.push(" ",h,'="',a,'"'))}if(t.push(">"),o)t.push(o);else if(a=r.children)if(a instanceof Array)for(var f=0,c=a.length;f<c;f++)n(t,e,i,a[f],s);else n(t,e,i,a,s);t.push("</",l,">")}this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push(' onclick="flyingon.ListBox.onclick.call(this, event)"></div>')},flyingon.ListBox.onclick=function(t){for(var i=t.target||t.srcElement;i!==this;){var n=i.getAttribute("index");if(n)return void e(flyingon.findControl(this),this,0|n);i=i.parentNode}},this.locate=function(e){t.locate.call(this,e),e.__list&&this.content(e)},this.content=function(t){var e,i,r,s,o,a,l=[],h=t.__list,f=h.valueField,c=h.displayField,u=t.__template,d=flyingon.html_encode,_=t.__storage||t.__defaults,g=_.value,p=_.checked,v="checkbox"===p,y=v?t.__selected=[]:0,m=!v&&_.clear?1:0,w=_.columns,b=_.itemHeight,x=' style="height:'+b+"px;line-height:"+b+"px;",k=flyingon.rtl?"right:":"left:",C=0,T=h.length;for(v&&(g=g.split(_.separator||",").pair()),w<=0&&(w=T),w>1?(a=t.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight,t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom<Math.ceil(T/w)*b&&(a-=flyingon.vscroll_width),e=a/w|0,x+="width:"+(e-10)+"px;"):(e=0,x+=flyingon.rtl?"left:0;":"right:0;"),!u&&(u=_.template)&&("string"==typeof u&&(u=new flyingon.view.Template(u).parse(!0)),t.__template=u=u instanceof Array?u:[u]);C<T;){if(i=h[C],a=C+m,w>1?(s=a%w*e,o=(a/w|0)*b):(s=0,o=a*b),r=f?i?i[f]:"":i,v?(a=g[r])&&y.push(C):(a=g===r)&&(t.__selected=C),l.push('<div class="f-listbox-item',a?' f-listbox-selected"':'"',x,"top:",o,"px;",k,s,'px;" index="',C++,'">'),"none"!==p&&l.push('<input type="',p,'"',a?' checked="checked"':"","/>"),u){a=u.length;for(var P=0;P<a;P++)n(l,i,C,u[P],d)}else a=i,c&&(a=a&&a[c]||""),a&&"string"==typeof a&&(a=d(a)),l.push(a);l.push("</div>")}m&&l.push('<div class="f-listbox-item f-listbox-clear"',x,"top:0;",k,'0;" index="-1"><span>',flyingon.i18ntext("listbox.clear"),"</span></div>"),t.view.innerHTML=l.join("")}}),flyingon.renderer("RadioButton",function(t){this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push('><input type="radio" name="',e.name(),e.checked()?'" checked="checked':"",'" class="f-radio-input" onchange="flyingon.RadioButton.onchange.call(this)" /></div>')},flyingon.RadioButton.onchange=function(){var t=flyingon.findControl(this);t.rendered=!1,t.checked(this.checked),t.rendered=!0,t.trigger("change","value",this.checked)},this.checked=function(t,e,i){e.firstChild.checked=i}}),flyingon.renderer("CheckBox",function(t){this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,n),t.push('><input type="checkbox" name="',e.name(),e.checked()?'" checked="checked':"",'" class="f-checkbox-input" onchange="flyingon.CheckBox.onchange.call(this)" /></div>')},flyingon.CheckBox.onchange=function(){var t=flyingon.findControl(this);t.rendered=!1,t.checked(this.checked),t.rendered=!0,t.trigger("change","value",this.checked)},this.checked=function(t,e,i){e.firstChild.checked=i}}),flyingon.renderer("TextBox",function(t){this.render=function(t,e,i,n){var r=e.__text=e.text();r&&(r=flyingon.html_encode(r)),t.push("<input"),this.renderDefault(t,e,i,n),t.push(' type="text" value="',r,'" oninput="flyingon.TextBox.oninput.call(this)"',' onchange="flyingon.TextBox.onchange.call(this)"/>')},flyingon.TextBox.oninput=function(t){var e=flyingon.findControl(this);e.renderer.oninput(e,this,t)},flyingon.TextBox.onchange=function(){var t=flyingon.findControl(this);try{t.rendered=!1,t.value(this.value)}finally{t.rendered=!0}this.value=t.text(),t.trigger("change","value",t.value())},this.text=function(t,e,i){e.value=t.text()}}),flyingon.renderer("NumberPicker","TextBox",function(t){this.oninput=function(t,e){var i=+e.value;i!==i?e.value=t.__text:t.__text=i}}),flyingon.renderer("TextButton",function(t){this.render=function(t,e,i,n){var r=e.__storage||e.__defaults,s=e.text(),o=r.buttonSize;s&&(s=flyingon.html_encode(s)),t.push("<div"),this.renderDefault(t,e,i,n),t.push(">",'<div class="f-textbutton-body" style="right:',o,'px;">','<input type="text" class="f-textbutton-text" value="',s,r.inputable?"":'" readonly="readonly','" onchange="flyingon.TextButton.onchange.call(this)"/>',"</div>",'<div class="f-textbutton-button ',r.button,'" style="width:',o,'px;" onclick="flyingon.TextButton.onclick.call(this)"></div>',"</div>")},flyingon.TextButton.onclick=function(){var t=flyingon.findControl(this),e=t.__storage;e&&(e.disabled||e.readonly)||t.__on_click()},flyingon.TextButton.onchange=function(){var t=flyingon.findControl(this);t.rendered=!1,t.value(this.value),t.rendered=!0,t.view.firstChild.firstChild.value=t.text(),t.trigger("change","value",this.value)},this.button=function(t,e,i){e.lastChild.className="f-textbutton-button "+i},this.buttonSize=function(t,e,i){e.firstChild.style.right=e.lastChild.style.width=i+"px"},this.text=function(t,e){e.firstChild.firstChild.value=t.text()},this.inputable=function(t,e,i){e=e.firstChild.firstChild,i?e.removeAttribute("readonly"):e.setAttribute("readonly","readonly")}}),flyingon.renderer("Calendar",function(t){function e(t,e,n){var r,s,o=t.__storage||t.__defaults;if(o.month?r=e[0]+"-"+e[1]:(r=e[0]+"/"+e[1]+"/"+e[2],o.time&&(s=e[3].split(":"),r+=" "+s[0]+":"+s[1]+":"+s[2]),r=Date.create(r)),i(t,r))return n&&n(t,e),!0}function i(t,e){return t.value()!==e&&(t.rendered=!1,t.value(e),t.rendered=!0,t.trigger("change","value",e)),t.trigger("selected","value",e)!==!1}function n(t){for(var e,i=[],n=24,r=0;r<3;r++)(e=t[r])?e>n?e=n:1===(e=""+e).length&&(e="0"+e):e="00",i.push(e),n=60;return i.join(":")}function r(t){var e,i=t.__storage||t.__defaults,r=t.__data;r||(e=i.value,t.__data=r=[e?e.getFullYear():0,e?e.getMonth()+1:0,e?e.getDate():0,"",(e=e||new Date).getFullYear(),e.getMonth()+1],i.time&&!i.month&&(r[3]=n([e.getHours(),e.getMinutes(),e.getSeconds()]))),i.month?o(t,r):a(t,r)}function s(t,e){var i,n,r,s,o=[],a=t.__storage||t.__defaults,u=a.min,d=a.max,_=t.oncheck;u&&(u=u.match(/\d+/g)),d&&(d=d.match(/\d+/g)),s=(h(t)-30)/4|0,n='<div style="height:'+s+"px;line-height:"+s+'px;">',i=20*(e[4]/20|0)+1,s=flyingon.i18ntext("calendar.title","Y")[0],s=s.replace("Y",i)+" - "+s.replace("Y",i+19),s='<span tag="to-'+(t.month()?'month">':'date">')+s+"</span>",l(o,e,"year",s),o.push('<div class="f-calendar-year">'),s=e[0];for(var g=0;g<4;g++){o.push(n);for(var p=0;p<5;p++)r=i===s?"f-calendar-selected ":"",(u&&f(u,i)||d&&c(d,i)||_&&_(i)===!1)&&(r+="f-calendar-disabled "),o.push('<span class="',r,'" tag="year">',i++,"</span>");o.push("</div>")}t.view.innerHTML=o.join("")}function o(t,e){var i,n,r,s,o=[],a=flyingon.i18ntext,d=t.__storage||t.__defaults,_=d.min,g=d.max,p=t.oncheck,v=a("calendar.month","")||u,y=e[4];(_=_&&_.match(/\d+/g))&&(_[1]||(_[1]=0)),(g=g&&g.match(/\d+/g))&&(g[1]||(g[1]=12)),s='<span tag="'+(t.month()?'to-year">':'to-date">')+a("calendar.title","Y")[0].replace("Y",y)+"</span>",l(o,e,"month",s),s=(h(t)-30)/3|0,r='<div style="height:'+s+"px;line-height:"+s+'px;">',o.push('<div class="f-calendar-month">'),s=e[1];for(var m=0;m<3;m++){o.push(r);for(var w=0;w<4;w++)i=4*m+w+1,n=i===s?"f-calendar-selected ":"",(_&&f(_,y,i)||g&&c(g,y,i)||p&&p(y,i)===!1)&&(n+="f-calendar-disabled"),o.push('<span class="',n,'" value="',i,'" tag="month">',v[i-1],"</span>");o.push("</div>")}o.push("</div>"),t.view.innerHTML=o.join("")}function a(t,e){var i,n,r,s,o,a,_,g,p,v,y=[],m=flyingon.i18ntext,w=t.__storage||t.__defaults,b=w.min,x=w.max,k=w.today||w.clear||w.time,C=t.oncheck,T=0;(b=b&&b.match(/\d+/g))&&(b[1]||(b[1]=0),b[2]||(b[2]=0)),(x=x&&x.match(/\d+/g))&&(x[1]||(x[1]=12),x[2]||(x[2]=31)),o=m("calendar.title",["Y","M","M Y"]),a=o[0].replace("Y",e[4]),_=o[1].replace("M",(m("calendar.month","")||u)[e[5]-1]),v=o[2].replace("Y",'<span tag="to-year">'+a+"</span>"),v=v.replace("M",'<span tag="to-month">'+_+"</span>"),l(y,e,"date",v),v=m("calendar.week","")||d,y.push('<div class="f-calendar-week" style="height:25px;line-height:25px;">');for(var P=0;P<7;P++)y.push("<span>",v[P],"</span>");y.push('</div><div class="f-calendar-line" style="height:1px;"></div><div class="f-calendar-space" style="height:4px;"></div>'),v=new Date(e[4],e[5],1),i=v.getDay(),v.setDate(-1),n=v.getDate()+1,v=new Date(e[4],e[5]+1,1),v.setDate(-1),r=v.getDate()+1,v=(h(t)-(k?90:60))/6|0,s='<div class="f-calendar-date" style="height:'+v+"px;line-height:"+v+'px;">';for(var P=0;P<6;P++){for(y.push(s);T++<7;)g=7*P-i+T,a=e[4],_=e[5],g<1?(--_<1&&(a--,_=12),g+=n,p=-1):g>r?(++_>12&&(a++,_=1),g-=r,p=1):p=0,o=p?"f-calendar-dark ":"",e[2]===g&&e[1]===_&&e[0]===a&&(o+="f-calendar-selected "),(b&&f(b,a,_,g)||x&&c(x,a,_,g)||C&&C(a,_,g)===!1)&&(o+="f-calendar-disabled "),1!==T&&7!==T||(o+="f-calendar-weekend"),y.push('<span class="',o,'" tag="date" offset="',p,'">',g,"</span>");T=0,y.push("</div>")}k&&(y.push('<div class="f-calendar-space" style="height:4px;"></div><div class="f-calendar-foot" style="height:25px;line-height:25px;">'),w.time&&y.push('<input type="text" class="f-calendar-time" value="',e[3],'" onchange="flyingon.Calendar.onchange.call(this)"/>'),w.clear&&y.push('<span class="f-calendar-clear" tag="clear">',m("calendar.clear","clear"),"</span>"),w.today&&y.push('<span class="f-calendar-today" tag="today">',m("calendar.today","today"),"</span>"),y.push("</div>")),t.view.innerHTML=y.join("")}function l(t,e,i,n){t.push('<div class="f-calendar-head" style="height:30px;line-height:30px;">','<span class="f-calendar-before2" tag="',i,'-2"></span>','<span class="f-calendar-before1" tag="',i,'-1"></span>','<span class="f-calendar-title">',n,"</span>",'<span class="f-calendar-after1" tag="',i,'+1"></span>','<span class="f-calendar-after2" tag="',i,'+2"></span>',"</div>")}function h(t){return t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom}function f(t,e,i,n){var r=e-t[0];return r<0||(0===r&&i>0?(r=i-t[1],r<0||0===r&&n<t[2]):void 0)}function c(t,e,i,n){var r=e-t[0];return r>0||(0===r&&i>0?(r=i-t[1],r>0||0===r&&n>t[2]):void 0)}var u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,(n||"")+"padding:8px;"),t.push(' onclick="flyingon.Calendar.onclick.call(this, event)"></div>')},flyingon.Calendar.onclick=function(t){var n,r=flyingon.findControl(this),l=t.target||t.srcElement,h=r.__data;switch(l.getAttribute("tag")){case"to-year":s(r,h);break;case"to-month":o(r,h);break;case"to-date":a(r,h);break;case"date-2":h[4]-=1,a(r,h);break;case"date-1":--h[5]<1&&(h[5]=12,h[4]--),a(r,h);break;case"date+1":++h[5]>12&&(h[5]=1,h[4]++),a(r,h);break;case"date+2":h[4]+=1,a(r,h);break;case"month-2":h[4]-=10,o(r,h);break;case"month-1":h[4]-=1,o(r,h);break;case"month+1":h[4]+=1,o(r,h);break;case"month+2":h[4]+=10,o(r,h);break;case"year-2":h[4]-=100,s(r,h);break;case"year-1":h[4]-=20,s(r,h);break;case"year+1":h[4]+=20,s(r,h);break;case"year+2":h[4]+=100,s(r,h);break;case"today":n=new Date,h[0]=h[4]=n.getFullYear(),h[1]=h[5]=n.getMonth()+1,h[2]=n.getDate(),e(r,h,a);break;case"clear":h[0]=h[1]=h[2]=0,i(r,null)&&a(r,h);break;case"year":h[0]=h[4]=+l.innerHTML,(r.month()?o:a)(r,h);break;case"month":h[0]=h[4],h[1]=h[5]=+l.getAttribute("value"),r.month()?e(r,h,o):a(r,h);break;case"date":l.className.indexOf("f-calendar-disabled")<0&&(n=h[5]+(0|l.getAttribute("offset")),n<1?(n=12,h[4]--):n>12?(n=1,h[4]++):h[4],h[0]=h[4],h[1]=h[5]=n,h[2]=+l.innerHTML,e(r,h,a))}},flyingon.Calendar.onchange=function(){var t=flyingon.findControl(this),e=this.value.match(/\d+/g);this.value=t.__data[3]=e?n(e):"00:00:00"},this.locate=function(e){t.locate.call(this,e),e.__data=null,r(e)},this.refresh=function(t){t.__data=null,r(t)}}),flyingon.fragment("f-tree-renderer",function(t){function e(t,e){t.className=t.className.replace(" f-tree-node-last",""),t=t.nextSibling,t.className=t.className.replace(" f-tree-list-last",""),(t=t.firstChild)&&i(t,e)}function i(t,e){for(var n;t;)(n=t.firstChild)&&(n.children[e].style.background="",(n=t.lastChild.firstChild)&&i(n,e)),t=t.nextSibling}this.unmount=function(e,i){this.__unmount_children(e),e.view_content=null,t.unmount.call(this,e,i)},this.__children_patch=function(i,n){var r=i.view_content||i.view,s=r.lastChild;t.__children_patch.apply(this,arguments),s!==r.lastChild&&(s=s.firstChild)&&s.className.indexOf(" f-tree-node-last")>=0&&e(s,i.isTreeNode?i.level()+1:0)}}),flyingon.renderer("Tree",function(t){this.__scroll_html="",this.render=function(t,e,i,n){var r=e.__storage||e.__defaults,s=e.length;t.push("<div"),this.renderDefault(t,e,(i||"")+"f-tree-theme-"+r.theme+(r.checked?"":" f-tree-no-check")+(r.icon?"":" f-tree-no-icon")),t.push(' onclick="flyingon.Tree.onclick.call(this, event)">'),s>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,e,0,s)),t.push("</div>")},this.__render_children=function(t,e,i,n,r){for(var s,o="line"===(e.__storage||e.__defaults).theme,a=e.format,l=e[e.length-1];n<r;)(s=i[n++])&&(s.view||s.renderer.render(t,s,a,0,s===l,o))},flyingon.Tree.onclick=function(t){for(var e=flyingon.findControl(this),i=t.target||t.srcElement,n=flyingon.findControl(i);i&&i!==this;)switch(i.getAttribute("tag")){case"folder":return void e[n.expanded?"collapse":"expand"](n);case"check":return void n.checked(!n.checked());case"node":return e.trigger("node-click","node",n),void e.current(n);default:i=i.parentNode}},flyingon.fragment("f-tree-renderer",this,t),this.mount=function(e,i){var n=e.__current;t.mount.call(this,e,i),e.__content_render&&this.__mount_children(e,i,e,0,e.length,i.firstChild),n&&n.view&&setTimeout(function(){e.renderer.scrollTo(e,n)},500)},this.theme=function(t,e,i){e.className=e.className.replace(/f-tree-theme-\w+/,"f-tree-theme-"+i)},this.checked=function(t,e,i){var n=e.className;i?n=n.replace(" f-tree-no-check",""):n+=" f-tree-no-check",e.className=n},this.icon=function(t,e,i){var n=e.className;i?n=n.replace(" f-tree-no-icon",""):n+=" f-tree-no-icon",e.className=n},this.scrollTo=function(t,e){var i,n=t.view,r=e.view,s=n.scrollTop,o=r.offsetTop;o<s?n.scrollTop=o:o>s+(i=n.clientHeight)&&(n.scrollTop=o+r.offsetHeight-i)}}),flyingon.renderer("TreeNode",function(t){function e(t,e,i){for(var n=t.firstChild.lastChild;n;){if(n.getAttribute("tag")===e)return i&&(n.className=i),n;n=n.previousSibling}}this.render=function(t,e,i,n,r,s,o){var a,l,h,f=flyingon.html_encode,c=e.__storage||e.__defaults;e.rendered=!0,t.push('<div class="',f(e.fullClassName),'">','<div class="f-tree-node',r&&s?" f-tree-node-last":"",e.__current?" f-tree-node-current":"",(h=c.className)?" "+f(h):"",(h=c.id)?'" id="'+f(h)+'"':"",'" tag="node">'),o&&t.push(o),(h=c.delay)&&(c.delay=!1),h||e.length>0?h||!e.expanded?(a="f-tree-icon-close",t.push('<span class="f-tree-folder f-tree-close" tag="folder"></span>')):(a="f-tree-icon-open",t.push('<span class="f-tree-folder f-tree-open" tag="folder"></span>')):(a="f-tree-icon-file",t.push('<span class="f-tree-file"></span>')),l=(l=c.text)?f(l):"",i&&(l=i(e,l)),t.push('<span class="f-tree-check f-tree-',c.checked?"checked":"unchecked",'" tag="check"></span>','<span class="f-tree-icon ',c.icon||a,'" tag="icon"></span>','<span class="f-tree-text" tag="text">',l,"</span></div>",'<div class="f-tree-list',r&&s?" f-tree-list-last":"",'">'),e.expanded&&e.length>0&&this.__render_children(t,e,e,0,e.length,i,++n,r,s),t.push("</div></div>")},this.__render_children=function(t,e,i,n,r,s,o,a,l){var h,f,c;if(e.__content_render=!0,void 0===s&&(h=e.parent)){o=1,a=h[h.length-1]===e;do{if(!h.isTreeNode){s=h.format||null,l="line"===(h.__storage||h.__defaults).theme;break}o++}while(h=h.parent)}for(f=a&&l?' style="background:none;"':"",f='<span class="f-tree-space"'+f+"></span>",o>1&&(f=new Array(o+1).join(f)),c=i.length;n<r;)(h=i[n++])&&(h.view&&h.renderer.unmount(h),h.renderer.render(t,h,s,o,n===c,l,f))},flyingon.fragment("f-tree-renderer",this,t),this.mount=function(e,i){var n=e.view_content=i.lastChild;t.mount.call(this,e,i),e.__content_render&&this.__mount_children(e,i,e,0,e.length,n.firstChild)},this.checked=function(t,i,n){n=n?"checked":t.checkedChildren?"checked2":"unchecked",e(i,"check","f-tree-check f-tree-"+n)},this.icon=function(t,i,n){e(i,"icon","f-tree-icon "+n)},this.text=function(t,i,n){var r;if(i=e(i,"text")){for(;(r=t.parent)&&r.isTreeNode;)t=r;(r=t&&t.format)?i.innerHTML=format(flyingon.html_encode(n)):i[this.__text_name]=n}},this.expand=function(t){var i,n=t.view,r=e(n,"folder"),s=e(n,"icon");t.length>0?(r&&(r.className="f-tree-folder f-tree-open"),s&&(s.className="f-tree-icon f-tree-icon-open"),n=n.lastChild,t.__content_render||(this.__render_children(i=[],t,t,0,t.length),n.innerHTML=i.join(""),this.__mount_children(t,n,t,0,t.length,n.firstChild)),n.style.display=""):(r&&(r.className="f-tree-file",r.removeAttribute("tag")),s&&(s.className="f-tree-icon f-tree-icon-file"),n.lastChild.style.display="none")},this.collapse=function(t){var i=t.view;i.lastChild.style.display="none",e(i,"folder","f-tree-folder f-tree-close"),(i=e(i,"icon"))&&(i.className=i.className.replace("f-tree-icon-open","f-tree-icon-close"))},this.current=function(t,e){var i=t.view.firstChild,n=i.className,r=" f-tree-node-current";e?n.indexOf(r)<0&&(i.className+=r):i.className=n.replace(r,"")}}),flyingon.renderer("GridColumn",function(t){function e(t,e,n,r){for(var s,o,a=(e.__size,n.length),l=0,h=0;h<a;h++)o=n[h],s=o.__height,s=s>0?s:r/(a-h)|0,i(t,e,o,l,o.__size||e.__size,s),l+=s,r-=s}function i(t,e,i,n,r,s){i.row=null,i.column=e,i.__as_html=!0,i.renderer.render(t,i,"f-grid-cell"+e.fullClassName,"left:"+e.__start+"px;top:"+n+"px;width:"+r+"px;height:"+s+"px;line-height:"+s+"px;"+(i.columnSpan?"z-index:1;":""))}this.render=function(t,n,r){var s=n.__cells;s[1]?e(t,n,s,r):i(t,n,s[0]||n.__set_title("")[0],0,n.__size,r)},this.mount=function(t,e,i,n){var r,s,o=t.grid,a=t.__cells,l=0;for(t.view=!0;(r=a[l++])&&(s=e.firstChild);)r.parent=o,r.renderer.mount(r,s),i.insertBefore(s,n)},this.unmount=function(t,e){var i,n=0;for(t.view=!1,e||(e=t.__cells);i=e[n++];)i.view&&(i.parent=null,i.renderer.unmount(i,!1))},this.readonly=function(t,e){},this.__resize_height=function(t,e){var i,n,r,s,o,a=t.__cells,l=a.length;if(l>1)for(i=o=0;n=a[i];)s=n.__height,s=s>0?s:e/(l-i)|0,r=n.view.style,r.top=o+"px",r.height=r.lineHeight=s+"px",o+=s,e-=s,i++;else r=a[0].view.style,r.height=r.lineHeight=e+"px"}}),flyingon.renderer("GridRow",function(t){function e(t,e,i){var n;if(i)for(var r in t)(n=t[r])&&(n.view.className+=e);else for(var r in t)(n=t[r])&&(n.view.className=n.view.className.replace(e,""))}var i=1;this.show=function(t,e,n,r,s,o,a,l,h){var f,c,u,d,_,g=n.__cells;for(g||(n.view=!0,g=n.__cells={});s<o;)d=r[s],_=d.__name||(d.__name="__column_"+i++),(f=g[_])?(d.__tree_cell&&(t.appendChild(c=n.view),f.__top!==a&&(c.style.top=a+"px"),f.__show_tag!==h&&(u=c.style,u.left=d.__start+"px",u.height=((_=f.rowSpan)?++_*l:l)+"px")),t.appendChild(c=f.view),(_=d.onshowing)&&_.call(d,f,n),f.__top!==a&&(c.style.top=(f.__top=a)+"px"),f.__show_tag!==h&&(f.__show_tag=h,u=c.style,u.left=d.__start+"px",_=(_=f.columnSpan)?d.__span_size(_):0,u.width=d.__size+_+"px",u.height=((_=f.rowSpan)?++_*l:l)+"px")):(f=this.render(e,n,d,a,l))&&(f.__top=a,f.__show_tag=h,g[_]=f),s++},this.render=function(t,e,i,n,r){var s,o,a=i.createControl(e,i.__name),l=i.__size;return(o=i.onrender)&&(o.call(i,a,e,i),(o=a.rowSpan)&&((o|=0)>0?(s=1,r+=o*r):o=0,a.rowSpan=o),(o=a.columnSpan)&&((o|=0)>0?(s=1,l+=i.__span_size(o)):o=0,a.columnSpan=o)),a.row=e,a.column=i,a.__as_html=!0,(o=i.onshowing)&&o.call(i,a,e),i.__tree_cell&&this.render_tree(t,e,i,n,r,a),o=(o=i.__align)?"text-align:"+o+";":"",s&&(o+="z-index:1;"),a.renderer.render(t,a,"f-grid-cell"+i.fullClassName+(e.__checked?" f-grid-checked":"")+(e.__current?" f-grid-current":""),"left:"+i.__start+"px;top:"+n+"px;width:"+l+"px;height:"+r+"px;line-height:"+r+"px;"+o),a},this.render_tree=function(t,e,i,n,r,s){var o=e.length>0?e.expanded?"expand":"collapse":"file",a=i.__tree_icon,l=16;for(a&&(l+=16,(a=i.grid.onicon)&&(a=a.call(i.grid,e,i)),a||(a="f-grid-icon-"+o));e=e.parent;)l+=16;t.push('<div class="f-grid-tree" style="',"left:"+i.__start+"px;top:"+n+"px;width:"+l+"px;height:"+r+"px;line-height:"+r+'px;"><span class="f-grid-',o,'" tag="',o,'"',"></span>",'<span class="f-grid-icon',a?" "+a:'" style="display:none;','"></span>',"</div>"),s.padding("0 2 0 "+(l+2))},this.mount=function(t,e,i,n,r,s,o){for(var a,l,h,f,c=e.grid,u=e.__cells;n<r;)(a=i[n++])&&(f=a.__name)&&(l=u[f])&&((h=l.view)?o=h.nextSibling||null:(h=t.firstChild)&&(a.__tree_cell&&(s.insertBefore(h,o),e.view=h,h.row=e,h.column=a,h=t.firstChild),s.insertBefore(h,o),l.parent=c,l.renderer.mount(l,h)));return o},this.unmount=function(t){var e,i=t.__cells;for(var n in i)(e=i[n])&&(e.parent=e.row=e.column=null,e.renderer.unmount(e,!1),i[n]=null)},this.checked=function(t,i,n){e(t.__cells," f-grid-checked",n)},this.current=function(t,i,n){e(t.__cells," f-grid-current",n)}}),flyingon.renderer("GroupGridRow","GridRow",function(t){this.render=function(t,e,i,n,r){var s,o,a=new flyingon.Label,l=i.__storage,h=l&&l.summary;return a.__as_html=!0,h&&(o=l.name)&&(s=i.__summary_fn||(i.__summary_fn=flyingon.Grid.summary(h)),o=e.compute(i,o,s[0],s[1]),o=(s=i.onsummary)&&(s=s.call(i,e,o,h))?s:h+"="+o.toFixed(l.precision),a.text(o)),a.renderer.render(t,a,"f-grid-group-row","left:"+i.__start+"px;top:"+n+"px;width:"+i.__size+"px;height:"+r+"px;line-height:"+r+"px;"),a},this.unmount=function(e){var i=e.view_group;t.unmount.call(this,e),i&&(i.row=e.view_group=null)}}),flyingon.renderer("Grid",function(t){function e(t){this.view_scroll.scrollTop-=100*t.wheelDelta/120,flyingon.dom_stop(t)}function i(t){var e=t.target;e.__column_check?e.row.checked(!e.row.__checked):e.parent.__change_value(e)}function n(){var t,e,i,n,r=document.activeElement;r&&(t=flyingon.findControl(r))&&(e=t.parent,r=t.view,i=r.parentNode,n=r.offsetLeft,(n<e.scrollLeft||n+r.offsetWidth>i.offsetWidth)&&(e.view_scroll.scrollLeft=t.column.__start),r.offsetTop+r.offsetHeight>i.offsetHeight&&(e.view_scroll.scrollTop=r.offsetTop))}function r(t,e,i,n){if(i.className="f-grid-"+n,i.setAttribute("tag",n),(i=i.nextSibling)&&i.className.indexOf("f-grid-icon")>=0){var r=t.onicon;r&&(r=r.call(t,e,i.parentNode.column)),r||(r="f-grid-icon-"+n),i.className="f-grid-icon "+r}}function s(t,e){var i=t.view_sort,n=i.cell===e&&!i.desc;i.cell=e,i.desc=n,i.className="f-grid-sort"+(n?" f-grid-sort-desc":""),t.sort(e.column.name(),n),o(i)}function o(t){var e,i,n=t.cell;n&&(e=n.view)&&((i=e.parentNode)?(t.style.left=i.offsetLeft+e.offsetLeft+e.offsetWidth-18+"px",t.style.top=e.offsetTop+(e.offsetHeight-16>>1)+"px"):t.style.left="-100px")}function a(){x=!0}function l(t){var e=this.size;e+t.distanceX<1&&(t.distanceX=-e+1)}function h(t){var e=this.grid,i=this.column,n=this.size+t.distanceX;x=!1,e.view_head.style.cursor="",e.view.removeChild(w),i.__size!==n&&(i.storage().size=n,(n=e.oncolumnresize)&&n.call(e,i,storage.__size,this.size),e.update(!0))}function f(t,e,i,n,r){var s,o=flyingon.findControl(t);i?n=i.name():n&&(i=o.__columns.find(n))&&(s=!0),i&&i.draggable()&&flyingon.dom_drag({grid:o,column:i,dom:e,name:n,index:i.__index,count:r,from:s},event,c,u,g)}function c(t){var e,i,n=this.grid,r=n.__storage||n.__defaults,s=this.dom,o=this.thumb=m,a=this.count;if(this.group=i=r.group,this.header=r.header,i=n.view.firstChild.getBoundingClientRect(),this.left=i.left,this.top=i.top,this.from)s.style.cssText="position:absolute;z-index:2;left:"+s.offsetLeft+"px;top:"+s.offsetTop+"px;",i=n.__groups,i.splice(i.indexOf(this.name),1),n.__storage.groups=" ";else{for(i=s.cloneNode(!0),e=i.style,e.borderWidth="1px",e.left=s.offsetLeft+s.parentNode.offsetLeft+"px",e.top=s.offsetTop+s.parentNode.parentNode.offsetTop+"px",s=i,i=n.__columns;a--;)i[this.index+a].__visible=!1;n.update(!0)}t.dom=s,s.style.zIndex=2,i=n.view.firstChild,i.appendChild(o),i.appendChild(s),x=!0}function u(t){var e,i=this.grid,n=this.thumb.style,r=t.clientX-this.left,s=t.clientY-this.top;(this.to=this.name&&s<this.group)?(s=4,e=this.group-8,i.__groups?r=d(this,i.view_group,r):(this.at=0,r=8)):(r=_(this,i,r),s=this.group,e=this.header),n.left=r-11+"px",n.top=s+"px",n.height=e+"px"}function d(t,e,i){var n=0,r=0,s=0;for(e=e.firstChild;e;){if(r=e.offsetLeft,s=e.offsetWidth,r+(s>>1)>i)return t.at=n,r-4;if(r+s>i)break;n++,e=e.nextSibling}return t.at=n,r+s+4}function _(t,e,i){var n,r=e.__columns,s=r.__locked,o=s[0],a=r.length,l=0,h=0,f=0;for(o&&s[2]>i?(a=o,o=0):s[1]&&i>(l=r.__arrange_size-s[3])?(o=a-s[1],i+=l):(l=0|-e.scrollLeft,i-=l),console.log(r[2].__visible);o<a;)if(n=r[o++],n.__visible){if(h=n.__start,f=n.__size,h+(f>>1)>i)return t.at=o-1,h+l;if(h+f>i)break}return t.at=o,h+f+l}function g(t){var e,i=this.grid,n=i.__columns,r=this.index,s=this.count,o=[];if(x=!1,(e=this.thumb)&&e.parentNode.removeChild(e),(e=t.dom)&&e.parentNode.removeChild(e),this.to){for(var a=0;a<s;a++)o.push(n[r+a].name());(e=i.__groups)?(e.splice(this.at,0,o.join(" ")),e=e.join(" ")):e=o.join(" "),i.groups(e)}else{this.from&&i.groups(i.__groups.join(" "));for(var a=0;a<s;a++)n[r+a].__visible=!0;this.at!==r&&p(n,this.at,r,s),i.update(!0)}}function p(t,e,i,n){var r=[].splice,s=r.call(t,i,n||(n=1));s[0]&&(e>i&&(e-=n),s[1]?(s.unshift(e,0),r.apply(t,s)):r.call(t,e,0,s[0]))}function v(t,e,i,n,r){var s=t.firstChild,o=s.style;o[flyingon.rtl?"right":"left"]=-r+"px",s=s.nextSibling,o=s.style,i>0?(o.width=i+"px",o.display=""):o.display="none",s=s.nextSibling,o=s.style,e>0?(o.width=e+"px",o.display=""):o.display="none",o=s.nextSibling.style,n>0?(o.width=n+"px",o.display=""):o.display="none"}function y(t,e){var i,n=t.view_body,r=document.activeElement;if(e){for(i=r;i=i.parentNode;)if(i===n)return y.dom=r,void n.focus()}else(i=y.dom)&&(r===n?i.focus():y.dom=null)}var m=document.createElement("div"),w=document.createElement("div"),b=this.__text_name,x=!1,k="input,select,textarea".toUpperCase().split(","),C=1,T=document.createDocumentFragment(),P=document.createElement("div"),N='<div class="f-grid-center"></div><div class="f-grid-right" style="display:none;"></div><div class="f-grid-left" style="display:none;"></div><div class="f-grid-group" style="display:none;"></div>';this.padding=0,m.innerHTML='<div class="f-grid-drag-body"><div></div></div>',m.className="f-grid-drag",m.style.width="20px",w.className="f-grid-resize-thumb",this.render=function(t,e,i,n){var r=e.__storage||e.__defaults,s=r.group,o=r.header,a=s+o,l=N;t.push("<div"),this.renderDefault(t,e,i,n),t.push(' onclick="flyingon.Grid.onclick.call(this, event)" onkeydown="flyingon.Grid.onkeydown.call(this, event)">','<div class="f-grid-head" onmousedown="flyingon.Grid.onmousedown.call(this, event)">','<div class="f-grid-group-box" style="height:',s,"px;line-height:",s,"px;",s<2?"display:none;":"",'"></div>','<div class="f-grid-column-head" style="height:',o,"px;",o<2?"display:none;":"",'" onmouseover="flyingon.Grid.onmouseover.call(this, event)">',l,'<div class="f-grid-resize" style="display:none;" onmousedown="flyingon.Grid.resize.call(this, event)"></div>','<div class="f-grid-sort" style="left:-100px;"></div>',"</div>",'<div class="f-grid-filter" style="display:none;">',l,"</div>","</div>",'<div class="f-grid-scroll" style="top:',a,'px;" onscroll="flyingon.Grid.onscroll.call(this)">',this.__scroll_html,"</div>",'<div class="f-grid-body" style="top:',a,'px;" tabindex="0">','<div class="f-grid-middle">',l,"</div>",'<div class="f-grid-bottom" style="display:none;">',l,"</div>",'<div class="f-grid-top" style="display:none;">',l,"</div>","</div>","</div>")},this.mount=function(n,r){var s,o=r.firstChild;n.view_group=s=o.firstChild,n.view_head=s=s.nextSibling,n.view_resize=(n.view_sort=s.lastChild).previousSibling,n.view_filter=s.nextSibling,n.view_scroll=s=o.nextSibling,n.view_body=s.nextSibling,t.mount.call(this,n,r),n.on("mousewheel",e),n.on("change",i)},this.unmount=function(e){t.unmount.call(this,e),e.view_group=e.view_head=e.view_resize=e.view_sort=e.view_filter=e.view_scroll=e.view_body=null},flyingon.Grid.onkeydown=function(t){9===t.keyCode&&setTimeout(n,0)},flyingon.Grid.onclick=function(t){if(x)x=!1;else{var e,i=flyingon.findControl(this),n=t.target||t.srcElement;switch(n.getAttribute("tag")){case"expand":r(i,e=n.parentNode.row,n,"collapse"),i.__view.__collapse_row(e);break;case"collapse":r(i,e=n.parentNode.row,n,"expand"),i.__view.__expand_row(e);break;default:(e=flyingon.findControl(n))&&!e.__column_check&&(e.row?i.__set_current(e.row):e.column&&!e.columnSpan&&e.column.name()&&s(i,e))}}},flyingon.Grid.onmouseover=function(t){var e,i,n,r,s=t.target||t.srcElement;if(s.className.indexOf("f-grid-cell")>=0&&(n=flyingon.findControl(s))&&(e=flyingon.findControl(this))&&(i=n.column)&&((r=n.columnSpan)&&(i=e.__columns[i.__index+r]),i&&i.resizable())){var o=e.view_resize,a=o.style;o.column=i,a.left=s.parentNode.offsetLeft+s.offsetLeft+s.offsetWidth-3+"px",a.top=s.offsetTop+"px",a.height=s.offsetHeight+"px",a.display=""}},flyingon.Grid.resize=function(t){var e,i=flyingon.findControl(this),n=this;i.__column_dirty=!0,i.view.appendChild(t.dom=w),n=i.view_head,n.style.cursor="ew-resize",e=t.dom.style,e.left=this.offsetLeft+(this.offsetWidth>>1)+1+"px",e.top=n.offsetTop+"px",e.bottom=i.view_body.style.bottom,flyingon.dom_drag({grid:i,column:e=this.column,size:e.__size},t,a,l,h,"y",!1)},flyingon.Grid.onmousedown=function(t){var e,i,n=t.target||t.srcElement;if(k.indexOf(n.tagName)<0)if(i=n.getAttribute("column-name"))f(this,n,null,i,1);else for(e=flyingon.findControl(n);e;){if(i=e.column){f(this,n,i,"",(0|e.columnSpan)+1);break}e=e.parent}},flyingon.Grid.onscroll=function(){var t=flyingon.findControl(this),e=this.scrollLeft,i=this.scrollTop;t.scrollLeft!==e&&(t.renderer.__do_hscroll(t,t.scrollLeft=e),o(t.view_sort)),t.scrollTop!==i&&t.renderer.__do_vscroll(t,t.scrollTop=i)},this.locate=function(e){t.locate.call(this,e),this.content(e,e.view)},this.locate_html=function(t){},this.header=function(t,e,i){var n,r=t.__columns,s=t.__storage||t.__defaults,o=s.group,a=s.header;if(t.view_body.style.top=t.view_scroll.style.top=o+a+"px",i>1){n=t.view_head.style,n.display=a>1?"":"none",n.height=a+"px";for(var l=r.length-1;l>=0;l--){var h=r[l];h.view&&h.renderer.__resize_height(h,a)}}else n=t.view_group.style,n.display=o>1?"":"none",n.height=n.lineHeight=o+"px"},this.content=function(t,e){this.show(t,0|t.scrollLeft,0|t.scrollTop,t.offsetWidth-t.borderLeft-t.borderRight,t.offsetHeight-t.borderTop-t.borderBottom)},this.show=function(t,e,i,n,r){var s,o=t.__storage||t.__defaults,a=t.__columns,r=(t.__rows,t.offsetHeight-t.borderTop-t.borderBottom);(s=o.group)>0&&(r-=s),s=a.__arrange_size!==n,t.__column_dirty||s&&a.__persent?(t.__column_dirty=!1,a.__show_tag=C++,a.__compute_size(n),a.__compute_visible(e)):(s||a.__arrange_start!==e)&&(a.__arrange_size=n,a.__compute_visible(e)),a.__size>n?(s=flyingon.hscroll_height,r-=s):s=1,t.view_body.style.bottom=s+"px",t.view_scroll.firstChild.style.width=a.__size+"px",(s=o.header)>0&&(r-=s,this.__show_header(t,a,s)),(s=o.filter)>0&&(r-=s,this.__show_filter(t,a,s)),s=this.__show_body(t,t.currentView(),r),this.__layout_locked(t,a.__locked,s)},this.__show_header=function(t,e,i){var n,r=t.view_head.children[3],s=e.__locked;r=r.previousSibling,(n=s[0])&&this.show_header(r,e,0,n,i),r=r.previousSibling,(n=s[1])&&this.show_header(r,e,e.length-n,e.length,i),this.show_header(r.previousSibling,e,e.__show_start,e.__show_end,i),o(t.view_sort)},this.__layout_locked=function(t,e,i){var n=t.view_head,r=e[2],s=e[3],o=t.__group_size,a=0|t.scrollLeft;(i=i&&s>0)&&(s+=1),v(n,r,i?s+flyingon.vscroll_width:s,o,a),v(n=t.view_body.firstChild,r,s,o,a),v(n=n.nextSibling,r,s,o,a),v(n.nextSibling,r,s,o,a)},this.show_header=function(t,e,i,n,r){for(var s,o,a,l,h,f,c,u=[],a=e.__show_tag,d=T,_=i;_<n;)if((s=e[_++]).__visible)if(s.view)for(c=0,h=s.__cells,(l=s.__show_tag!==a)&&(s.__show_tag=a);f=h[c++];)d.appendChild(o=f.view),l&&(l=o.style,l.left=s.__start+"px",l.width=(f.__size||s.__size)+"px");else s.__show_tag=a,s.renderer.render(u,s,r);if(u[0])for(c=P,c.innerHTML=u.join(""),a=d.firstChild;i<n;)(s=e[i++]).__visible&&((o=s.view)?a=o.nextSibling||null:s.renderer.mount(s,c,d,a));for(;c=t.lastChild;)t.removeChild(c);t.appendChild(d)},this.__show_filter=function(t,e,i){},this.__show_body=function(t,e,i){var n,r=t.view_body.lastChild,s=t.__storage||t.__defaults,o=t.__locked_top,a=e.length,l=e.__row_height=s.rowHeight,h=s.treeColumn,f=a*l,c=f>i;return(n=h&&t.__columns.find(h))&&(n.__tree_cell=!0,n.__tree_icon=s.treeIcon),t.view_scroll.firstChild.style.height=(f||1)+"px",t.view_body.style[flyingon.rtl?"left":"right"]=(c?flyingon.vscroll_width:0)+"px",o>0?(r.style.display="",r.style.height=(f=o*l)+"px",i-=f,this.__show_rows(t,r,e,0,o)):(f=0,r.style.display="none"),r=r.previousSibling,(n=t.__locked_bottom)>0?(r.style.display="",r.style.height=(f=n*l)+"px",i-=f,this.__show_rows(t,r,e,a-n,a),a-=n):r.style.display="none",r=r.previousSibling,r.style.top=-(0|t.scrollTop)+"px",e.__arrange_size=i,c?this.__visible_rows(t,e,0|t.scrollTop):(e.__show_start=o,e.__show_end=a),this.__show_rows(t,r,e,e.__show_start,e.__show_end,!0),c},this.__visible_rows=function(t,e,i,n){var r,s=t.__locked_top,o=e.length-t.__locked_bottom,a=e.__row_height;return i>0&&(s+=i/a|0),r=e.__arrange_size/a|0,r+=s+3,r<o&&(o=r),!!(n&&e.__show_start<=s&&e.__show_end>=o)||((r=t.onrowstart)&&(r=r.call(t,e,s),r>=0&&(s=0)),e.__show_start=s,void(e.__show_end=o))},this.__show_rows=function(t,e,i,n,r,s){var o,a=t.__columns,l=a.__locked,h=i.__row_height,f=l[0],c=a.length,u=s?n*h:0;e=e.lastChild,(o=t.__group_size)?this.show_group(t,e,i,n,r,u,h):e.firstChild&&(e.innerHTML=""),e=e.previousSibling,f?this.show_rows(t,e,i,n,r,a,0,f,u,h):e.firstChild&&(e.innerHTML=""),e=e.previousSibling,(o=l[1])?this.show_rows(t,e,i,n,r,a,c-o,c,u,h):e.firstChild&&(e.innerHTML=""),this.show_rows(t,e.previousSibling,i,n,r,a,a.__show_start,a.__show_end,u,h)},this.show_rows=function(t,e,i,n,r,s,o,a,l,h){for(var f,c,u=[],d=s.__show_tag,_=T,g=n;g<r;g++)(f=i[g])&&(f.__show_index=g,f.renderer.show(_,u,f,s,o,a,l,h,d),l+=h);if(u[0]){c=P,c.innerHTML=u.join(""),d=_.firstChild;for(var g=n;g<r;g++)d=(f=i[g]).renderer.mount(c,f,s,o,a,_,d)}for(;c=e.lastChild;)e.removeChild(c);e.appendChild(_)},this.show_group=function(t,e,i,n,r,s,o){for(var a,l,h,f,c=[],u=T,d=t.__columns.__show_tag,_=t.__group_size,g=t.ongroup,p=n;p<r;)(a=i[p])&&(a.__group_row&&(a.__show_index=p,h=f=g&&g(a)||a.text+" ("+a.total+")",(l=a.view_group)?(u.appendChild(l),a.__text!==h&&(l.firstChild.nextSibling[b]=a.__text=h),a.__top!==s&&(l.style.top=(a.__top=s)-1+"px")):c.push('<div class="f-grid-group-row" style="top:',(a.__top=s)-1,"px;height:",o+1,"px;line-height:",o,"px;min-width:",_,"px;",'px;text-align:left;">','<span class="f-grid-',a.expanded?'expand" tag="expand"':'collapse" tag="collapse"',' style="margin-left:',20*a.level,'px;"></span>',"<span> ",a.__text=h,"</span>",'<div class="f-grid-group-line" style="top:0;bottom:auto;"></div>','<div class="f-grid-group-line"></div>',"</div>")),s+=o),p++;if(e.style.height=s+"px",c[0])for(f=P,f.innerHTML=c.join(""),d=u.firstChild;n<r;)(a=i[n])&&a.__group_row&&((l=a.view_group)?d=l.nextSibling||null:(l=f.firstChild,l.row=a,a.view_group=l,u.insertBefore(l,d))),n++;for(;f=e.lastChild;)e.removeChild(f);e.appendChild(u)},this.__render_group=function(t){var e,i,n,r=[],s=t.__groups,o=t.__columns;if(s)for(var a=0,l=s.length;a<l;a++)(e=o.find(n=s[a]))&&(e.__visible=!1,i=e.__cells,r.push('<span class="f-grid-group-cell" column-name="',n,'">',e.__find_text()||n,"</span>"));else r.push('<span class="f-information">',flyingon.i18ntext("grid.group"),"</span>");t.view_group.innerHTML=r.join("")},this.__do_hscroll=function(t,e){var i=t.__columns,n=t.view_head.firstChild,r=(t.__storage||t.__defaults).header,s=flyingon.rtl?"right":"left",o=-e+"px",a=!i.__compute_visible(e,!0),l=i.__show_start,h=i.__show_end;if(r>0&&(n.style[s]=o,a&&this.show_header(n,i,l,h,r)),n=t.view_body.firstChild,n.firstChild.style[s]=o,n=n.nextSibling,n.firstChild.style[s]=o,n.nextSibling.firstChild.style[s]=o,a){var f,c=t.currentView();y(t,!0),n=t.view_body.firstChild,r=c.__row_height,(f=t.__locked_top)&&this.show_rows(t,n.nextSibling.firstChild,c,0,f,i,l,h,0,r),(f=t.__locked_bottom)&&this.show_rows(t,n.nextSibling.nextSibling.firstChild,c,c.length-f,c.length,i,l,h,0,r),this.show_rows(t,n.firstChild,c,f=c.__show_start,c.__show_end,i,l,h,f*r,r),y(t)}},this.__do_vscroll=function(t,e){var i=t.currentView(),n=t.view_body.firstChild;y(t,!0),n.style.top=-e+"px",this.__visible_rows(t,i,e,!0)||this.__show_rows(t,n,i,i.__show_start,i.__show_end,!0),y(t)}}),flyingon.renderer("Tab",function(t){function e(t){var e,i,n,r,s=t.view.firstChild.firstChild.nextSibling,o=s.firstChild,a=t.length,l=flyingon.rtl?"right":"left",h=t.__storage||t.__defaults,f="left,right".indexOf(h.direction)>=0,c=h.space;if(r=h.header-h.offset,f?(e="margin-top:"+c+"px;width:"+r+"px;line-height:"+(h.size-2)+"px;",i=t.offsetHeight-t.borderTop-t.borderBottom-h.start):(e="margin-"+l+":"+c+"px;height:"+r+"px;line-height:"+(r-2)+"px;",i=t.offsetWidth-t.borderLeft-t.borderRight-h.start),h.fill){for(i-=c*(a+1)+h.end,r=e+(f?"height:":"width:");o;)n=i/a|0,o.style.cssText=r+n+"px;",o=o.nextSibling,a--,i-=n;a=0}else{for(r=(n=h.size)>0?n+"px;":"auto;",e+=f?"height:"+r+"margin-top:"+c+"px;":"width:"+r+"margin-"+l+":"+c+"px;";o;)o.style.cssText=e,o=o.nextSibling;a=n>0?(n+c)*a+c:(f?s.offsetHeight:s.offsetWidth)+c}(r=a-i)>0?(r+=h.scroll-1,t.__scroll_header>r?t.__scroll_header=n=r:n=t.__scroll_header-h.scroll+1):t.__scroll_header=n=r=0,s.style[f?"top":l]=-(h.start+n)+"px",o=s.nextSibling,o.style.display=o.nextSibling.style.display=r>0?"":"none"}function i(t){var e,i=t.view,n=t.__storage||t.__defaults,r=i.firstChild.style,s=i.lastChild.style,o=n.direction,a=n.header,l=":"+a+"px";switch(i.className=i.className.replace(/f-tab-direction-\w+/,"f-tab-direction-"+o),o){case"left":r.cssText="right:auto;width"+l,s.cssText=o+l,l="height";break;case"right":r.cssText="left:auto;width"+l,s.cssText=o+l,l="height";break;case"bottom":r.cssText="top:auto;height"+l,s.cssText=o+l,l="width";break;default:r.cssText="bottom:auto;height"+l,s.cssText=o+l,l="width"}if(a>0){if(i=i.firstChild.firstChild,i=i.nextSibling)for(i.style.cssText=e=o+":"+n.offset+"px",l=l+":"+n.scroll+"px;display:none;"+e;i=i.nextSibling;)i.style.cssText=l;r.display=""}else r.display="none"}this.__scroll_html="",this.render=function(t,e,i,n){var r,s=e.__storage||e.__defaults;e.__content_render=!0,t.push("<div"),this.renderDefault(t,e,(i||"")+"f-tab-direction-"+s.direction,n),t.push('><div class="f-tab-head f-tab-theme-',s.theme,'">','<div class="f-tab-line"></div>','<div class="f-tab-content"></div>','<div class="f-tab-move f-tab-forward" onclick="flyingon.Tab.forward.call(this)"><a class="f-tab-move-link"><span class="f-tab-move-icon"></span></a></div>','<div class="f-tab-move f-tab-back" onclick="flyingon.Tab.back.call(this)"><a class="f-tab-move-link"><span class="f-tab-move-icon"></span></a></div>',"</div>",'<div class="f-tab-body">'),(r=e.selectedPage())&&r.renderer.render(t,r,!1),t.push("</div></div>")},flyingon.Tab.forward=function(){var t=t=flyingon.findControl(this);(t.__scroll_header-=100)<0&&(t.__scroll_header=0),e(t)},flyingon.Tab.back=function(){var t=t=flyingon.findControl(this);t.__scroll_header+=100,e(t)},this.mount=function(e,i){var n=e.selectedPage();t.mount.call(this,e,i),this.__insert_head(e),n&&n.renderer.mount(n,i.lastChild.firstChild)},this.unmount=function(e,i){this.__unmount_children(e),t.unmount.call(this,e,i)},this.selected=function(t,i,n){var r,s,o=t.__storage||t.__defaults,a=o.size,l=o.space;if(n.view||(i.lastChild.appendChild(n.renderer.createView(n,!1)),n.renderer.locate(n)),r=n.view_head,a>0?s=t.indexOf(n)*(a+l):"left,right".indexOf(o.direction)>=0?(a=r.offsetWidth,s=r.offsetTop-l):(a=r.offsetHeight,s=r.offsetLeft-l),i=i.firstChild.firstChild.nextSibling,l=-i.offsetLeft,s>l){if(a=r.offsetLeft+a,s=i.parentNode.offsetWidth,a<l+s)return;s=a-s+80}else(s-=50)<0&&(s=0);t.__scroll_header!==s&&(t.__scroll_header=s,t.__update_dirty||e(t))},this.theme=function(t,e,i){e.className=e.className.replace(/f-tab-type-\w+/,"f-tab-type-"+i)},this.__insert_head=function(t){for(var e,i,n,r=t.view.firstChild.firstChild.nextSibling,s=t.length-1;s>=0;s--)if(e=t[s]){if(i=e.view_head){if(i.parentNode===r){n=i;continue}}else e.renderer.__render_header(e),i=e.view_head;n?r.insertBefore(i,n):r.appendChild(i),n=i}},this.__insert_patch=function(t,e,i){this.__insert_head(t)},this.__remove_patch=function(e,i){for(var n,r,s=e.view.firstChild.firstChild.nextSibling,o=0;n=i[o++];)n.parent!==e&&(r=n.view_head)&&r.parentNode===s&&s.removeChild(r);t.__remove_patch.apply(this,arguments)},this.locate=function(n){var r=n.selectedPage();t.locate.call(this,n),n.__reset_header&&(n.__reset_header=!1,i(n)),n.length>0&&(n.header()>0&&e(n),this.__arrange(n)),r&&(r.view||n.view.lastChild.appendChild(r.renderer.createView(r,!1)),r.renderer.locate(r)),n.__arrange_dirty=0},this.__arrange=function(t){var e=t.__storage||t.__defaults,i=e.header,n=t.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight,r=t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom;i>0&&("left,right".indexOf(e.direction)>=0?n-=i:r-=i);for(var s=t.length-1;s>=0;s--){var o=t[s];o.measure(n,r,n,r,3),o.locate(0,0)}}}),flyingon.renderer("TabPage","Panel",function(t){function e(t){for(var e=this.page,i=(t||(t=window.event)).target||t.srcElement;i&&i!==this;){switch(i.getAttribute("tag")){case"close":return void e.remove();case"button":return void this.trigger("button-click","page",e)}i=i.parentNode}e.parent.selectedPage(e,"click")}this.__render_header=function(t){var i,n=t.view_head=document.createElement("span"),r=[],s=flyingon.html_encode,o=t.__storage||t.__defaults;n.className="f-tab-item"+(t.selected()?" f-tab-selected":""),r.push('<a class="f-tab-link">','<span class="f-tab-icon ',(i=o.icon)?s(i):"f-tab-icon-none",'"></span>','<span class="f-tab-text">',(i=o.text)?s(i):"","</span>"),(i=o.buttons)&&(i=s(i).replace(/(\w+)\W*/g,'<span class="f-tab-button $1" tag="button"></span>'))&&r.push(i),r.push('<span class="f-tab-close"',o.closable?"":' style="display:none"',' tag="close"></span>',"</a>"),n.innerHTML=r.join(""),n.page=t,n.onclick=e},this.unmount=function(e,i){var n=e.view_head;e.view_head=n.control=n.onclick=null,t.unmount.call(this,e,i)},this.icon=function(t,e){t.view_head.firstChild.firstChild.className="f-tab-icon "+(e||"f-tab-icon-none")},this.text=function(t,e){t.view_head.firstChild.firstChild.nextSibling[this.__text_name]=e},this.buttons=function(t,e){for(var i=(view=t.view_head).firstChild.lastChild,n=i.previousSibling;n&&"button"===n.getAttribute("tag");)n=n.previousSibling,view.removeChild(n.nextSibling);e&&(e=flyingon.html_encode(any).replace(/(\w+)\W*/g,'<span class="f-tab-button $1" tag="button"></span>'),flyingon.dom_html(view,e,i))},this.closable=function(t,e){t.view_head.firstChild.lastChild.style.display=e?"":"none"},this.selected=function(t,e){t.view&&(t.view.style.display=e?"":"none"),t.view_head.className="f-tab-item"+(e?" f-tab-selected":"")}}),flyingon.renderer("Popup","Panel",function(t){function e(t){var e,i;if((e=r)&&(i=e.__closeAway)){var n=e.__view_rect,s=t.clientX,o=t.clientY;n?(n.left-s>i.x1||s-n.right>i.x2||n.top-o>i.y1||o-n.bottom>i.y2)&&e.close("auto"):(e.__view_rect=n=e.view.getBoundingClientRect(),e.__closeAway={x1:(i=n.left-s)>0?i+4:4,x2:(i=s-n.right)>0?i+4:4,y1:(i=n.top-o)>0?i+4:4,y2:(i=o-n.bottom)>0?i+4:4})}}function i(t){var e=r;if(e&&e.view===this){var i=this.getBoundingClientRect(),n=t.clientX,s=t.clientY;(n>=i.right||s>=i.bottom||n<=i.left||s<=i.top)&&e.close("auto")}}var n=[],r=null,s=flyingon.dom_on,o=flyingon.dom_off;s(document,"mousedown",function(t){var e;if(e=r){for(var i=e.view,n=e.__view_reference,s=t.target;s;){if(s===i||s===n)return;s=s.parentNode}e.trigger("autoclosing","dom",t.target)!==!1&&e.close("auto")}}),s(document,"keydown",function(t){var e;(e=r)&&27===t.which&&e.close("cancel")}),this.show=function(t,e,i,n,r,s){var o=(t.__view_reference=e.view||e).getBoundingClientRect();i&&(o={top:o.top-(0|i[0]),right:o.right+(0|i[1]),bottom:o.bottom+(0|i[2]),left:o.left-(0|i[3])}),this.showAt(t,0,0),o=flyingon.dom_align(t.view,o,n,r,s),t.offsetLeft=o.left,t.offsetTop=o.top},this.showAt=function(t,o,a){var l=t.view||this.createView(t,!1);document.body.appendChild(l),t.trigger("showing"),t.measure(document.body.clientWidth,0),t.locate(0|o,0|a),flyingon.__update_patch(),this.update(t),n.push(r=t),(t.__closeAway=t.closeAway())&&!e.count++&&(e.count=1,s(document,"mousemove",e)),(t.__closeLeave=t.closeLeave())&&s(l,"mouseout",i),t.trigger("shown")},this.close=function(t){var s,a=t.view;t.__view_reference=null,t.__closeAway&&(t.__closeAway=t.__view_rect=null,--e.count||o(document,"mousemove",e)),t.__closeLeave&&o(a,"mouseout",i),n.pop(),r=n[n.length-1],(s=a.parentNode)&&s.removeChild(a)}}),flyingon.renderer("Dialog","Panel",function(t){this.render=function(t,e,i,n){var r,s=e.__storage||e.__defaults,o=s.header,a=s.text;t.push("<div"),this.renderDefault(t,e,i,n),a&&(a=flyingon.html_encode(a)),(r=e.format)&&(a=r.call(e,a)),t.push(">",'<div class="f-dialog-head" style="height:',o,"px;line-height:",o,'px;" onmousedown="flyingon.Dialog.onmousedown.call(this, event)" onclick="flyingon.Dialog.onclick.call(this, event)">','<span class="f-dialog-icon ',(r=s.icon)?r:'" style="display:none;','"></span>','<span class="f-dialog-text">',a,"</span>",'<span class="f-dialog-close"',s.closable?"":' style="display:none;"',' tag="close"></span>','<span class="f-dialog-line"></span>',"</div>",'<div class="f-dialog-body" style="top:',o,'px;">'),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,e,0,e.length)),t.push(this.__scroll_html,"</div></div>")},flyingon.Dialog.onclick=function(t){var e=flyingon.findControl(this),i=t.target||t.srcElement;"close"===i.getAttribute("tag")?e.close():e.active()},flyingon.Dialog.onmousedown=function(t){var e=flyingon.findControl(this);e.movable()&&(e.active(),e.renderer.movable(e,t))},this.mount=function(e,i){e.view_content=i.lastChild,t.mount.call(this,e,i)},this.active=function(t,e){var i=t.view,n=" f-dialog-active";e?i.className.indexOf(n)<0&&(i.className+=n):i.className=i.className.replace(n,"")},this.header=function(t,e,i){e.firstChild.style.height=e.lastChild.style.top=i+"px"},this.text=function(t,e,i){e=e.firstChild.firstChild.nextSibling,t.format?(i&&(i=flyingon.html_encode(i)),e.innerHTML=t.format(i)):e[this.__text_name]=i},this.icon=function(t,e,i){e=e.firstChild.firstChild,e.className="f-groupbox-icon"+(i?" "+i:""),e.style.display=i?"":"none"},this.closable=function(t,e,i){e.firstChild.lastChild.style.display=i?"":"none"},this.show=function(t,e){var i=document.body,n=t.view||this.createView(t,!1),r=i.clientWidth;i.appendChild(n),t.trigger("showing"),t.measure(r,0),this.center(t),e&&flyingon.dom_overlay(n),flyingon.__update_patch(),this.update(t),t.trigger("shown")},this.center=function(t){var e=document.body,i=t.view.style;i.left=(t.offsetLeft=e.clientWidth-t.offsetWidth>>1)+"px",i.top=(t.offsetTop=((window.innerHeight||document.documentElement.clientHeight)-t.offsetHeight>>1)-e.clientLeft)+"px"},this.movable=function(t,e){e.dom=t.view,flyingon.dom_drag(t,e),e.dom=null},this.close=function(t){var e,i=t.view;(e=i.parentNode)&&e.removeChild(i),i.flyingon_overlay&&flyingon.dom_overlay(i,!1)}}),flyingon.showMessage=function(t,e,i,n,r){var s,o;arguments.length<4&&(r=n,n=i,i=""),n=n?""+n:"ok",o=n.match(/\w+/g),n=[];for(var a=0,l=o.length;a<l;a++)n.push({Class:"Button",height:25,style:"min-width:80px;margin-top:8px;",tag:o[a],text:flyingon.i18ntext("system."+o[a],o[a])});return s=flyingon.ui({layout:"vertical-line",width:300,height:"auto",padding:0,text:t,children:[{Class:"Panel",layout:"dock",height:"auto",padding:8,minHeight:60,style:"overflow:hidden;",children:[{Class:"Label",dock:"left",width:50,height:50,visible:i,className:"f-message-icon"+(i?" f-message-"+i:"")},{Class:"Label",dock:"fill",height:"auto",text:e}]},{Class:"div",height:40,className:"f-message-foot",style:"overflow:hidden;",children:n}]},flyingon.Dialog).showDialog(),o=s.offsetHeight/200,o>1&&(o=300*o,s.width(o>800?800:o),s.showDialog()),s.view.lastChild.firstChild.nextSibling.children[0|r].focus(),s.on("click",function(t){var e=t.target.tag();e&&this.close(e)}),s},Object.extend("Control",function(){function t(t,n){var r,s,o,a,l=this.__watches,h=this.rendered,f=0,c=n.length;for(t=t||(this.__style={});f<c;){for(;":"===(r=n[f++]););r&&(":"===n[f++]?s=n[f++]||"":(f--,s=""),(a=t&&t[r]||"")!==s&&(t[r]=s,l&&l["style:"+r]&&this.notify("style:"+r,s,a),h?(o||(o=this.__style_patch||e(this)))[r]=s:o=!0))}o&&(l&&l.style?(a=t.cssText||"",this.notify("style",i(t),a)):t.cssText=!1)}function e(t){var e=t.__view_patch,i=t.__style_patch={};return e?e.__style_patch=i:t.renderer.set(t,"__style_patch",i),i}function i(t){var e,i=[];for(var n in t)"cssText"!==n&&""!==(e=t[n])&&i.push(n,":",e,";");return t.cssText=i.join("")}function n(t,e,i){var n,r,s,o=[];for(var a in e)"cssText"!==a&&""!==(r=e[a])&&(i&&(s=i[n="style:"+a])&&(s=s[0])?t.writeProperty(n,"{{"+s+"}}"):o.push(a,":",r,";"));o[0]&&t.writeProperty("style",o.join(""))}var r=(flyingon.create,flyingon.pixel),s=flyingon.pixel_sides;this.defaultWidth=100,this.defaultHeight=25,this.offsetLeft=this.offsetTop=this.offsetWidth=this.offsetHeight=0,this.marginLeft=this.marginTop=this.marginRight=this.marginBottom=0,this.borderLeft=this.borderTop=this.borderRight=this.borderBottom=0,this.paddingLeft=this.paddingTop=this.paddingRight=this.paddingBottom=0,this.scrollLeft=this.scrollTop=0,flyingon.fragment("f-visual",this),flyingon.fragment("f-bindable",this),this["#focused"]=function(t){t?this.focus():this.blur()},this.__visible=!0,this.defineProperty("visible",!0,{group:"layout",set:function(t){var e;this.__visible=t,this.rendered&&((e=this.__view_patch)?e.visible=t:this.renderer.set(this,"visible",t)),this.__update_dirty||this.invalidate()}}),this.__location_dirty=0;var o=function(t,e,i,n){return t.defineProperty(e,i,{group:"layout",set:function(){this.__location_dirty|=n,this.__update_dirty||this.invalidate()}})};o(this,"left","",512),o(this,"top","",1024),o(this,"width","default",1),o(this,"height","default",2),this["min-width"]=o(this,"minWidth","",32),this["max-width"]=o(this,"maxWidth","",64),this["min-height"]=o(this,"minHeight","",128),this["max-height"]=o(this,"maxHeight","",256),o(this,"margin","",4),o(this,"border","",8),o(this,"padding","",16),o=function(t,e,i,n){return t.defineProperty(e,i,{group:"layout",set:function(){this.__as_html||this.__update_dirty||this.invalidate()}})},this["align-x"]=o(this,"alignX","left"),this["align-y"]=o(this,"alignY","top"),o(this,"dock","left"),this.defineProperty("style","",{group:"appearance",fn:function(e,n){var r,s=this.__style;return void 0===e?s&&(r=s.cssText)===!1?s.cssText=i(s):r||"":(e=""+e,void 0!==n?(this["style:"](e,n),this):e.length<36&&e.indexOf(":")<0?s&&s[e]||"":((n=e.match(/\:|[^\s:;]+(\s+[^\s:;]+)?/g))&&t.call(this,s,n),this))}}),this["style:"]=function(t,n){var r,s,o=this.__style;t&&(s=o&&o[t]||"")!==n&&((o||(o=this.__style={}))[t]=n,(r=this.__watches)?(r["style:"+t]&&this.notify("style:"+t,n,s),r.style&&(s=o.cssText||"",this.notify("style",i(o),s))):o.cssText=!1,this.rendered&&((this.__style_patch||e(this))[t]=n))},o=function(t,e,i,n){n=n||{},n.set=function(t){var i;(i=this.__view_patch)?i[e]=t:this.renderer.set(this,e,t)},t.defineProperty(e,i,n)},o(this,"tabindex",0),o(this,"disabled",!1),o(this,"readonly",!1),o(this,"title",""),o(this,"accesskey",""),this.defineProperty("resizable","none"),this.defineProperty("movable",!1),this.defineProperty("droppable",!1),this.defineProperty("key",""),this.defineProperty("tag",null),this.locationValue=function(t){return(this.__location_values||this.__storage||this.__defaults)[t]},this.measure=function(t,e,i,n,o){var a,l=this.__storage||this.__defaults,h=this.__location_values||l,f=h.minWidth,c=h.maxWidth,u=h.minHeight,d=h.maxHeight,_=h.width,g=h.height,p=0,v=s,y=v.cache;switch(a=y[a=h.margin]||v(a,t),this.marginLeft=a.left,this.marginTop=a.top,this.marginRight=a.right,this.marginBottom=a.bottom,a=y[a=l.border]||v(a,0),this.borderLeft=a.left,this.borderTop=a.top,this.borderRight=a.right,this.borderBottom=a.bottom,a=y[a=l.padding]||v(a,t),this.paddingLeft=a.left,this.paddingTop=a.top,this.paddingRight=a.right,this.paddingBottom=a.bottom,v=r,y=v.cache,f=f>0?0|f:y[f]||v(f,t),c=c>0?0|c:y[c]||v(c,t),u=u>0?0|u:y[u]||v(u,e),d=d>0?0|d:y[d]||v(d,e),_){case"default":1&o?(a=i>=0?i:t,_=a-this.marginLeft-this.marginRight):_=this.defaultWidth;break;case"auto":p=1,_=i||this.defaultWidth;break;default:_=(a=+_)===a?0|a:y[_]||v(_,t)}switch(a<0&&(_=0),g){case"default":2&o?(a=n>=0?n:e,g=a-this.marginTop-this.marginBottom):g=this.defaultHeight;break;case"auto":p|=2,g=n||this.defaultHeight;break;default:g=(a=+g)===a?0|a:y[g]||v(g,e)}g<0&&(g=0),this.__auto_size=p,_<f?_=f:c>0&&_>c&&(_=c),g<u?g=u:d>0&&g>d&&(g=d),this.offsetWidth=_,this.offsetHeight=g,(v=this.onmeasure)&&v.call(this,p)!==!1&&(this.offsetWidth!==_&&((_=this.offsetWidth)<f?this.offsetWidth=_=f:c>0&&_>c&&(this.offsetWidth=_=c)),this.offsetHeight!==g&&((g=this.offsetHeight)<u?this.offsetHeight=g=u:d>0&&g>d&&(this.offsetHeight=g=d)))},this.locate=function(t,e,i,n,r){var s,o=this.offsetWidth,a=this.offsetHeight;if(i>0&&(s=i-o))switch((this.__location_values||this.__storage||this.__defaults).alignX){case"center":t+=s>>1;break;case"right":t+=s;break;default:t+=this.marginLeft}else t+=this.marginLeft;if(n>0&&(s=n-a))switch((this.__location_values||this.__storage||this.__defaults).alignY){case"middle":e+=s>>1;break;case"bottom":e+=s;break;default:e+=this.marginTop}else e+=this.marginTop;this.offsetLeft=t,this.offsetTop=e,(s=this.onlocate)&&s.call(this)!==!1&&(t=this.offsetLeft,e=this.offsetTop),r&&(r.arrangeX=t+=o+this.marginRight,r.arrangeY=e+=a+this.marginBottom,t>r.arrangeRight&&(r.arrangeRight=t),e>r.arrangeBottom&&(r.arrangeBottom=e))},this.canFocus=function(){return!!this.tabindex},this.focus=function(){this.rendered&&this.renderer.focus(this)},this.blur=function(){this.rendered&&this.renderer.blur(this)},this.__update_dirty=!0,this.invalidate=function(){var t=this.parent;return this.__update_dirty=!0,t?t.__arrange_delay(2):this.__top_control&&flyingon.__update_delay(this),this},this.__arrange_dirty=0,this.__arrange_delay=function(t){if(this.__arrange_dirty<t){var e=this.parent;this.__arrange_dirty=t,e?e.__arrange_delay(1):this.__top_control&&flyingon.__update_delay(this)}},this.__do_scroll=function(t,e){},flyingon.fragment("f-serialize",this),this.serialize=function(t){var e;(e=this.Class)&&(e=e.nickName||e.fullName)&&t.writeProperty("Class",e),(e=this.__storage)&&t.writeProperties(e,this.getOwnPropertyNames(),this.__watches),(e=this.__style)&&n(t,e,this.__watches)},this.autoDispose=!0,this.dispose=function(){var t;this.__storage;return(t=this.distroyed)&&t.call(this),this.view&&this.renderer.dispose(this),(t=this.__dataset)&&(t.subscribe(this,!0),this.__dataset=null),this.__events&&this.off(),this.parent=this.__loop_vm=this.__list=null,this}}).register(),flyingon.Control.extend("HtmlElement",function(t){this.tagName="div",this.defineProperty("text","",{set:function(t){this.length>0&&this.splice(0),this.rendered&&this.renderer.set(this,"text",t)}}),this.defineProperty("html",!1),this.defineProperty("arrange",!0),flyingon.fragment("f-container",this,!0),this.onmeasure=function(t){var e=(this.offsetHeight<<16)+this.offsetWidth;return this.__size_tag!==e&&(this.__size_tag=e,this.__arrange_dirty=2),!!t&&void this.renderer.__measure_auto(this,t)},this.serialize=function(e){return t.serialize.call(this,e),this.length>0&&e.writeProperty("children",this,!0),this},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}),flyingon.Control.extend("Label",function(t){function e(t,e,i){t.defineProperty(e,i,{set:function(){this.rendered&&this.renderer.set(this,"text")}})}this.defaultWidth=60,e(this,"text",""),e(this,"html",!1),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("Button",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,e,t)}})};e(this,"icon",""),this["icon-size"]=e(this,"iconSize",16),e(this,"vertical",!1),e(this,"text",""),e(this,"html",!1),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("LinkButton",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,e,t)}})};e(this,"text",""),e(this,"html",!1),e(this,"href",""),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("Image",function(t){this.defaultWidth=400,this.defaultHeight=300,this.defineProperty("src","",{set:function(t){this.rendered&&this.renderer.set(this,"src",t)}}),this.defineProperty("alt","",{set:function(t){this.rendered&&this.renderer.set(this,"alt",t)}})}).register(),flyingon.Control.extend("Slider",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{dataType:"int",check:function(t){return t<0?0:t},set:function(){this.rendered&&!this.__location_dirty&&this.renderer.set(this,"refresh")}})};e(this,"value",0),e(this,"min",0),e(this,"max",100),e(this,"buttonSize",8)}).register(),flyingon.Control.extend("ProgressBar",function(t){this.defaultHeight=20,this.defaultValue("border",1),this.defineProperty("value",0,{dataType:"int",check:function(t){return t<0?0:t>100?100:t},set:function(t){this.rendered&&this.renderer.set(this,"value",t)}}),this.defineProperty("text",!0,{set:function(t){this.rendered&&this.renderer.set(this,"text",t)}})}).register(),flyingon.fragment("f-container",function(t,e){function i(t,e){for(var i,n,r=0,s=t.length;r<s;r++)(i=t[r])&&(e.push(i),(n=i.all)&&e.push.apply(e,n.call(i)));return e}t===!0&&(t=null,e=!0),this.childrenClass=t||flyingon.Control,this.__arrange_dirty=e?2:0,flyingon.fragment("f-collection",this),this.__check_error=function(t){throw'"'+this.Class.fullName+'" type can push "'+t.fullName+'" type only!'},this.detach=function(t,e){var i,n=this.splice.apply(this,arguments),e=n.length;if(e>0)for(var r=0;r<e;r++)(i=n[r])&&(i.parent=null,i.autoDispose=!1);return n},this.__check_items=function(t,i,n){for(var r,s,o=this.childrenClass,a=this instanceof flyingon.HtmlElement,l=this.__content_render&&[];r=i[n];)r.__flyingon_class?r instanceof o?(s=r.parent)&&s!==this&&s.__remove_items(s.indexOf(r),[r]):this.__check_error(o):(r=this.__create_child(r,o))instanceof o?i[n]=r:this.__check_error(o),r.parent=this,r.__as_html=a,l&&l.push(r),n++;this.__all&&this.__clear_all(),l&&l[0]&&this.__children_dirty(1,t,l),e&&this.__arrange_dirty<2&&this.__arrange_delay(2)},this.__create_child=flyingon.ui,this.__remove_items=function(t,i){var n,r=[];this.__all&&this.__clear_all();for(var s=i.length-1;s>=0;s--)(n=i[s])&&(n.parent=null,n.autoDispose=!0,r.push(n));r[0]&&this.__children_dirty(2,-1,r),e&&this.__arrange_dirty<2&&this.__arrange_delay(2)},this.__children_dirty=function(t,e,i){var n=this.__children_patch;if(n){var r=n.length-3;t===n[r++]&&n[r++]===e?(r=n[r+1],r.apply(r,i)):n.push(t,e,i)}else this.__children_patch=[t,e,i],this.renderer.__children_dirty(this)},this.__clear_all=function(){var t=this.parent;for(this.__all=null;t&&t.__all;)t.__all=null,t=t.parent},this.find=function(t){return new flyingon.Query(t,[this])},this.findById=function(t,e){var i,n=new flyingon.Query;return t&&(i=flyingon.__find_id(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.findByType=function(t,e){var i,n=new flyingon.Query;return t&&(i=flyingon.__find_type(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.findByClass=function(t,e){var i,n=new flyingon.Query;return t&&(i=flyingon.__find_class(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.all=function(){return this.__all||(this.__all=i(this,[]))},this.findDropTarget=function(t,e){var i=this.findAt(t,e);return i?[this,i]:[this,null]},this.findAt=function(t,e){return this},this.deserialize_children=function(t,e){if("function"==typeof e){var i=[];e(i),e=i}this.push.apply(this,t.readArray(e,this.childrenClass))},this.subscribeBind=function(t,e){var i;this.base.subscribeBind.call(this,t,e);for(var n=0,r=this.length;n<r;n++)(i=this[n])&&!i.__dataset&&i.subscribeBind(t,e);return this}}),flyingon.Control.extend("Panel",function(t){this.defaultWidth=300,this.defaultHeight=150,this.arrangeLeft=this.arrangeTop=this.arrangeRight=this.arrangeBottom=this.arrangeWidth=this.arrangeHeight=0,this.defaultValue("droppable",!0),this.defineProperty("layout",null,{group:"locate",query:!0,set:function(t){this.__layout=null,this.__arrent_dirty<2&&this.__arrange_delay()}}),this.defineProperty("adaption",!1),flyingon.fragment("f-container",this,!0),this.onmeasure=function(t){var e=(this.offsetHeight<<16)+this.offsetWidth;return this.__size_tag!==e&&(this.__size_tag=e,this.__arrange_dirty=2),!!t&&(this.renderer.locate(this),this.__update_dirty=!1,1&t&&(this.offsetWidth=this.arrangeRight+this.borderLeft+this.borderRight),2&t&&(this.offsetHeight=this.arrangeBottom+this.borderTop+this.borderBottom),void 0)},this.findAt=function(t,e){if(this.length<=0)return this;var i,n=flyingon.getLayout(this);return t+=this.scrollLeft-this.borderLeft,e+=this.scrollTop-this.borderTop,(i=n.__sublayouts)?(i=n.controlAt(i,t,e))?i.controlAt(t,e):null:n.controlAt(this,t,e)},this.serialize=function(e){return t.serialize.call(this,e),this.length>0&&e.writeProperty("children",this,!0),this},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}).register(),flyingon.Panel.extend("GroupBox",function(t){function e(t,e,i){t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,e,t)}})}this.defaultValue("border",1),this.defineProperty("header",25,{set:function(t){this.rendered&&this.renderer.set(this,"header",t),this.__update_dirty||this.invalidate()}}),e(this,"align","left"),e(this,"icon",""),e(this,"text",""),e(this,"collapsable",0),this.defineProperty("collapsed",!1,{set:function(t){this.rendered&&this.renderer.set(this,"collapsed",t),!t&&(t=this.mutex())&&this.__do_mutex(t),this.__update_dirty||this.invalidate()}}),this.defineProperty("mutex",""),this.__do_mutex=function(t){var e,i=this.parent;if(i)for(var n=0,r=i.length;n<r;n++)(e=i[n])&&e!==this&&e.__do_mutex&&e.mutex()===t&&e.collapsed(!0)},this.onmeasure=function(e){return this.collapsed()?(this.offsetHeight=this.header(),!1):!!e&&(t.onmeasure.call(this,e),void(this.offsetHeight+=this.header()))},this.arrangeArea=function(){var t=this.header();this.arrangeHeight-=t,this.arrangeBottom-=t}}).register(),flyingon.Panel.extend("ScrollPanel",function(t){this.defineProperty("prerender","none"),this.__visible_start=this.__visible_end=-1,this.__visible_unmount=!0,this.__compute_visible=function(){var t,e,i=-1,n=-1,r=this.scrollLeft,s=this.scrollTop,o=this.offsetWidth,a=this.offsetHeight,l=!0;e=this.prerender(),o+=r+(e.indexOf("x")>=0?o:0),a+=s+(e.indexOf("y")>=0?a:0);for(var h=0,f=this.length;h<f;h++)(t=this[h])&&(t.__visible_area=(e=t.offsetLeft)<o&&e+t.offsetWidth>r&&(e=t.offsetTop)<a&&e+t.offsetHeight>s)&&(l&&!t.view&&(l=!1),i<0&&(i=h),n=h);this.__visible_start=i,this.__visible_end=n,this.__visible_unmount=!l},this.__do_scroll=function(t,e){this.scrollLeft=t,this.scrollTop=e,this.__compute_visible(),this.renderer.scroll(this,t,e)}}).register(),flyingon.Control.extend("Splitter",function(t){this.defaultWidth=this.defaultHeight=4,this.vertical=!1}).register(),flyingon.Panel.extend("Plugin",function(t){this.loadPlugin=function(t){},this.openPlugin=function(t){},this.closePlugin=function(){},this.__class_init=function(e){var i=flyingon.__load_plugin;t.__class_init.apply(this,arguments),i&&e!==flyingon.Plugin&&i(e)}}).register(),flyingon.plugin=function(t,e){return e||(e=t,t=flyingon.Plugin),t.extend(e).init()},flyingon.Control.extend("ListBox",function(t){function e(t,e,i,n){return t.defineProperty(e,i,{set:function(){this.__template=null,this.__list&&this.renderer.set(this,"content")}})}function i(t){this.__list=t,this.rendered&&this.renderer.set(this,"content")}this.defaultWidth=200,this.defaultHeight=100,this.defaultValue("border",1),e(this,"checked","none"),e(this,"columns",1),e(this,"clear",!1),e(this,"template",null),this["item-height"]=e(this,"itemHeight",21),this.defineProperty("items",null,{set:function(t){flyingon.DataList.create(t,i,this)}}),this.defineProperty("value","",{set:function(t){this.rendered&&this.renderer.set(this,"change")}}),this.defineProperty("separator",",")}).register(),flyingon.Control.extend("RadioButton",function(t){this.defineProperty("name",!1,{set:function(t){this.rendered&&this.renderer.set(this,"name",t)}}),this.value=this.defineProperty("checked",!1,{set:function(t){this.rendered&&this.renderer.set(this,"checked",t)}})}).register(),flyingon.Control.extend("CheckBox",function(t){this.defineProperty("name",!1,{set:function(t){this.rendered&&this.renderer.set(this,"name",t)}}),this.value=this.defineProperty("checked",!1,{set:function(t){this.rendered&&this.renderer.set(this,"checked",t)}})}).register(),flyingon.fragment("f-textbox",function(){this.defineProperty("placehodler",""),this.selectionStart=function(t){return this.renderer.selectionStart(t)},this.selectionEnd=function(t){return this.renderer.selectionEnd(t)},this.select=function(){return this.renderer.select()}}),flyingon.Control.extend("TextBox",function(t){this.defineProperty("value","",{set:function(t){this.rendered&&this.renderer.set(this,"text",t)}}),this.text=function(){return(this.__storage||this.__defaults).value},flyingon.fragment("f-textbox",this),this["max-length"]=this.defineProperty("maxLength",0)}).register(),flyingon.TextBox.extend("NumberPicker",function(t){this.__scale=this.__value=0,this.defineProperty("value",0,{set:function(t){this.__value=t,this.rendered&&this.renderer.set(this,"text",t)}}),this.defineProperty("scale",0,{check:function(t){return this.__scale=(t|=0)>0?t:0}}),this.text=function(){return this.__value.toFixed(this.__scale)}}).register(),flyingon.Control.extend("TextButton",function(t){function e(t,e,i,n){return t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,n||e,t)}})}var i;e(this,"value",null,"text"),e(this,"format","","text"),e(this,"inputable",!1),this.text=function(){var t=this.__storage||this.__defaults,e=t.format;return e?e.replace(/\{\{value\}\}/g,value):""+t.value},e(this,"button",""),this["button-size"]=e(this,"buttonSize",16),flyingon.fragment("f-textbox",this),this.__on_click=function(){this.trigger("button-click")},this.__get_popup=function(){var t=i;return t?t.close("auto"):(t=i=new flyingon.Popup,t.autoDispose=!1,t.on("closed",function(){this.detach(0)}),t.width("auto").height("auto")),t}}).register(),flyingon.fragment("f-ComboBox",function(){this.defineProperty("checked","none"),this.defineProperty("columns",1),this.defineProperty("clear",!1),this.defineProperty("template",null),this["item-height"]=this.defineProperty("itemHeight",21),this["popup-width"]=this.defineProperty("popupWidth","default"),this["max-items"]=this.defineProperty("maxItems",10),this.defineProperty("items",null,{set:function(t){flyingon.DataList.create(t,this.__set_items,this)}}),this.__set_items=function(t){this.__list=t,this.rendered&&this.renderer.set(this,"text")},this.defineProperty("separator",",")}),flyingon.TextButton.extend("ComboBox",function(t){var e;this.defaultValue("button","f-combobox-button"),flyingon.fragment("f-ComboBox",this),this.defineProperty("value","",{set:function(){this.__list&&this.renderer.set(this,"text")}}),this.text=function(){var t=this.__list;if(t){var e=this.__storage||this.__defaults;return t.text(e.value,"checkbox"===e.checked?e.separator||",":"")}return""},this.popup=this.__on_click=function(){var t,e,i,n=this.__get_popup(),r=this.__storage||this.__defaults,s=this.__get_listbox();this.__before_popup(n,s,r),s.border(0).checked(s.__checked=r.checked).columns(i=r.columns).clear(r.clear).template(r.template).itemHeight(e=r.itemHeight).width(r.popupWidth).separator(r.separator).items(r.items).value(r.value),i>0&&(t=this.__list?this.__list.length:0,r.clear&&t++,t=Math.min(t,r.maxItems),i>1&&(t=(t+i-1)/i|0),e*=t),s.height(e+2),s.target=this,s.popup=n,n.push(s),n.show(this)},this.__before_popup=function(t,e,i){},this.__get_listbox=function(){return e=(new flyingon.ListBox).on("change",function(t){this.target.value(t.value),"checkbox"!==this.__checked&&this.popup.close()})}}).register(),flyingon.Control.extend("Calendar",function(t){function e(t,e,i,n){t.defineProperty(e,i,{dataType:n,set:function(){this.rendered&&!this.__location_dirty&&this.renderer.set(this,"refresh")}})}this.defaultWidth=this.defaultHeight=240,this.defaultValue("border",1),this.defaultValue("padding",8),e(this,"value",null,"date"),e(this,"min",""),e(this,"max",""),e(this,"month",!1),e(this,"time",!1),e(this,"today",!1),e(this,"clear",!1)}).register(),flyingon.fragment("f-DatePicker",function(){this.defineProperty("format","yyyy/M/dd",{set:function(){this.rendered&&this.renderer.set(this,"text")}}),this.defineProperty("min",""),this.defineProperty("max",""),this.defineProperty("time",!1),this.defineProperty("today",!1),this.defineProperty("clear",!1)}),flyingon.TextButton.extend("DatePicker",function(t){var e;this.defaultValue("button","f-datepicker-button"),this.defineProperty("value",null,{dataType:"date",set:function(){this.rendered&&this.renderer.set(this,"text")}}),flyingon.fragment("f-DatePicker",this),this.text=function(){var t=this.__storage||this.__defaults,e=t.value;return e?e.format(t.format):""},this.popup=this.__on_click=function(){var t=this.__get_popup(),i=this.__storage||this.__defaults,n=e;n||(n=e=new flyingon.Calendar,n.border(0).on("selected",function(t){this.target.value(t.value),this.popup.close()})),n.value(i.value).min(i.min).max(i.max).time(i.time).today(i.today).clear(i.clear),n.oncheck=this.oncheck,n.target=this,n.popup=t,t.push(n),t.show(this)}}).register(),flyingon.TextBox.extend("TimePicker",function(t){this.defineProperty("value","",{check:function(t){return t&&(t=t.match(/\d+/g))?(t.length=3,t[1]|=0,t[2]|=0,t.join(":")):""},set:function(){this.rendered&&this.renderer.set(this,"text")}}),this.defineProperty("format","",{set:function(){this.rendered&&this.renderer.set(this,"text")}}),this.text=function(){var t,e=this.__storage||this.__defaults,i=e.value;return i&&(t=e.format)?(i=i.split(":"),new Date(2e3,1,1,0|i[0],0|i[1],0|i[2]).format(t)):i}}).register(),flyingon.TextButton.extend("MonthPicker",function(t){var e;this.defaultValue("button","f-datepicker-button"),this.defineProperty("value",null,{dataType:"date",set:function(){this.rendered&&this.renderer.set(this,"text")}}),this.defineProperty("format","yyyy-MM",{set:function(){this.rendered&&this.renderer.set(this,"text")}}),this.defineProperty("min",""),this.defineProperty("max",""),this.text=function(){var t=this.__storage||this.__defaults,e=t.value;return e?e.format(t.format):""},this.popup=this.__on_click=function(){var t=this.__get_popup(),i=this.__storage||this.__defaults,n=e;n||(n=e=new flyingon.Calendar,n.border(0).month(!0).on("selected",function(t){this.target.value(t.value),this.popup.close()})),n.value(i.value).min(i.min).max(i.max),n.oncheck=this.oncheck,n.target=this,n.popup=t,t.push(n),t.show(this)}}).register(),Object.extend("TreeNode",function(){function t(t,e,i){return t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,e,t)}})}flyingon.fragment("f-visual",this),this.isTreeNode=!0,this.expanded=!1,this.checkedChildren=0,t(this,"icon",""),t(this,"text",""),t(this,"disabled",!1),this.defineProperty("checked",!1,{set:function(t){for(var e=this.parent;e&&e.isTreeNode;)(t?e.checkedChildren++:--e.checkedChildren)||!e.view||e.checked()||e.renderer.set(e,"checked",!1),e=e.parent;this.rendered&&this.renderer.set(this,"checked",t),this.trigger("checked-change","value",t)}}),this.defineProperty("delay",!1),flyingon.fragment("f-container",this,flyingon.TreeNode),this.__create_child=function(t,e){var i=new e,n=i.__storage||(i.__storage=flyingon.create(i.__defaults));for(var r in t)switch(r){case"text":case"icon":n[r]=""+t[r];break;case"checked":n[r]=!!t[r];break;case"expanded":t[r]&&(i.expanded=!0);break;case"children":case"items":i.push.apply(i,t[r]);break;default:n[r]=t[r]}return i},this.level=function(){for(var t=this.parent,e=0;t&&t.isTreeNode;)e++,t=t.parent;return e}}).register(),flyingon.Control.extend("Tree",function(t){function e(t,e,i){return t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer.set(this,e,t)}})}function i(t,e){for(var n=0,r=t.length;n<r;n++){var s=t[n];if(e(s))return s;if(s.length>0&&(s=i(s,e)))return s}}this.defaultWidth=200,this.defaultHeight=300,this.defaultValue("border",1),this.defaultValue("padding",2),e(this,"theme","default"),e(this,"checked",!1),e(this,"icon",!0),this.defineProperty("editable",!1),this.format=null,flyingon.fragment("f-container",this,flyingon.TreeNode.init()),this.__create_child=flyingon.TreeNode.prototype.__create_child,this.expand=function(t){if(t)this.__expand_node(t);else for(var e=0,i=this.length;e<i;e++)this.__expand_node(this[e]);return this},this.__expand_node=function(t){t.expanded||this.trigger("expand","node",t)===!1||(t.expanded=!0,t.rendered&&t.renderer.set(t,"expand"))},this.expandTo=function(t,e){return arguments.length<2&&(e=t,t=null),this.__expand_to(t||this,0|e),this},this.__expand_to=function(t,e){e--;for(var i=t.length-1;i>=0;i--){var n=t[i];if(!n.expanded){if(this.trigger("expand","node",n)===!1)continue;n.expanded=!0,n.rendered&&n.renderer.set(n,"expand")}if(n.length>0)if(e)this.__expand_to(n,e);else for(var r=n.length-1;r>=0;r--){var s=n[r];s.expanded&&this.trigger("collapse","node",n)!==!1&&(s.expanded=!1,s.rendered&&s.renderer.set(s,"collapse"))}}},this.collapse=function(t){if(t)this.__collapse_node(t);else for(var e=0,i=this.length;e<i;e++)this.__collapse_node(this[e]);return this},this.__collapse_node=function(t){t.expanded&&t.length>0&&this.trigger("collapse","node",t)!==!1&&(t.expanded=!1,t.rendered&&t.renderer.set(t,"collapse"))},this.beginEdit=function(){},this.endEdit=function(){},this.findNode=function(t){if("function"==typeof t)return i(this,t)},this.current=function(t){var e=this.__current;e&&(e.__current=!1),(this.__current=t)&&(t.__current=!0),this.rendered&&(e&&e.renderer.current(e,!1),t&&t.renderer.current(t,!0))},this.scrollTo=function(t){this.rendered&&this.renderer.scrollTo(this,t)},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}).register(),(flyingon.GridColumn=Object.extend(function(){var t=flyingon.Label,e=flyingon.create;this.init=function(t){if(this.__cells=[],t){var e=this.__properties;for(var i in t)e[i]&&this[i](t[i])}},this.type="",this.defineProperty("name","",{set:function(t){var e=this.grid;this.__name=t,e&&e.rendered&&(e.__columns.__keys=null,e.update())}}),this.defineProperty("title",null,{set:function(t){var e;if(this.view){if(this.view=!1,e=this.__cells){for(var i=e.length-1;i>=0;i--)e[i].view=null,e[i].dispose();e=e.__span}this.__set_title(t),this.grid&&this.grid.update(e||this.__cells.__span>0)}else this.__set_title(t)}}),this.defineProperty("size","100",{set:function(t){var e;this.view&&(e=this.grid)&&e.update(!0)}}),this.fullClassName=this.defaultClassName="",this.defineProperty("className","",{set:function(t){t&&this.defaultClassName&&(t+=" "+this.defaultClassName),this.fullClassName=t?" "+t:""}}),this.defineProperty("align","",{set:function(t){this.__align=t}}),this.defineProperty("readonly",!1,{set:function(t){this.__readonly=t,this.view&&this.renderer.set(this,name,t)}}),this.__visible=!0,this.defineProperty("visible",!0,{set:function(t){var e=this.grid;this.__visible=t,e&&e.rendered&&e.update(!0)}}),this.defineProperty("resizable",!0),this.defineProperty("sortable",!0),this.defineProperty("draggable",!0),this.defineProperty("filter","auto"),this.defineProperty("summary","",{set:function(){var t=this.grid;t&&t.rendered&&(t.__summary_list=this.__summary_fn=null,t.update())}}),this.defineProperty("precision",0),this.__set_title=function(e){var i=this.__cells;if(i.length=0,this.__span=!1,e instanceof Array)for(var n=0,r=e.length;n<r;n++)this.__create_header(t,i,e[n]);else this.__create_header(t,i,e);return i},this.__create_header=function(t,i,n){var r,s,o;n&&"object"==typeof n&&(s=0|n.size,o=0|n.span,(r=n.control)?r=flyingon.ui(r):n=n.text),r||(r=new t,n&&((r.__storage=e(r.__defaults)).text=""+n)),s>0&&(r.__height=s),o>0&&(r.__span=o,this.__span=!0),i.push(r)},this.index=function(){var t=this.grid.__columns;return t.__show_tag!==this.__show_tag?t.indexOf(this):this.__index},this.__find_text=function(){var t,e=this.title();return e&&"object"==typeof e?e instanceof Array?(t=e[0])&&t.__span?t&&t.text||t:(t=e[e.length-1],t&&t.text||t):e.text:e},this.__span_size=function(t){for(var e,i=this.grid.__columns,n=this.__index,r=0;t>0&&(e=i[n+t]);)r+=e.__size,t--;return r},this.createControl=function(i,n){var r=new t;return n&&((r.__storage=e(r.__defaults)).text=i.data[n]),r},flyingon.renderer.bind(this,"GridColumn"),this.__class_init=function(t,e){var i;(i=this.defaultClassName)&&(this.fullClassName=" "+i)}})).register=function(t,e){if(t){var i=flyingon.GridColumn.all||(flyingon.GridColumn.all=flyingon.create(null));if(!e&&i[t])throw'column "'+t+'" has exist';i[this.type=t]=this}return this},flyingon.GridColumn.extend(function(t){this.defaultClassName="f-grid-column-no",this.__name="__column_no",this.defaultValue("size",25),this.defaultValue("draggable",!1),this.defaultValue("resizable",!1),this.defineProperty("no",!1,{set:function(t){this.__show_no=t}}),this.onshowing=function(t,e){this.__show_no&&t.text(e.__show_index+1)}}).register("no"),flyingon.GridColumn.extend(function(t){var e=flyingon.CheckBox;this.defaultClassName="f-grid-column-check",this.__name="__column_check",this.defaultValue("size",30),this.defaultValue("draggable",!1),this.defaultValue("resizable",!1),this.createControl=function(t){var i=new e;return i.__column_check=!0,t.__checked&&i.checked(!0),i}}).register("check"),flyingon.GridColumn.extend(function(t){var e=flyingon.CheckBox;this.createControl=function(t,i){var n=new e;return i&&t.data[i]&&n.checked(!0),n}}).register("checkbox"),flyingon.GridColumn.extend(function(t){var e=flyingon.TextBox;this.createControl=function(t,i){var n=new e;return i&&n.value(t.data[i]),n}}).register("textbox"),flyingon.GridColumn.extend(function(t){var e=flyingon.TextButton;this.createControl=function(t,i){var n=new e;return i&&n.value(t.data[i]),n}}).register("textbutton"),flyingon.GridColumn.extend(function(t){var e=flyingon.NumberPicker;this.createControl=function(t,i){var n=new e;return i&&n.value(t.data[i]),n}}).register("number"),flyingon.GridColumn.extend(function(t){var e=flyingon.ComboBox,i="inputable,checked,columns,clear,template,itemHeight,separator,popupWidth,maxItems".split(",").pair();this.defineProperty("inputable",!1),flyingon.fragment("f-ComboBox",this),this.__set_items=function(t){var e=this.__wait;if(this.__list=t,e){this.__wait=null;for(var i=e.length-1;i>=0;i--)e[i].items(t)}},this.createControl=function(t,n){var r,s,o=new e;if((s=this.__list)?o.items(s):(this.__wait||(this.__wait=[])).push(o),s=this.__storage){r=i;for(var a in s)r[a]&&o[a](s[a])}return n&&o.value(t.data[n]),o}}).register("combobox"),flyingon.GridColumn.extend(function(t){var e=flyingon.DatePicker,i="format,min,max,time,today,clear".split(",").pair();flyingon.fragment("f-DatePicker",this),this.createControl=function(t,n){var r,s,o=new e;if(s=this.__storage){r=i;for(var a in s)r[a]&&o[a](s[a])}return n&&o.value(t.data[n]),o}}).register("date"),flyingon.GridColumn.extend(function(t){var e=flyingon.TimePicker;this.createControl=function(t,i){var n=new e;return i&&n.value(t.data[i]),n}}).register("time"),flyingon.GridColumns=Object.extend(function(){function t(t,i,n,r,s,o){for(var a,l,h,f,c=0,u=-1;r<s;)l=t[r],l.__index=r++,l.__offset=0,l.__visible&&(h=(l.__storage||l.__defaults).size,h>=0?h|=0:(h=parseFloat(h))>0&&(a=!0,f=h*i/100,h=0|f,(f-=h)>0&&(o+=f)>=1&&(o--,h++)),l.__start=n,l.__size=h,n+=h,c+=h,u<0&&l.__span&&(u=r-1));if(t.__size=c,u>=0)for(r=u;r<s;)l=t[r],l.__span&&e(t,r,s,l.__cells),r++;return a&&(t.__persent=!0),o}function e(t,e,i,n){for(var r=n.length-1;r>=0;r--){var s,o,a=n[r],l=a.__span,h=l;if(l>0){for(o=t[e].__size;l>0;)e+l<i&&(s=t[e+l])?(s.__offset<l&&(s.__offset=l),s.__visible&&(o+=s.__size)):h--,l--;a.__size=o}a.columnSpan=h}}function i(t){for(var e,i,n=t.__keys=flyingon.create(null),r=0;e=t[r++];)(i=e.__storage)&&(i=i.name)&&(n[i]=e);return n}this.init=function(t){this.grid=t,this.__locked=[0,0,0,0]},flyingon.fragment("f-collection",this),this.__check_items=function(t,e,i){var n,r=flyingon.GridColumn,s=r.all,o=this.grid,a=e.length;for(this.__keys=null;i<a;)n=e[i],n instanceof r?n.grid&&n.remove():e[i]=n=new(n&&s[n.type]||r)(n),n.grid=o,i++;o.rendered&&o.update(!0)},this.__remove_items=function(t,e){var i,n=this.grid;this.__keys=null;for(var r=0,s=e.length;r<s;r++)i=e[r],i.grid=null,i.view&&i.renderer.unmount(i);n.rendered&&n.update(!0)},this.__compute_visible=function(t,e){var i,n,r=this.__locked,s=r[0],o=this.length;if(!(o<=0)){this.__arrange_start=t,t+=r[2],o-=r[1];for(var a=s;a<o;a++)if((i=this[a])&&i.__visible&&i.__start+i.__size>=t){s=a;break}n=t+this.__arrange_size-r[2]-r[3];for(var a=s;a<o;a++)if((i=this[a])&&i.__visible&&i.__start>n){o=a+1;break}if(this.__visible_start=s,this.__visible_end=o,e&&this.__show_start<=s&&this.__show_end>=o)return!0;n=o+2,o=this.length-r[1],o=n>o?o:n,s-=this[s].__offset,(n=this.grid.oncolumnstart)&&(n=n.call(this.grid,this,s),n>=0&&(s=n)),this.__show_start=s,this.__show_end=o}},this.__compute_size=function(e){var i,n=this.__locked,r=this.grid.__group_size,s=r,o=0,a=n[0],l=this.length;this.__arrange_size=e,this.__persent=!1,a>0&&(o=t(this,e,r,0,a,o),r=0,s+=n[2]=this.__size),(i=n[1])>0&&(o=t(this,e,0,l-i,l,o),l-=i,s+=n[3]=this.__size),t(this,e,r+n[2],a,l,o),this.__size+=s},this.find=function(t){return(this.__keys||i(this))[t]},this.__sync_visible=function(){for(var t=this.length-1;t>=0;t--){var e,i=this[t];i.__visible||(e=i.__storage)&&!e.visible||(i.__visible=!0)}},this.dispose=function(){for(var t=this.length-1;t>=0;t--){var e=this[t];e.grid=null,e.view&&e.renderer.unmount(e)}this.grid=null}}),flyingon.GridRow=Object.extend._(function(){this.id=0,this.parent=null,this.data=null,this.expanded=!1,this.level=function(){for(var t=this.parent,e=0;t;)e++,t=t.parent;return e},this.checked=function(t){if(void 0===t)return this.__checked||!1;if(this.__checked!==(t=!!t)){var e=this.grid.__checked_rows;t?e.push(this):e.splice(e.indexOf(this),1),this.view&&this.renderer.set(this,"checked",this.__checked=t)}},this.dispose=function(){var t=this.length;if(t>0)for(var e=t-1;e>=0;e--)this[e].dispose();this.grid=null,this.view&&this.renderer.unmount(this)},flyingon.renderer.bind(this,"GridRow")}),flyingon.GroupGridRow=Object.extend._(function(t){this.__group_row=!0,this.parent=null,this.data=null,this.name="",this.level=0,this.expanded=!1,this.total=0,this.compute=function(t,e,i,n){var r,s=this.data;if(s&&e in s)r=s[e];else if((r=this.length)>0){if(this.__sub_group)for(var o=0;o<r;o++)this[o].compute(t,e,i);(s||(this.data={}))[e]=r=i(this,e)}else r=0;return n?n(this,e,r):r},this.dispose=function(){var t=this.length;if(t>0)for(var e=t-1;e>=0;e--)this[e].dispose();this.grid=null,this.view&&this.renderer.unmount(this)},flyingon.renderer.bind(this,"GroupGridRow")}),flyingon.GridView=flyingon.defineClass(Array,function(){function t(e,i,n,r,s,o){for(var a,l,h=0,f=r.length=o.length;h<f;h++)l=o[h],a=r[h]=new e,a.grid=n,a.parent=s,a.data=l.data,i[a.id=l.uniqueId]=a,l.length>0&&t(e,i,n,a,a,l)}function e(t,e){var n=t.splice(0);n.length>0&&(n=i(flyingon.GroupGridRow,t.grid,null,n,e,0,0),n.push.apply(t,n))}function i(t,e,r,s,o,a,l){for(var h,f,c=[],u=o[a++],d=n(s,u),_=!!o[a],g=0,p=d.length;g<p;g++)(s=d[f=d[g]])&&(h=new t,h.grid=e,h.parent=r,h.name=u,h.text=f,h.level=l,h.total=s.length,(h.__sub_group=_)&&(s=i(t,e,h,s,o,a,l+1)),c.push.apply(h,s),c.push(h));return c}function n(t,e){for(var i,n,r,s,o=[],a=0,l=t.length;a<l;a++)(i=t[a])&&(n=i.data)&&null!=(r=n[e])&&((s=o[r])?s.push(i):(o.push(r),o[r]=[i]));return o.length>0&&o.sort(),o}function r(t){var e,i=t.splice(0);t.grid.__columns.__sync_visible(),i.length>0&&(s(i,e=[]),e.push.apply(t,e))}function s(t,e){for(var i,n,r=e.splice,o=0,a=t.length;o<a;o++)if(i=t[o])if(i.renderer.unmount(i),i.__sub_group)s(i,e);else if((n=r.call(i,0)).length>0){for(var l=n.length-1;o>=0;o--)n[l].parent=null;e.push.apply(e,n)}}function o(t,e){for(var i=0,n=e.length;i<n;i++){var r=e[i];t.push(r),r.expanded&&r.length>0&&o(t,r)}}function a(t,e){for(var i,n=0,r=t.length;n<r;n++)(i=t[n])&&(e.push(i),i.expanded&&i.length>0&&a(i,e))}function l(t){for(var e,i=t.length,n=i,r=0;r<i;r++)(e=t[r])&&e.expanded&&(n+=l(e));return n}function h(t,e,i,n){for(var r=t.length-1;r>=0;r--){var s=t[r];s.__sub_group?h(s,e,i,n):n?f(s,e,i):i.call(s,e)}}function f(t,e,i){i.call(t,e);for(var n=t.length-1;n>=0;n--){var r=t[n];r[0]&&f(r,e,i)}}function c(e,i,n,r,s){for(var o,a,l=[],h=0,f=s.length;h<f;h++)a=s[h],o=new e,o.grid=n,o.parent=r,o.data=a.data,i[o.id=a.uniqueId]=o,a.length>0&&t(e,i,n,o,o,a),l.push(o);return l}Object.create;this.init=function(t){this.grid=t,this.view=[],this.keys=flyingon.create(null)},this.dataset=function(i){var n,r=this.grid;this.length>0&&this.dispose(!1),t(flyingon.GridRow,this.keys,r,this,null,i),(this.__group_view=!!(n=r.__groups))&&e(this,n),this.__dirty=!0},this.__change_group=function(t){this.__group_view&&r(this),this.__sort&&this.sort.apply(this,this.__sort),(this.__group_view=!!t)&&e(this,t),this.__dirty=!0},this.__sync_view=function(){var t=this.view;return this.__dirty=!1,t.length=0,this.__group_view?o(t,this):t.push.apply(t,t.slice.call(this,0)),t},this.__expand_row=function(t){if(t&&!t.expanded&&this.grid.trigger("expand","row",t)!==!1){if(t.expanded=!0,!(t.length>0))return!1;var e=this.view,i=[t.__show_index+1,0];a(t,i),i.splice.apply(e,i),this.grid.update()}},this.__collapse_row=function(t){t&&t.expanded&&t.length>0&&this.grid.trigger("collapse")!==!1&&(t.expanded=!1,this.view.splice(t.__show_index+1,l(t)),this.grid.update())},this.find=function(t){return this.keys[t]||null},this.sort=function(t,e,i){if(this.length>0){var n,r=this.view.sort;n=e?function(e,i){return e.data[t]>i.data[t]?-1:1}:function(e,i){return e.data[t]>i.data[t]?1:-1},this.__group_view?h(this,n,r,i):i?f(this,n,r):r.call(this,n),this.__sort=[t,e,i],this.__dirty=!0}},this.__add=function(t,e,i){i&&(i=this.keys[i.uniqueId]||null),e=c(flyingon.GridRow,this.keys,this.grid,i,e),!i&&this.__group_view||(e.unshift(t,0),e.splice.apply(i||this,e)),this.__dirty=!0,this.grid.update(!1)},this.__remove=function(t,e,i){var n,r=this.keys,s=!1;i&&(i=r[i.uniqueId]),!i&&this.__group_view||(s=!0,e.splice.call(i||this,t,e.length));for(var o=e.length-1;o>=0;o--)(n=r[e[o].uniqueId])&&(n.view=!1,n.dispose());this.__dirty=!0,this.grid.update(!1)},this.dispose=function(){for(var t=this.length-1;t>=0;t--)this[t].dispose();this.view.splice.call(this,0),this.view.length=0,arguments[0]===!1?this.keys=flyingon.create(null):this.grid=this.keys=null}}),flyingon.Control.extend("Grid",function(t){function e(t){var e=this.grid;e.__view.__add(t.index,t.rows,t.parent),e.update(!1)}function i(t){var e=this.grid;e.__view.__remove(t.index,t.rows,t.parent),e.update(!1)}this.init=function(){this.__columns=new flyingon.GridColumns(this),this.__view=new flyingon.GridView(this),this.__checked_rows=[]},this.defaultWidth=800,this.defaultHeight=400,this.defaultValue("border",1),this.__locked_top=this.__locked_bottom=0,this.__column_dirty=!0,this.__group_size=0,this.defineProperty("columns",null,{fn:function(t){var e=this.__columns;return void 0===t?e:t>=0?e[t]:("string"==typeof t&&(t=flyingon.parseJSON(t)),t instanceof Array?e.push.apply(e,t):e.push(t),this)}}),this.defineProperty("group",0,{set:function(t){t>0&&this.renderer.set(this,"__render_group"),this.rendered&&(this.renderer.set(this,"header",1),this.update())}}),this.defineProperty("header",30,{set:function(t){this.rendered&&(this.renderer.set(this,"header",2),this.update())}}),this.defineProperty("filter",0,{set:function(t){this.rendered&&(this.renderer.set(this,"filter",t),this.update())}}),this.defineProperty("locked","",{set:function(t){var e=this.__columns.__locked;e[0]=e[1]=e[2]=e[3]=this.__locked_top=this.__locked_bottom=0,t&&(t=t.match(/\d+/g))&&(e[0]=0|t[0],e[1]=0|t[1],this.__locked_top=0|t[2],this.__locked_bottom=0|t[3]),this.rendered&&this.update(!0)}}),this["row-height"]=this.defineProperty("rowHeight",25),this.defineProperty("groups","",{set:function(t){var e=this.__view;this.__groups=t=t&&t.match(/\w+/g)||null,this.__group_size=t?20*t.length:0,e.length>0&&e.__change_group(t),this.trigger(t?"group":"ungroup"),this.renderer.set(this,"__render_group"),this.rendered&&this.update(!0)}}),this.defineProperty("readonly",!0),this["selected-mode"]=this.defineProperty("selectedMode",0),this["tree-column"]=this.defineProperty("treeColumn","",{set:function(t){this.__tree_column=t}}),this["tree-icon"]=this.defineProperty("treeIcon",!0),this.defineProperty("dataset",null,{fn:function(t){var n=this.__dataset||null;return void 0===t?n:n===t&&this.__watch_list&&flyingon.__do_watch(this,"dataset",t)===!1?this:(this.__dataset=t,n&&(n.grid=null,n.subscribe(this,!0),n.off("add",e),n.off("remove",i)),t?(t.subscribe(t.grid=this),t.on("add",e),t.on("remove",i),this.subscribeBind(t,{type:"bind"})):this.__view.dispose(!1),this.rendered&&this.update(),this)}}),this.rows=function(t){var e=this.__view;return void 0===t?e:e[t]||null},this.currentView=function(){var t=this.__view;return t.__dirty?t.__sync_view():t.view},this.expand=function(t){var e,i=this.__view;if(t)t.expanded||this.trigger("expand","row",t)===!1||(e=1,t.expanded=!0);else for(var n=0,r=i.length;n<r;n++)(t=i[n])&&!t.expanded&&this.trigger("expand","row",t)!==!1&&(e=1,t.expanded=!0);return e&&(i.__dirty=!0,this.rendered&&this.update()),this},this.expandTo=function(t,e){return arguments.length<2&&(e=t,t=null),this.__expand_to(t||this.__view,0|e)&&(this.__view.__dirty=!0,this.rendered&&this.update()),this},this.__expand_to=function(t,e){var i;e--;for(var n=t.length-1;n>=0;n--){var r=t[n];if(!r.expanded){if(this.trigger("expand","row",r)===!1)continue;r.expanded=!0,i=1}if(r.length>0)if(e)this.__expand_to(r,e)&&(i=1);else for(var s=r.length-1;s>=0;s--){var o=r[s];o.expanded&&this.trigger("collapse","row",r)!==!1&&(o.expanded=!1,i=1)}}return i},this.collapse=function(t){var e,i=this.__view;if(t)t.expanded&&this.trigger("collapse","row",t)!==!1&&(e=1,t.expanded=!1);else for(var n=0,r=i.length;n<r;n++)(t=i[n])&&t.expanded&&this.trigger("collapse","row",t)!==!1&&(e=1,t.expanded=!1);return e&&(i.__dirty=!0,this.rendered&&this.update()),this},this.checkedRows=function(){return this.__checked_rows},this.current=function(){return this.__current||null},this.__set_current=function(t,e){var i=this.__current;i!==t&&(this.__current=t,this.rendered&&(i&&i.renderer.set(i,"current",i.__current=!1),t&&t.renderer.set(t,"current",t.__current=!0)),e!==!1&&(i=this.__dataset)&&i.moveTo(t&&i.uniqueId(t.id)||null))},this.__subscribe_all=!0,this.subscribeBind=function(t,e){var i,n=this.__view,r=e.row||t.current();switch(r=r&&n.find(r.uniqueId)||null,e.type){case"move":this.__set_current(r,!1);break;case"change":r&&(i=r.__cells)&&(i=i[e.name])&&(i.value||i.text).call(i,r.data[e.name]);break;case"bind":n.dataset(t),this.__set_current(r,!1)}},this.__change_value=function(t){var e,i,n=this.__dataset,r=t.column;n&&r&&(e=r.__name)&&(i=n.uniqueId(t.row.id))&&i.set(e,(t.value||t.text).call(t))},this.sort=function(t,e){t&&(this.__view.sort(t,e,!!this.__tree_column),this.update(!1))},this.update=function(t){if(this.rendered){var e=this.__view_patch;t&&(this.__column_dirty=!0),e&&e.content||this.renderer.set(this,"content",!0)}return this},this.dispose=function(){this.__columns.dispose(),this.__view.dispose(),this.__columns=this.__view=this.__checked_rows=null,t.dispose.call(this)}}).register(),flyingon.Grid.summary=function(){function t(t,i,n){return t=t.toLowerCase(),"function"!=typeof i?e[t]||e.sum:void(e[t]=[i,n])}var e=flyingon.create(null);return t("sum",function(t,e){for(var i,n=0,r=t.length-1;r>=0;r--)(i=t[r])&&(i=i.data)&&(n+=i[e]);return n}),t("avg",e.sum[0],function(t,e,i){return i/t.total}),t("max",function(t,e){for(var i,n=-(1/0),r=t.length-1;r>=0;r--)(i=t[r])&&(i=i.data)&&(i=i[e])>n&&(n=i);return n}),t("min",function(t,e){for(var i,n=1/0,r=t.length-1;r>=0;r--)(i=t[r])&&(i=i.data)&&(i=i[e])<n&&(n=i);return n}),t}(),flyingon.Panel.extend("TabPage",function(t){function e(t,e,i){return t[e]=t.defineProperty(e,i,{set:function(t){this.rendered&&this.renderer[e](this,t)}})}this.defaultValue("layout","vertical-line"),this.defineProperty("key",""),e(this,"icon",""),e(this,"text",""),e(this,"buttons",""),e(this,"closable",!1),this.selected=function(){var t,e=this.parent;return e&&(t=e.__storage)&&e[t.selected]===this||!1}}).register(),flyingon.Control.extend("Tab",function(t){this.defineWidth=this.defaultHeight=300,this.defaultValue("border",1),this.__scroll_header=0,this.__reset_header=!0,this.defineProperty("theme","default",{set:function(t){this.rendered&&this.renderer.set(this,"theme",t)}});var e=function(t,e,i,n){t.defineProperty(e,i,{set:function(t){this.__reset_header=!0,this.__update_dirty||this.invalidate()}})};e(this,"direction","top"),e(this,"header",30),e(this,"offset",2),e(this,"scroll",16),e=function(t,e,i){t.defineProperty(e,i,{set:function(){this.__update_dirty||this.invalidate()}})},e(this,"size",60),e(this,"fill",!1),e(this,"start",0),e(this,"end",0),e(this,"space",2),this.defineProperty("selected",-1,{set:function(t){this.__selectedPage!==!0&&this.selectedPage(this[t],!1)}}),this.selectedPage=function(t,e){var i,n=this.__selectedPage;return void 0===t?void 0!==n?n:this.__selectedPage=this[this.selected()]:(n===t||t&&t.parent!==this||(n&&n.view_head&&n.renderer.selected(n,!1),t?(t&&t.view_head&&t.renderer.selected(t,!0),this.rendered&&this.renderer.set(this,"selected",t,"tag",e),i=this.indexOf(t)):(t=null,i=-1),arguments[1]!==!1&&(this.__selectedPage=!0,this.selected(i)),this.__selectedPage=t,this.trigger("tab-change","current",t,"last",n,"tag",e)),this)},flyingon.fragment("f-container",this,flyingon.TabPage,!0);var i=this.__remove_items;this.__remove_items=function(t,e){var n=this.selected();i.apply(this,arguments),this.selectedPage(this[n]||this[--n]||null,"remove")},this.findByKey=function(t,e){for(var i=this.length-1;i>=0;i--)if(this[i].key()===t)return e&&this.selected(i),this[i]},this.findByText=function(t,e){for(var i=this.length-1;i>=0;i--)if(this[i].text()===t)return e&&this.selected(i),this[i]}}).register(),flyingon.Panel.extend("Popup",function(){this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("width","auto"),this.defaultValue("height","auto"),this.defineProperty("closeLeave",!1),this.defineProperty("closeAway",!1),this.defineProperty("direction","bottom"),this.defineProperty("align","left"),this.defineProperty("reverse",!0),this.show=function(t,e){return this.renderer.show(this,t,e,this.direction(),this.align(),this.reverse()),this.shown=!0,this},this.showAt=function(t,e){return this.renderer.showAt(this,t,e),this.shown=!0,this},this.close=function(t){return t=t||"ok",this.trigger("closing","closeType",t)!==!1&&(this.rendered&&this.renderer.close(this),this.shown=!1,this.trigger("closed","closeType",t),this.autoDispose&&this.dispose(),this)}}).register(),flyingon.Panel.extend("Dialog",function(t){var e=[];this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("padding",2),this.defaultValue("movable",!0),this.defineProperty("header",28,{set:function(t){this.rendered&&this.renderer.set(this,"header",t),this.__update_dirty||this.invalidate()}}),this.defineProperty("icon","",{set:function(t){this.rendered&&this.renderer.set(this,"icon",t)}}),this.defineProperty("text","",{set:function(t){this.rendered&&this.renderer.set(this,"text",t)}}),this.defineProperty("closable",!0,{set:function(t){this.rendered&&this.renderer.set(this,"closable",t)}}),this.onmeasure=function(e){return!!e&&(t.onmeasure.call(this,e),void(2&e&&(this.offsetHeight+=this.header())))},this.arrangeArea=function(){var t=this.header();this.arrangeHeight-=t,this.arrangeBottom-=t},this.show=function(){return this.renderer.show(this),this.shown=!0,this.active(),this},this.showDialog=function(){return this.renderer.show(this,!0),this.shown=!0,this.active(),this},this.moveTo=function(t,e){this.shown&&this.renderer.moveTo(this,t,e)},this.center=function(){this.shown&&this.renderer.center(this)},this.active=function(){var t=e[e.length-1];if(t!==this){var i=e.indexOf(this);i>=0&&e.splice(i,1),e.push(this),t&&(t.renderer.active(t,!1),t.trigger("deactivated")),this.renderer.active(this,!0),this.trigger("activated")}else t&&this.renderer.active(this,!0)},this.activated=function(){return e[e.length-1]===this},this.close=function(t){return t||(t="ok"),this.trigger("closing","closeType",t)!==!1&&(this.rendered&&this.renderer.close(this),this.shown=!1,e.splice(e.indexOf(this),1),e[0]&&e[e.length-1].active(),this.trigger("closed","closeType",t),this.autoDispose&&this.dispose()),this}}).register(),flyingon.Sublayout=flyingon.Control.extend(function(t){this.defineProperty("scale",0,{check:function(t){return t>0?t:0}}),this.defineProperty("layout",null,{set:function(){this.__layout=null}}),this.defaultWidth=this.defaultHeight=200,this.onmeasure=function(t){return flyingon.arrange(this,this.__children,!1,!1,!0),!!t&&(1&t&&(this.offsetWidth=this.arrangeRight+this.borderLeft+this.borderRight),void(2&t&&(this.offsetHeight=this.arrangeBottom+this.borderTop+this.borderBottom)))},this.onlocate=function(){var t,e=this.__children,i=this.offsetLeft,n=this.offsetTop;if(e&&(i||n))for(var r=e.length-1;r>=0;r--)(t=e[r])&&(t.offsetLeft+=i,t.offsetTop+=n);return!1},this.controlAt=function(t,e){var i=this.__layout;return i?i.controlAt(this.__children,t,e):null},this.update=function(){}}),flyingon.Layout=Object.extend(function(){this.type="",this.defineProperty("condition",null),this.defineProperty("spacingX","2"),this.defineProperty("spacingY","2"),this.defineProperty("location",null,{set:function(t){this.__location="function"==typeof t?t:null}}),this.defineProperty("sublayouts",null,{set:function(t){this.__sublayouts=!!t}}),this.arrange=function(t,e,i,n){},this.rearrange=function(t,e,i,n){var r=!1;if(i&&(1===i||t.arrangeRight>t.arrangeLeft+t.arrangeWidth)&&((t.arrangeHeight-=flyingon.hscroll_height)<0&&(t.arrangeHeight=0),i=!1,r=!0),n&&(1===n||t.arrangeBottom>t.arrangeTop+t.arrangeHeight)&&((t.arrangeWidth-=flyingon.vscroll_width)<0&&(t.arrangeWidth=0),n=!1,r=!0),r)return t.arrangeRight=t.arrangeLeft,t.arrangeBottom=t.arrangeTop,this.arrange(t,e,i,n),!0},this.controlAt=function(t,e,i){for(var n,r,s=0,o=t.length;s<o;s++)if((n=t[s])&&e>=(r=n.offsetLeft)&&e<=r+n.offsetWidth&&i>=(r=n.offsetTop)&&i<=r+n.offsetHeight)return t[s];return null},flyingon.fragment("f-serialize",this),this.deserialize_type=!0}),function(){function t(t){if(t){if("string"!=typeof t)return i(t);if(t=l[t])return t[1]||(t[1]=i(t[0]))}return new a.flow}function e(t,e,n){for(var r,s,o,l,h=0,f=t.length;h<f;h++)if(s=t[h]){if(o=s.condition){if((l=o.width)&&(e<l[0]||e>l[1]))continue;if((l=o.height)&&(n<l[0]||n>l[1]))continue;r=s;break}r=s}return r?r.__layout||(r.__layout=i(r,!1)):new a.flow}function i(t,e){if("function"==typeof t)return new t;if(e!==!1&&t instanceof Array)return t;var i=new(a[t&&t.type]||a.flow);return i.deserialize(h,t),i}function n(t,e,i,n,a){var l,h,f;if((l=t.__sublayouts)&&(l===!0&&(l=t.__sublayouts=r(t.sublayouts())),s(l,i),i=l),h=t.__location){for(var c=i.length-1;c>=0;c--)f=i[c],h.prototype=f.__storage||f.__defaults,f.__location_values=new h(e,f,c);h.prototype=null}else for(var c=i.length-1;c>=0;c--)f=i[c],f.__location_values=null;n||a?o(t,e,i,n,a):t.arrange(e,i)}function r(t){var e=t.length;e||(t=[t],e=1);for(var i,n,r,s=flyingon.SerializeReader,o=new Array(t.length),a=0,l=0;r=t[--e];)(i=o[e]=new flyingon.Sublayout).deserialize(s,r),(n=i.scale())?((i.fixed=r=0|n)&&(a+=r),(i.weight=r=n-r)&&(l+=r)):(i.fixed=0,l+=i.weight=1);return o.fixed=a,o.weight=l,o}function s(t,e){var i=e.length-t.fixed,n=t.weight,r=0;i<0&&(i=0);for(var s=0,o=t.length;s<o;s++){var a,l=t[s],h=l.fixed,f=l.weight;f&&(a=i*f/n|0,n-=f,h+=a,i-=a),l.__children=e.slice(r,r+=h)}}function o(t,e,i,n,r){var s,o;n&&e.hscroll&&((e.arrangeHeight-=flyingon.hscroll_height)<0&&(e.arrangeHeight=0),s=!0),r&&e.vscroll&&((e.arrangeWidth-=flyingon.vscroll_width)<0&&(e.arrangeWidth=0),o=!0),t.arrange(e,i,!s&&n,!o&&r),(s=s&&e.arrangeRight<=e.arrangeLeft+e.arrangeWidth)&&(e.arrangeHeight+=flyingon.hscroll_height),(o=o&&e.arrangeBottom<=e.arrangeTop+e.arrangeHeight)&&(e.arrangeWidth+=flyingon.vscroll_width),(s||o)&&t.arrange(e,i)}var a=flyingon.Layout.all=flyingon.create(null),l=flyingon.create(null),h=new flyingon.SerializeReader;flyingon.Layout.register=function(t,e){if(t){if(!e&&a[t])throw'layout "'+t+'" has exist';l[t]=[a[this.type=t]=this,null]}return this},flyingon.layout=function(t,e){return t&&e&&"function"!=typeof e?void(l[t]=[e,null]):flyingon.load.key("layout",t,e)},flyingon.arrange=function(t,e,i,r,s){var o,a=2&t.__auto_size;t.arrangeLeft=t.paddingLeft,t.arrangeTop=t.paddingTop,o=t.borderLeft+t.borderRight+t.paddingLeft+t.paddingRight,o=t.offsetWidth-o,t.arrangeWidth=o>0?o:0,a?o=0:(o=t.borderTop+t.borderBottom+t.paddingTop+t.paddingBottom,o=t.offsetHeight-o,o<0&&(o=0)),t.arrangeHeight=o,(o=t.arrangeArea)&&(o.call(t),a&&(t.arrangeHeight=0)),t.arrangeRight=t.arrangeLeft,t.arrangeBottom=t.arrangeTop,e&&e.length>0?(n(o=flyingon.getLayout(t),t,e,i,r,s),i&&(t.__hscroll=t.arrangeRight>t.arrangeLeft+t.arrangeWidth),r&&(t.__vscroll=t.arrangeBottom>t.arrangeTop+t.arrangeHeight),t.arrangeRight+=t.paddingRight,t.arrangeBottom+=t.paddingBottom):t.__hscroll=t.__vscroll=!1},flyingon.getLayout=function(i){var n,r=i.__layout;return r||"function"!=typeof(n=i.layout)||(r=i.__layout=t(n.call(i))),r instanceof Array&&(r=e(r,i.offsetWidth,i.offsetHeight)),r}}(),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=0,f=e.length;h<f;h++)r=e[h],r.measure(a,l,a,l,3),r.locate(s,o,a,l)}}).register("fill"),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=s+a,f=flyingon.pixel(this.spacingX(),a),c=0,u=e.length;c<u;c++){if(r=e[c],r.measure(a,l,h-s||-1,l,2),r.locate(s,o,0,l,t),i&&t.arrangeRight>h)return this.rearrange(t,e,1,!1);s=t.arrangeX+f}}}).register("line"),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=o+l,f=flyingon.pixel(this.spacingY(),l),c=0,u=e.length;c<u;c++){if(r=e[c],r.measure(a,l,a,h-l||-1,1),r.locate(s,o,a,0,t),n&&t.arrangeBottom>h)return this.rearrange(t,e,!1,1);o=t.arrangeY+f}}}).register("vertical-line"),flyingon.Layout.extend(function(t){this.defineProperty("lineHeight","0",{dataType:"int",check:function(t){return t>0?t:0}}),this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=s+a,f=o+l,c=flyingon.pixel,u=c(this.spacingX(),a),d=c(this.spacingY(),l),_=c(this.lineHeight(),l),g=s,p=0,v=e.length;p<v;p++){if((r=e[p]).measure(a,l,h-s||-1,_||-1),s>g&&s+r.offsetWidth+r.marginRight>h&&(s=g,o=(_?o+_:t.arrangeBottom)+d),r.locate(s,o,0,_,t),n&&t.arrangeBottom>f)return this.rearrange(t,e,!1,1);s=t.arrangeX+u}}}).register("flow"),flyingon.Layout.extend(function(t){this.defineProperty("lineWidth","0",{dataType:"int",check:function(t){return t>0?t:0}}),this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=s+a,f=o+l,c=flyingon.pixel,u=c(this.spacingX(),a),d=c(this.spacingY(),l),_=c(this.lineWidth(),a),g=o,p=0,v=e.length;p<v;p++){if((r=e[p]).measure(a,l,_||-1,f-o||-1),o>g&&o+r.offsetHeight+r.marginBottom>f&&(s=(_?s+_:t.arrangeRight)+u,o=g),r.locate(s,o,_,0,t),i&&t.arrangeRight>h)return this.rearrange(t,e,1,!1);o=t.arrangeY+d}}}).register("vertical-flow"),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s,o=t.arrangeLeft,a=t.arrangeTop,l=t.arrangeWidth,h=t.arrangeHeight,f=t.arrangeRight=o+l,c=t.arrangeBottom=a+h,u=l,d=h,_=flyingon.pixel,g=_(this.spacingX(),l),p=_(this.spacingY(),h),v=0,y=e.length;v<y;v++)switch(s=e[v],s.locationValue("dock")){case"left":s.measure(u,d,l,h,2),s.locate(o,a,0,h),o=s.offsetLeft+s.offsetWidth+s.marginRight+g,(l=f-o)<0&&(l=0);break;case"top":s.measure(u,d,l,h,1),s.locate(o,a,l,0),a=s.offsetTop+s.offsetHeight+s.marginBottom+p,(h=c-a)<0&&(h=0);break;case"right":s.measure(u,d,l,h,2),f-=s.offsetWidth-s.marginLeft-s.marginRight,s.locate(f,a,0,h),(l=(f-=g)-o)<0&&(l=0);break;case"bottom":s.measure(u,d,l,h,1),c-=s.offsetHeight-s.marginTop-s.marginBottom,s.locate(o,c,l,0),(h=(c-=p)-a)<0&&(h=0);break;default:(r||(r=[])).push(s);continue}if(r)for(var v=0,y=r.length;v<y;v++)s.measure(u,d,l,h,3),s.locate(o,a,l,h)}}).register("dock"),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,l=t.arrangeHeight,h=0,f=e.length;h<f;h++)r=e[h],r.measure(a,l),r.locate(s,o,a,l,t);(i||n)&&this.rearrange(t,e,i,n)},this.controlAt=function(t,e,i){return-1}}).register("cascade"),flyingon.Layout.extend(function(t){this.arrange=function(t,e,i,n){for(var r,s,o,a,l=t.arrangeLeft,h=t.arrangeTop,f=t.arrangeWidth,c=t.arrangeHeight,u=l+f,d=h+c,_=flyingon.pixel,g=0,p=e.length;g<p;g++)r=e[g],s=r.__location_values||r.__storage||r.__defaults,o=l+_(s.left,f),a=h+_(s.top,c),r.measure(f,c,u-l,d-h),r.locate(o,a,0,0,t)},this.controlAt=function(t,e,i){return-1}}).register("absolute"),flyingon.Layout.extend(function(t){this.defineProperty("size",20),this.arrange=function(t,e,i,n){for(var r,s,o=t.arrangeLeft,a=t.arrangeTop,l=t.arrangeWidth,h=t.arrangeHeight,f=e.length,c=this.size(),u=f-1,d=l-c*f,_=0;_<f;_++)(r=e[_]).measure(l,h,c,h,3),r.locate(o,a,0,h,t),s=d/u|0,o+=r.offsetWidth+s,d-=s,u--},this.controlAt=function(t,e,i){for(var n,r,s=0,o=t.length;s<o;s++)if((n=t[s])&&e>=(r=n.offsetLeft)&&e<=r+n.offsetWidth)return t[s];return null}}).register("uniform"),flyingon.Layout.extend(function(t){function e(t,e,n,r,s,o,a,l){for(var h,f,c,u=r.width,d=0,_=r.length;d<_;d++)if((h=r[d])&&!h.disabled)if(c=h.group){if(o=i(t,e,n,c,s,o,a,l+h.start),o<0)return-1}else{if(!(f=s[o++]))return-1;f.measure(e,n,u,c=h.size,3),f.locate(a,l+h.start,u,c,t)}return o}function i(t,i,n,r,s,o,a,l){for(var h,f,c,u=r.height,d=0,_=r.length;d<_;d++)if((h=r[d])&&!h.disabled)if(c=h.group){if(o=e(t,i,n,c,s,o,a+h.start,l),o<0)return-1}else{if(!(f=s[o++]))return-1;f.measure(i,n,c=h.size,u,3),f.locate(a+h.start,l,c,u,t)}return o}function n(t){var e,i=s[t];return i?i.clone():(i=new h,(e=r(t||(t="")).match(a))&&i.parse(e,0),s[t]=i)}function r(t){function e(t,e,n){var r=[];do r.push(e);while(--n>0);return i=!0,r.join(" ")}var i,n=o;do i=!1,t=t.replace(n,e);while(i);return t}var s=flyingon.create(null),o=/L([^L\^]+)\^(\d+)/g,a=/[*%.\w]+|[\[\]{}()!]/g;this.defineProperty("vertical",!1),this.defineProperty("data","*[* * *] *[* * *] *[* * *]",{set:function(){this.__data=null}}),this.defineProperty("auto",0),this.arrange=function(t,r,s,o){var a=this.__data||(this.__data=n(this.data())),l=this.vertical(),h=t.arrangeWidth,f=t.arrangeHeight,c=flyingon.pixel,u=c(this.spacingX(),h),d=c(this.spacingY(),f);a.measure(h,f,u,d,l,this.auto(),r),(l?i:e)(t,h,f,a,r,0,t.arrangeLeft,t.arrangeTop),(s||o)&&this.rearrange(t,r,s,o)};var l=Object.extend(function(){this.value=0,this.unit="",this.disabled=!1,this.group=null,this.start=0,this.size=0,this.clone=function(){var t,e=new l;return e.value=this.value,e.unit=this.unit,e.size=this.size,e.disabled=this.disabled,(t=this.group)&&(e.group=t.clone()),e}},!1),h=Object.extend(function(){function t(t,e){for(var i,n=this.length,r=t;r<e;r++)if(i=this[r]){switch(i.unit){case"*":this.weight+=i.value;break;case"%":this.persent.push(i.value);break;default:this.fixed+=i.value}this[n++]=i.clone()}this.length=n}function e(e,i){var n,r,s;if(e===!1)(e=this.__auto)&&([].splice.call(this,e.length),this.fixed=e.fixed,this.weight=e.weight,(s=e.persent)&&this.persent.splice(s));else if(e>0&&(i-=this.count())>0&&((n=(r=this.length)-e)<0&&(n=0),(e=this.count(n))>0)){this.__auto={length:r,fixed:this.fixed,weight:this.weight,persent:(s=this.persent)&&s.length},e=Math.ceil(i/e);for(var o=0;o<e;o++)t.call(this,n,r);return this.length}}var i=flyingon.pixel,n=parseFloat;this.length=0,this.fixed=0,this.weight=0,this.persent=null,this.parameters=null,this.start=0,this.size=0,this.parse=function(t,e){for(var r,s,o,a=this.length;r=t[e++];)switch(r){case"[":case"{":s||(s=this[a++]=new l,s.value=100,s.weight=100,this.width+=100),e=(s.group=new h).parse(t,e);break;case"]":case"}":return this.length=a,e;case"(":for(;")"!==(r=t[e++]);)r.indexOf("%")<0&&(r=i(r)),(this.parameters||(this.parameters=[])).push(r);break;case"!":s&&(s.disabled=!0);break;default:if(s=this[a++]=new l,"*"===r)s.value=100,s.unit="*",this.weight+=100;else if((o=n(r))===o){switch(s.unit=r.replace(o,"")){case"*":this.weight+=o;break;case"%":(this.percent||(this.persent=[])).push(this.value);break;default:this.fixed+=o=s.size=i(r)}s.value=o}}return this.length=a,e},this.count=function(t){var e,i=0;for(t|=0;e=this[t++];)e.disabled||((e=e.group)?i+=e.count():i++);return i},this.measure=function(t,i,n,r,s,o,a){var l=[t,i,n,r,s,o,0];o>0?l[6]=e.call(this,o,a.length):this.__auto&&e.call(this,!1),this.__keys!==(l=l.join(","))&&(this.compute(t,i,n,r,s),this.__keys=l)},this.compute=function(t,e,n,r,s){var o,a,l,h,f=this.parameters,c=this.weight,u=0,d=this.length;if(this.width=t,this.height=e,f&&((h=f[0])&&(n=h>0?h:i(h,n)),(h=f[1])&&(r=h>0?h:i(h,r))),(s=!s)?(a=e,l=r):(a=t,l=n),a>0&&(f=this.persent)){f=f.slice(0),h=0;for(var _=f.length-1;_>=0;_--)h+=f[_]=a*f[_]/100+.5|0;(a-=h)<0&&(a=0),f.index=0}a>0&&(a-=this.fixed+l*(d-1))<0&&(a=0);for(var _=0;_<d;_++)if(o=this[_]){switch(o.unit){case"*":a>0?(h=o.value,a-=o.size=h*a/c|0,c-=h):o.size=0;break;case"%":o.size=f[f.index++]||0}o.start=u,u+=o.size+l,(h=o.group)&&(s?h.compute(t,o.size,n,r,s):h.compute(o.size,e,n,r,s))}},this.clone=function(){var t,e=new this.Class,i=this.length;if(e.length=i,e.fixed=this.fixed,e.weight=this.weight,e.parsent=(t=this.persent)&&t.slice(0),e.parameters=this.parameters,(t=this.length)>0)for(var n=0;n<t;n++)e[n]=this[n].clone();return e}},!1)}).register("table"),function(t){function e(t){var e,n,r=this.Class.__widget_template,s=this.Class.__widget_options,o=r.analyse(),a=s.creating,l=s.created;if(r=r.ast,o){o=p(n=o,""),e=s.defaults,"function"==typeof e&&(e=e.call(this,o.prototype));for(name in n)n[name]&&i(this,name,e&&e[name]||null);(n=s.extend)&&n.call(this,o.prototype),this.init=function(){var t,i=this.vmodel=new o(null,e);(t=a)&&t.call(this,i),j(this,i,r),(t=l)&&t.call(this,i)},this.dispose=function(){var e=this.vmodel;return e&&(e.$dispose(),this.vmodel=null),t.dispose.apply(this,arguments),this}}else(n=s.extend)&&n.call(this,{}),this.init=function(){var t;(t=a)&&t.call(this,{}),this.deserialize(V,r),(t=l)&&t.call(this,{})}}function i(t,e,i){var r=e,s=e;e.indexOf("-")>0?r=e.replace(/-(\w)/g,n):s=e.replace(/([A-Z])/g,"-$1").toLowerCase(),t[s]=t.defineProperty(r,i||null,{set:function(t){this.vmodel.$set(e,t)}})}function n(t,e){return e.toUpperCase()}function r(e,i){if(!i)throw e+" options must input a object!";var n=i.template;if(!n)throw e+" options template not allow empty!";return"string"==typeof n&&"#"===n.charAt(0)&&(n=(n=t.dom_id(n))&&n.innerHTML||""),new t.view.Template(n)}function s(t,e){if("function"==typeof t)e=t,t="*";else if("function"!=typeof e)throw"watch must input a function!";return(this.__watches||(this.__watches=[])).push(t||"*",e),this}function o(t,e,i,n){var r,s,o,a,l=t;do if(r=l.__watches)for(o=0;a=r[o++];)"*"===a||"*"===e||a===e?r[o++].call(l,s||(s={target:t,name:e,newValue:i,oldValue:n})):o++;while(l=l.__parent)}function a(t,e,i,n){var r;switch(n[1]){case 0:return n[3]&&(e=l(t,e,i,n)),(r=E)&&d(e,n[2],r),e[n[2]];case 1:return i&&(i=i[n[2]])?(e=i.__loop_vm,!n[0]&&(r=E)&&_(e,i,r),e[i.__loop_index]):c(t,n[2]);case 2:return i?(i=i[n[2]],(r=E)&&_(i.__loop_vm,i,r),i.__loop_index):u(t,n[2]);case 3:return h(t,e,i,n)}}function l(t,e,i,n){var r=n[3],s=r[0],o=1;for(e=1===s[1]?i&&(i=i[s[2]])?i.__loop_vm[i.__loop_index]:c(t,s[2]):(e.__top||e)[s[2]];s=r[o++];)e=e[s[2]];return e}function h(t,e,i,n,r){var s,o=n[4],l=[],h=0;if(e=e.__top||e,o=n[4])for(;s=o[h++];)l.push(a(t,e,i,s));return l.push(t),r&&l.push(r),e[n[2]].apply(e,l)}function f(t,e){return function(i){h(this,t,null,e,i)}}function c(t,e){var i;do if((i=t.__loop_vm)&&i.__item_name===e)return i[t.__loop_index];while(t=t.parent)}function u(t,e){var i;do if((i=t.__loop_vm)&&i.__index_name===e)return t.__loop_index;while(t=t.parent);return-1}function d(t,e,i){var n=t.__depends||(t.__depends=G(null));K.apply(n[e]||(n[e]=[]),i)}function _(t,e,i){var n=n=t.__depends||(t.__depends=G(null)),r=e.__uniqueId||(e.__uniqueId=I.id++);K.apply(n[r]||(n[r]=[]),i)}function g(t,e,i){for(var n,r=0;n=i[r++];)n.set(i[r++],a(n,t,e,i[r++]))}function p(e,i){function n(t,e){var i,n;if(this.__top=(this.__parent=t)?t.__top:this,e){if("object"==typeof e){i=this.__keys1;for(var r in i)(n=i[r])?this[r]=new n(this,e[r]):this[r]=e[r]}else if(t)throw'"'+this.$name+'" must input a object!'}else{i=this.__keys2;for(var r in i)this[r]=new i[r](this);e=null}this.$data=e}var r=n.prototype,o=r.__keys1=G(null),a=r.__keys2=G(null);r.$name=i,r.$watch=s,r.$get=v,r.$set=y,r.$replace=m,r.$update=w,r.$dispose=b,i||(r.eventBubble="__up_vm",r.$on=t.on,r.$once=t.once,r.$off=t.off,r.$trigger=t.trigger);for(var i in e){var l=e[i];if(!(l[1]>0))switch(l[0]){case 1:o[i]=a[i]=p(l[4],l[1]);break;case 2:o[i]=a[i]=x(l);break;default:o[i]=0}}return n}function v(t){var e;return(e=E)&&d(this,t,e),this[t]}function y(t,e){var i=this.__keys1[t];return i?(i=this[t])&&(i.$replace(e),o(this,t,e,i)):0===i&&(i=this[t])!==e&&(this[t]=e,o(this,t,e,i),(i=this.__depends)&&(i=i[t])&&g(this,null,i)),this}function m(t,e){var i=this.__keys1,n=this.$data;this.$data=t=t&&"object"==typeof t?t:null;for(var r in i)i[r]?this[r].$replace(t&&t[r],!1):(t||n)&&(this[r]=t&&t[r]);e!==!1&&this.$update()}function w(){var t=this.__depends;if(t)for(var e in t)g(this,null,t[e]);if(t||this.__top.__created){t=this.__keys2;for(var e in t)this[e].$update()}}function b(){var t=this.__keys1;for(var e in t)t[e]?this[e].$dispose():this[e]=null;this.__top=this.__parent=this.__depends=this.__watches=this.$data=null}function x(t){function e(t,e){var i=this.__item_fn,n=e&&e.length;if(this.__top=(this.__parent=t).__top,n>0)if(i){this.length=n;for(var r=0;r<n;r++)this[r]=new i(this,e[r])}else K.apply(this,e)}var i=e.prototype=G(X);return i.__item_name=t.item,i.__index_name=t.index,i.$name=t[2],i.$watch=s,i.$get=k,i.$set=C,i.$replace=T,i.$update=P,i.$dispose=N,1===t[0]||(t=t[4])&&1===t[0]?i.__item_fn=p(t[4],t[2]):t&&2===t[0]&&(i.__item_fn=x(t[4])),e}function k(t){var e;return(e=E)&&_(this,this.__controls[t],e),this[t]}function C(t,e){var i;return t>=0?t<this.length&&(i=this[t],i&&i.$replace?i.$replace(e):i!==e&&(this[t]=e,(i=this.__depends)&&(t=this.__controls[t])&&(t=t.__uniqueId)&&(i=i[t])&&g(this,null,i))):"length"===t&&this.splice(e),this}function T(t,e){var i,n=this.length,r=0|(t&&t.length);if(r<=0)return n>0&&this.splice(0),this;if(n>r&&(this.splice(r),n=r),n>0){if(this.__item_fn)for(var s=0;s<n;s++)this[s].$replace(t[s]);else i=F.call(t,0,n),i.unshift(0,n),J.apply(this,i);e!==!1&&this.$update()}return n<r&&this.push.apply(this,F.call(t,n)),this}function P(t){var e=this.__depends;if(e)for(var i in e)g(this,null,e[i]);if(t!==!1&&this.__item_fn&&this.__controls)for(var n=0,r=this.length;n<r;n++)this[n].$update()}function N(){if(this.__item_fn)for(var t=this.length-1;t>=0;t--)this[t].$dispose();return this.__top=this.__parent=this.__depends=this.__watches=this.__controls=this.__template=this.__tag=this.__container=null,this}function L(t,e,i){for(var n=t.__item_fn,r=i,s=e.length;r<s;r++)e[r]=new n(t,e[r])}function H(t,e){var i,n,r=t.__controls;r&&(i=r[e],r.splice(e,1),i&&(n=t.__depends)&&delete n[i.__uniqueId],(n=t.__container)&&n.splice(e,1)),t.__item_fn&&t[e].$dispose()}function z(t,e,i){var n,r=t.__controls,s=t.__depends,o=i.length;if(r){if(s)for(var a=0;a<o;a++)(n=r[e+a])&&delete s[n.__uniqueId];r.splice(e,o),(n=t.__container)&&n.splice(e,o)}if(t.__item_fn)for(var a=0;a<o;a++)i[a].$dispose()}function S(t,e,i){for(var n,r=t.__controls,s=e,o=r.length;s<o;s++)(n=r[s])&&(n.__loop_index+=i);t.__index_name&&t.__depends&&t.$update(!1)}function B(t,e){var i,n=t.__container;if(n){for(var r=e.length-1;r>=0;r--)(n[r]=i=e[r]).__loop_index=r;t.__depends&&t.$update(!1),n.renderer.set(n,"__view_order"),n.invalidate()}}function j(t,e,i){var n,r=G(null);e.__created=!0,A(t,e,r,i),(n=i.children)&&W(t,e,r,n,q)}function O(t,e,i,n,r){var s,o;return o=i.Class,r||(r=n[o])?s=new r:(s=new $,s.tagName=o),(o=s.vm)&&(o.__up_vm=t.__top),A(s,t,e,i),(o=i.children)&&W(s,t,e,o,n),s}function A(t,e,i,n){var r,s,o=E=U;o[0]=t;for(var h in n)switch(h){case"Class":case"children":case"#loop":break;case"#model":(s=t[h])&&(r=n[h],s.call(t,r[3]?l(t,e,i,r):e,r[2]));break;default:switch(r=n[h],h.charAt(0)){case":":o[1]=h=h.substring(1),o[2]=r,t.set(h,a(t,e,i,r));break;case"@":t.on(h.substring(1),f(e,r));break;case"#":(s=t[h])&&(o[1]=h,o[2]=r,s.call(t,a(t,e,i,r)));break;default:r&&"string"==typeof r&&"{"===r.charAt(0)&&(s=r.match(/^\{\{(\w+)\}\}$/))?t.addBind(h,s[1]):t.set(h,r)}}E=null}function W(t,e,i,n,r){for(var s,o=[],a=0,l=n.length;a<l;a++)(s=n[a])&&s["#loop"]?o.push.apply(o,D(t,e,i,s,r)):o.push(O(e,i,s,r));o[0]&&t.push.apply(t,o)}function D(t,e,i,n,r){var s,o=[],a=n["#loop"],h=a[2];return e=a[3]?l(t,e,i,a)[h]:(s=i&&i[h])?s.__loop_vm[s.__loop_index]:e[h],e.__template=n,e.__container=t,e.__controls=o,e.__tag=t.lastChild,(s=e.length)>0&&R(o,e,0,s,i,r),o}function R(t,e,i,n,r,s){var o,a,l=e.__top,h=e.__template,f=h.Class,c=s[f],u=h["#loop"],d=u.item,_=u.index;if(d||_){for(;i<n;)c?o=new c:(o=new $,o.tagName=f),(a=o.vm)&&(a.__up_vm=l),o.__loop_vm=e,o.__loop_index=i++,d&&(r[d]=o),_&&(r[_]=o),A(o,l,r,h),t.push(o),(a=h.children)&&W(o,l,r,a,s);d&&(r[d]=null),_&&(r[_]=null)}else for(;i++<n;)t.push(o=O(l,r,h,s,c))}function M(t,e,i){for(var n,r,s=[],o=t.__container,a=t.__controls,l=o,h={};l;)(r=l.__item_vm)&&((n=r.item)&&(h[n]=l),(n=r.index)&&(h[n]=l)),l=l.parent;R(s,t,e,i,h,q),r=(r=a[0])?o.indexOf(r):(r=t.__tag)?o.indexOf(r)+1:0,s.unshift(e,0),a.splice.apply(a,s),s[0]+=r,o.splice.apply(o,s)}var E,q=t.components,$=t.HtmlElement,V=new t.SerializeReader,I=t.__uniqueId,G=t.create,Y=Array.prototype,X=G(Y),F=Y.slice,K=Y.push,J=Y.splice,U=[null,null,null];t.view=function(e){var i,n,s,o=r("view",e),a=e.defaults;return o.parse(),(n=o.analyse())&&(n=new(p(n,""))(null,a)),o=o.ast,(i=e.control)||(i=o.Class,(s=q[i])?i=new s:(i=new $,i.tagName=i)),(s=e.creating)&&s.call(i,n||{}),n?j(i,i.vmodel=n,o):i.deserialize(V,o),(s=e.created)&&s.call(i,n||{}),(s=e.host)&&t.show(i,s),i},t.widget=function(t,i){"string"!=typeof t&&(i=t,t="");var n=r("widget",i),s=q[n.parse().Class]||$;return s=s.extend(e),s.__widget_options=i,s.__widget_template=n,t?s.register(t,i.force):s.init(),s},X.push=function(t){var e=this.length,i=arguments.length;return i>0&&(this.__item_fn&&L(this,arguments,0),K.apply(this,arguments),this.__controls&&M(this,e,e+=i)),e},X.pop=function(){var t=this.length;if(t>0)return H(this,t-1),Y.pop.call(this)},X.unshift=function(t){var e=arguments.length;return e>0&&(this.__item_fn&&L(this,arguments,0),Y.unshift.apply(this,arguments),this.__controls&&M(this,0,e),e<this.length&&S(this,e,e)),this.length},X.shift=function(){var t;if(this.length>0)return H(this,0),t=Y.shift.call(this),this.length>1&&S(this,0,-1),t},X.splice=function(t,e){var i,n=this.length,r=arguments.length;return(t|=0)<0&&(t+=n)<0?t=0:t>n&&(t=n),r>2&&this.__item_fn&&L(this,arguments,2),i=J.apply(this,arguments),i.length>0&&z(this,t,i),(r-=2)>0&&this.__controls&&M(this,t,t+=r),t<this.length&&(r-=i.length)&&S(this,t,r),i},X.sort=function(t){var e=Y.sort,i=this.length;if(i>1){var n,r=this.__controls;if(this.__item_fn)if(r){for(var s=i-1;s>=0;s--)this[s].__control=r[s];e.call(this,t);for(var s=i-1;s>=0;s--)n=this[s],r[s]=n.__control,n.__control=null;B(this,r)}else e.call(this,t);else e.call(this,t),r&&this.$update()}},X.reverse=function(){if(this.length>1){var t=this.__controls,e=Y.reverse;this.__item_fn?t?(e.call(this),t.reverse(),B(this,t)):e.call(this):(e.call(this),t&&this.$update())}}}(flyingon),flyingon.view.Template=Object.extend(function(){function t(t,i){for(var n,r,s,o,a,l=/[^\w-]/,h=/[^\w-:#@]/,f=[],c=0;o=t[c++];)switch(o){case"<":if(n)throw e(o,r);if(o=t[c++],"/"===o){if(!r||t[c]!==r.Class||">"!==t[c+1].charAt(0))throw'"'+o+t[c]+t[c+1]+'" not a valid close tag!';c++,f.pop(),r=f[f.length-1];break}if(o.match(l))throw'"'+o+'" not a valid node name!';a={Class:o},r?(r.children||(r.children=[])).push(a):i.push(a),f.push(r=a),n=!0;break;case"/":if(n&&">"===t[c++]){n=!1,s&&(r[s]=!0,s=null),f.pop(),r=f[f.length-1];break}throw e(o,r);case">":n&&(n=!1,s&&(r[s]=!0,s=null));break;case"=":if(n&&s){switch(o=t[c++]){case"<":case">":case"/":case"=":throw e(o,r)}a=o.charAt(0),a='"'===a||"'"===a?o.substring(1,o.length-1):o,r[s]=a,s=null;break}throw e(o,r);default:if(n)if(s&&(r[s]=!0),n=o.charAt(0),r&&">"===n)s=null,n=!1,(o=o.substring(1)).indexOf("&")>=0&&(o=flyingon.html_decode(o)),r.text=o;else{if(o.match(h))throw'"<'+r.Class+"..."+o+'" not a valid attribute name!';s=o}}return i}function e(t,e){return'"'+(e?"<"+e[0]+"...":"")+t+'" has syntax error!'}function i(t,e){var r,h;(r=e.Class)&&(r=l[r])&&(h=e.children)&&h[0]&&a(r,e,h);for(var f in e){switch(f){case"Class":case"children":case"#loop":h=null;break;default:h=e[f]}if(h)switch(f.charAt(0)){case"#":case":":e[f]=h.indexOf("(")>0?o(t,h):s(t,h,0,0);break;case"@":e[f]=o(t,h)}}if(e=e.children)for(h=0;r=e[h++];)(r["#loop"]?n:i)(t,r)}function n(t,e){var n,o,a,l,h=e["#loop"].match(/[\w.-]+/g);h&&(n=h[0])?(n=s(t,n,2,0),(o=h[1])&&(r(t,o),l=n[4]=t[n.item=o]=[0,1,o,null,null,0],l.loop=n,(a=h[2])&&(r(t,a),t[n.index=a]=n[5]=[0,2,a,null,null,0])),i(t,e),o&&(t[o]=0,l[0]||l[5]||(n.item=n[4]=null),a&&(t[a][5]||(n[5]=n.index=null),t[a]=0))):i(t,e),e["#loop"]=n}function r(t,e){if(e.indexOf(".")>=0)throw'loop "'+e+'" can not include "."!';if(t[e])throw'loop "'+e+'" has be used!'}function s(t,e,i,n){for(var r,s=e.match(/[\w-]+/g),o=null,a=0,l=s.length-1;a<l;a++){if(r=t[e=s[a]])switch(r[0]){case 1:t=r[4];break;case 0:r[0]=1,t=r[4]||(r[4]={})}else{if(0===r)throw'"'+e+'" is out of scope range!';r=t[e]=[1,0,e,o?o.slice(0):null,t={}]}o?o.push(r):o=[r]}if(r=t[e=s.pop()]){if(i){if(r[0])throw'"'+e+'" has be used!';r[0]=i}else r[1]&&r[5]++;return r}if(0===r)throw'"'+e+'" is out of scope range!';return t[e]=[i,n,e,o,null]}function o(t,e){var i,n,r,o,a=e.match(/[\w-.]+/g);if((e=a[0]).indexOf(".")>=0)throw'function "'+e+'" can not include "."!';if((n=t[e])&&2!==n[1])throw'function name "'+e+'" has be used!';if(n=t[e]=[0,3,a[0],null,null],a[1]){for(i=[],r=1;e=a[r++];)(o=t[e])?o[5]++:o=s(t,e,0,0),i.push(o);n[4]=i}return n}function a(t,e,i){for(var n=t[0],r=t[1]||n,s="string"==typeof n,o=0,a=i.length;o<a;o++)(s?i[o].Class===n:n.test(i[o].Class))||(i[o]={Class:r,children:[i[o]]})}var l=flyingon.view.rule=flyingon.create(null);this.init=function(t){"string"==typeof t?this.template=t:this.ast=t},this.parse=function(e){var i,n=this.ast;if(!n&&(i=this.template)){if(i=i.replace(/<!--[\s\S]*?-->/g,"").replace(/>\s+<\s*\//g,"></"),i=i.match(/[<=\/]|[\w-:#@]+|\>[^<>]+(?=\<\s*\/)|[>\/]|"[^"]*"|'[^']*'/g),n=t(i,[]),!e&&n instanceof Array){if(n[1])throw"template can only one root node!";n=n[0]}if(!n)throw"template can not be empty!";if(n["#loop"])throw'template root nood can not use "#loop"!';this.ast=n}return n},this.analyse=function(){var t,e=this.vm;if(void 0===e&&(t=this.ast||this.parse())){i(e={},t);for(t in e)return this.vm=e;return this.vm=null}return e},l.table=[/tbody|thead|tfoot/,"tbody"],l.thead=l.tbody=l.tfoot=["tr"],l.tr=[/td|th/,"td"],l.ol=l.ul=["li"],l.dl=["dt"],l.dt=["dd"],l.select=["option"]},!1),function(t,e){function i(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new f(e))}function n(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new c(e))}function r(t,e){var i,n,r=this.view,s=r.getBoundingClientRect(),o=0,a="";return"x"!==t&&(i=e.clientY-s.top,i>=0&&i<=4?(o=1,a="s"):(n=this.offsetHeight,i>=n-4&&i<=n&&(o=2,a="n"))),"y"!==t&&(i=e.clientX-s.left,i>=0&&i<=4?(o|=4,a+="e"):(n=this.offsetWidth,i>=n-4&&i<=n&&(o|=8,a+="w"))),a?a+="-resize":(t=this.__style)&&(a=t.cursor),r.style.cursor=a||"",o}function s(t){var e=t.side;1===(1&e)?this.height(t.height-t.distanceY):2===(2&e)&&this.height(t.height+t.distanceY),4===(4&e)?this.width(t.width-t.distanceX):8===(8&e)&&this.width(t.width+t.distanceX),h()}function o(t){if(this.trigger("move-start")!==!1){var i,n=this.view,r=n.cloneNode(!0),s=n.style,o=n.getBoundingClientRect(),a={dom:r,left:o.left,top:o.top},l=this;for(s.borderStyle="dashed",s.borderColor="red",s=r.style,s.opacity=.2,s.left=o.left+"px",s.top=o.top+"px",e.body.appendChild(r);i=l.parent;)l=i;return o=l.view.getBoundingClientRect(),a.host=l,a.offsetX=t.clientX-o.left,a.offsetY=t.clientY-o.top,a}}function a(t,e){var i=t.dom.style,n=t.distanceX,r=t.distanceY,s=t.host.findDropTarget(t.offsetX+n,t.offsetY+r),o=s[0],a=s[1];a?this!==a&&o.splice(o.indexOf(a),0,a):this.parent!==o,i.left=t.left+n+"px",i.top=t.top+r+"px",this.trigger("move")}function l(t,e){var i,n=t.dom,r=n.style,s=this.view.style;(i=n.parentNode)&&i.removeChild(n),s.borderStyle=r.borderStyle,s.borderColor=r.borderColor,this.trigger("move-end")}function h(){var t=window.getSelection;t?t.call(window).removeAllRanges():e.selection.empty()}var f=t.MouseEvent,c=t.KeyEvent,u=t.dom_on,d=null,_=0,g=null;e.getAttribute;t.show=function(i,n){if("string"==typeof n&&(n=e.getElementById(n)),!n)throw"can not find host!";var r=n.clientWidth,s=n.clientHeight;t.ready(),t.__update_patch(),i.__top_control||(i.__top_control=!0,i.fullClassName+=" f-host"),n.appendChild(i.view||i.renderer.createView(i)),i.renderer.__update_top(i,r,s)},t.hide=function(t,e){if(t.__top_control){var i,n=t.view;t.__top_control=!1,n&&(i=n.parentNode)&&i.removeChild(n),t.fullClassName=t.fullClassName.replace(" f-host",""),e!==!1&&t.dispose()}},t.findControl=function(e){for(var i;e;){if(i=e.flyingon_id)return t.__uniqueId[i];e=e.parentNode}},u(e,"mousedown",function(e){var i,n,r=t.findControl(e.target);r&&!r.disabled()&&r.trigger(d=new f(e))!==!1&&((n=_)?_={side:n,width:r.offsetWidth,height:r.offsetHeight}:(i=r.parent)&&(n=r.movable)&&n.call(r)&&(n=g=(r.__move_start||o).call(r,e)))}),u(e,"mousemove",function(e){var i,n,o=d;if(o&&(i=o.target)){var l=e.clientX-o.clientX,h=e.clientY-o.clientY;(n=_)?(n.distanceX=l,n.distanceY=h,s.call(i,n)):(n=g)?(n.distanceX=l,n.distanceY=h,(i.__do_move||a).call(i,n,e)):(e=new f(e),e.mousedown=o,e.distanceX=l,e.distanceY=h,i.trigger(e))}else(i=t.findControl(e.target))&&!i.disabled()&&i.trigger(new f(e))!==!1&&(n=i.resizable)&&"none"!==n.call(i)&&(_=(i.__check_resize||r).call(i,n,e))}),u(e,"mouseup",function(e){var i,n,r=d;r&&(i=r.target)?((n=_)?_=0:(n=g)&&((i.__move_end||l).call(i,n,e),g=null),e=new f(e),e.mousedown=r,e.distanceX=e.clientX-r.clientX,e.distanceY=e.clientY-r.clientY,i.trigger(e),d=null):(i=t.findControl(e.target))&&!i.disabled()&&i.trigger(new f(e))}),u(e,"click",i),u(e,"dblclick",i),u(e,"mouseover",i),u(e,"mouseout",i),u(e,"keydown",n),u(e,"keypress",n),u(e,"keyup",n),t.__dom_scroll=function(e){var i=t.findControl(this);if(i&&!i.disabled())if(i.trigger("scroll")!==!1)i.__do_scroll(i.scrollLeft=this.scrollLeft,i.scrollTop=this.scrollTop);else try{this.onscroll=null,this.scrollTop=i.scrollTop,this.scrollLeft=i.scrollLeft}finally{this.onscroll=scroll}},u(e,e.mozHidden?"DOMMouseScroll":"mousewheel",function(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger("mousewheel","original_event",e,"wheelDelta",e.wheelDelta||40*-e.detail||-120)})}(flyingon,document),flyingon.renderer("Highlight",function(t){function e(){for(var t,e=i,n=0;t=e[n++];)t.renderer.code(t,t.view,t.code());i=null}var i,n=flyingon.create(null);this.render=function(t,e,i,n){t.push("<div"),this.renderDefault(t,e,i,(n||"")+"overflow:auto"),t.push('><pre style="margin:0;width:auto;height:auto;"><code style="overflow:visible;"></code></pre></div>')},this.theme=function(t,e,i){n[i]||flyingon.link(flyingon.require.path("flyingon/third/highlight/styles/"+i+".css"))},this.code=function(t,n,r){var s,o=window.hljs;if(o){n=n.firstChild.firstChild,n.className=t.language(),n[this.__text_name]=r;try{o.highlightBlock(n)}catch(a){}}else(s=i)?s.push(t):(i=[t],this.theme(t,n,t.theme()),flyingon.script(flyingon.require.path("flyingon/third/highlight/highlight.js"),e))}}),flyingon.Control.extend("Highlight",function(t){this.defaultWidth=400,this.defaultHeight=200,this.defineProperty("language","javascript",{set:function(t){this.rendered&&this.renderer.set(this,"code",this.code())}}),this.defineProperty("theme","vs",{set:function(t){this.rendered&&this.renderer.set(this,"theme",t)}}),this.defineProperty("code","",{set:function(t){this.renderer.set(this,"code",t)}})}).register();