/*
* flyingon javascript library v0.0.1.0
* https://github.com/freeoasoft/flyingon
*
* Copyright 2014, yaozhengyang
* licensed under the LGPL Version 3 licenses
*/
"use strict";var flyingon;!function(t){"function"==typeof require&&"object"==typeof module&&module?t(module.exports=flyingon={}):"function"==typeof define&&define.amd?(flyingon={},define(function(e,i,n){t(n.exports=flyingon)})):t(flyingon=window.flyingon||(window.flyingon={}))}(function(t){function e(){}t.version="1.0.1",t.create=Object.create||function(t){return t?(e.prototype=t,new e):{}},t.extend=function i(t,e,n){var s,r=arguments.length-1;for(t=t||{},arguments[r]===!0&&(n=!0,r--);r>0&&(s=arguments[r--]);)if(n)for(var o in s){var a=s[o];a&&"object"==typeof a?t[o]=i(t[o],a,!0):t[o]=a}else for(var o in s)t[o]=s[o];return t},t.each=function(e,i,n){if(e){"string"==typeof e&&(e=e.match(/\w+/g));for(var s=0,r=e.length;s<r;s++)i.call(n||t,e[s],s)}}}),function(t){function e(t){var e,i,n,s=N;if(i=s[t])return i;if(e=t.match(/\w+/g)){i=O[O.length-1]||s;for(var r=0,o=e.length;r<o;r++)(n=i[t=e[r]])?i=n:(n=(n=i.moduleName)?n+"."+t:t,i=s[n]=i[t]=L(null),i.moduleName=n);return i}throw"module name can use only letters and numbers!"}function i(e,i){try{O.push(R=e),i.call(e,e,t)}finally{t.endModule()}}function n(e,i,n,l){function f(){var t=this.init;t&&t.apply(this,arguments)}var f,v,N,O,j,A;return N=L(v=i.prototype||Object.prototype),N.base=v,A=!v.__flyingon_class,(l||null==l&&A||v.__defaults)&&(N.__defaults=L(v.__defaults||null),N.__properties=L(v.__properties||null),A&&(N.defineProperty=h,N.storage=c,N.get=u,N.set=d,N.defaultValue=_,N.properties=p,N.getOwnPropertyNames=C,N.notify=g,N.watch=y,N.unwatch=m)),A&&(N.__flyingon_class=!0,N.on=b,N.once=w,N.off=x,N.trigger=k,N.is=o,N.toString=a,N.dispose=P),O=R||t,j=e?O.moduleName+"-"+e:"anonymous-type-"+H++,N[j]=!0,N.Class=N.constructor=f,f.__class_fn=n,N.init=s,e&&(f.typeName=e,O[e]=B[j]=f),f.fullName=j,f.prototype=N,f.module=O,f.superclass=i,f.register=T,f.init=r,f.extend=Object.extend,f}function s(){var t;this.Class.init(),(t=this.init)&&t.apply(this,arguments)}function r(){var t,e=this.prototype,i=e.base;return(t=this.superclass)&&t.__class_fn&&t.init(),(t=this.__class_fn)&&(t.call(e,i,e),(t=e.__class_init)&&t.call(e,this,i,e),delete this.__class_fn,e.init===s&&delete e.init),this}function o(t){return t&&(this instanceof t||(t=t.fullName)&&this[t])}function a(){return"[object "+this.fullName+"]"}function h(t,e,i){var n,s;if(!/^[a-z][\w$]*$/.test(t))throw'property name "'+t+'" is not legal!';return i?i.name=t:i={name:t},"function"==typeof e?(i.fn=e,i.defaultValue=e=null):i.defaultValue=e,(this.__defaults||(this.__defaults=L(null)))[t]=e,(this.__properties||(this.__properties=L(null)))[t]=i,(s=i.dataType)||(s=i.dataType=typeof e),this[t]=n=i.fn||l(t,s,i.check,i.set),n.property=!0,(s=this.__selector_extend)&&((s.prototype||s)[t]=f(t)),n}function l(t,e,i,n){return function(s){var r=this.__storage,o=t,a=(r||this.__defaults)[o];if(void 0===s)return a;switch(e){case"boolean":s=!!s&&"false"!==s;break;case"integer":s=0|s;break;case"number":s=+s||0;break;case"string":s=""+s;break;case"date":s?s instanceof Date||(s=new Date(s)):s=null}return i&&(s=i.call(this,s)),a!==s&&((r||(this.__storage=L(this.__defaults)))[o]=s,n&&n.call(this,s,a),(r=this.__watches)&&(r[o]||r["*"])&&this.notify(o,s,a)),this}}function f(t){return function(e){var i,n,s=0,r=t;if(void 0===e)for(;i=this[s++];)if(n=i[r])return n.call(i);for(;i=this[s++];)(n=i[r])&&n.apply(i,arguments);return this}}function c(){return this.__storage||(this.__storage=L(this.__defaults))}function u(t){var e;return void 0!==(e=(this.__storage||this.__defaults)[t])?e:(e=this.__custom_get)?e.call(this,t):void 0}function d(t,e){var i;return(i=this[t])&&i.property?i.call(this,e):(i=this.__custom_set)?i.call(this,t,e):(this.__storage||(this.__storage=L(this.__defaults)))[t]=e,this}function _(e,i){var n=this.__defaults;return void 0===i?n[e]:(n[e]=i,n=this.__properties,(n[e]=t.extend({},n[e])).defaultValue=i,this)}function p(t,e){var i,n=this.__properties,s=[];"function"==typeof t&&(e=t),t=t===!1?this.base.__properties:null;for(var r in n)!(i=n[r])||t&&t[r]===i||e&&!e(i)||s.push(i);return s}function g(t,e,i){var n,s=this.__watches;return s&&((n=s[t])&&v.call(this,n,t,e,i),"*"!==t&&(n=s["*"])&&v.call(this,n,"*",e,i)),this}function v(t,e,i,n){var s=t[0],r=1;for(s&&this.pushBack(s,i);s=t[r++];)s.call(this,e,i,n)}function y(t,e){if("function"==typeof t)e=t,t="*";else if("function"!=typeof e)return;var i=this.__watches||(this.__watches={}),n=i[t];return n?n.push(e):i[t]=["",e],this}function m(t,e){"function"==typeof t&&(e=t,t="*");var i,n=this.__watches;if(n&&(i=n[t])){for(var s=i.length-1;s>=0;s--)i.splice(s,1);1!==i.length||i[0]||delete n[t]}return this}function b(t,e){if(t&&"function"==typeof e){var i=this.__events||(this.__events=L(null));(i[t]||(i[t]=[])).push(e),(e=this.__event_on)&&e.apply(this,t)}return this}function w(t,e){function i(){e.apply(n,arguments),n.off(t,i)}var n=this;return this.on(t,i)}function x(t,e){var i,n=this.__events;if(n){if(t)if(e){if(i=n[t]){for(var s=i.length-1;s>=0;s--)i[s]===e&&i.splice(s,1);i.length||(n[t]=null)}}else n[t]&&(n[t]=null);else{for(var t in n)this.off(t);this.__events=null}(e=this.__event_off)&&e.call(this,t)}return this}function k(e){var i,n,s,r,o,a=e.type||(e=new t.Event(e)).type,h=1;for(e.target=this;i=arguments[h++];)e[i]=arguments[h++];i=n=t;do{if((s=n.__events)&&(s=s[a])&&(r=s.length)){h=0;do if((o=s[h++])&&!o.disabled&&(o.call(n,e)===!1&&(e.defaultPrevented=!0),e.cancelBubble))return!e.defaultPrevented;while(h<r)}if(i!==n)n=(o=n.eventBubble)&&n[o];else{if(i===this)break;n=this}}while(n);return!e.defaultPrevented}function C(){var t,e,i=this.__storage;if(i){if(e=Object.getOwnPropertyNames)return e(i);t=this.__defaults,e=[];for(var n in i)i[n]!==t[n]&&e.push(n);return e}return[]}function P(){return this.__events&&this.off(),this}function T(t,e){if(t||(t=this.typeName)){if(!e&&B[t])throw'component "'+t+'" has exist';return B[this.nickName=t]=this}return this}var R,L=t.create,B=(t.extend,t.components||(t.components=L(null))),H=1,N=L(null),O=[],j=t.fragments||(t.fragments=L(null)),A="class name can use only letters and numbers and begin with a upper letter!",S="class fn must be a function!";t.moduleName="flyingon",t.className="f",N.flyingon=t,t.use=function(i){switch(typeof i){case"string":return e(i);case"object":return i||t}return t},t.defineModule=function(n,s){var r,o;switch(typeof n){case"string":r=e(n);break;case"function":r=R||t,s=n;break;case"object":r=n||t;default:r=t}return"function"==typeof s?(o=t.require)&&(o=o.callback)&&o(i,[r,s])||i(r,s):O.push(R=r),r},t.endModule=function(){var e=O;return e.pop(),R=e[e.length-1]||t},t.fragment=function(t,e){var i;"function"==typeof e?j[t]=e:(i=j[t])&&i.apply(e,Array.prototype.slice.call(arguments,2))},t.defineClass=function(t,e,i,s){if("string"!=typeof t)s=i,i=e,e=t,t=null;else if(!/^[A-Z]\w*$/.test(t))throw A;if("function"!=typeof i){if("function"!=typeof e)throw S;s=i,i=e,e=Object}else e&&"function"==typeof e||(e=Object);return n(t,e,i,s)},Object.extend=function(t,e,i){if("string"!=typeof t)i=e,e=t,t=null;else if(!/^[A-Z]\w*$/.test(t))throw A;if("function"!=typeof e)throw S;return n(t,this,e,i)},Object.extend._=function(t,e){function i(){}return e||(e=t,t=Object),e.call(i.prototype=L(t.prototype)),i},t.defaultValue=function(t,e,i){var n,s=(t=t.prototype||t).__properties;if(s&&(n=s[e])){if(void 0===i)return n.defaultValue;if(typeof i!==n.dataType)throw"type is defferent!";n.defaultValue=t.__defaults[e]=i}},t.on=b,t.off=x,t.once=w,t.trigger=k}(flyingon),flyingon.Event=Object.extend(function(){this.init=function(t){this.type=t},this.type=null,this.target=null,this.cancelBubble=!1,this.defaultPrevented=!1,this.stopPropagation=function(){this.cancelBubble=!0,arguments[0]!==!1&&this.original_event&&this.original_event.stopPropagation()},this.preventDefault=function(){this.defaultPrevented=!0,arguments[0]!==!1&&this.original_event&&this.original_event.preventDefault()},this.stopImmediatePropagation=function(){this.cancelBubble=this.defaultPrevented=!0,arguments[0]!==!1&&this.original_event&&this.original_event.stopImmediatePropagation()}},!1),flyingon.encode=function t(e){if(!e)return"";var i,n,s=[],r=encodeURIComponent;for(var o in e)if(i=e[o],o=r(o),null!==i)switch(typeof i){case"undefined":s.push(o,"=&");break;case"boolean":case"number":s.push(o,"=",i,"&");break;case"string":case"function":s.push(o,"=",r(i),"&");break;default:if(i instanceof Array)for(var a=0,h=i.length;a<h;a++)void 0===(n=i[a])?s.push(o,"=&"):s.push(o,"=",r(n),"&");else s.push(o,"=",t(i),"&")}else s.push(o,"=null","&");return s.pop(),s.join("")},flyingon.html_encode=function(){var t=flyingon.create(null);return t["&"]="&amp;",t["<"]="&lt;",t[">"]="&gt;",t["'"]="&apos;",t['"']="&quot;",function(e){if(e&&"string"==typeof e){var i=t;return e.replace(/([&<>'"])/g,function(t,e){return i[e]})}return""+e}}(),flyingon.html_decode=function(){var t=flyingon.create(null);return t.amp="&",t.lt="<",t.gt=">",t.apos="'",t.quot='"',function(e){var i=t;return e&&e.replace(/&(\w+);/g,function(t,e){return i[e]||e})}}(),flyingon.parseJSON="undefined"!=typeof JSON?function(t){return JSON.parse(t)}:function(t){if("string"==typeof t){if(/[a-zA-Z_$]/.test(t.replace(/"(?:\\"|[^"])*?"|null|true|false|\d+[Ee][-+]?\d+/g,"")))throw"json parse error!";return new Function("return "+t)()}return t},flyingon.Async=Object.extend(function(){function t(t,e,n,s){if(n||(n=e,e=!1),n){var r=t.__list||(t.__list=[]);r.push([e,n,s,0]),t.__state&&i(t)}return t}function e(t,e,n,s){t.__list;return t.__state=e,t.__value=n,t.__error=s,i(t),t}function i(t){var e,n,s=t.__list,r=0;if(s){for(;e=s[r++];){if(!e[0]&&(r>1||e[3]))return;if(!e[3]){if("function"==typeof(n=e[1]))try{switch(e[2]){case 1:n=1===t.__state&&n.call(t,t.__value);break;case 2:n=2===t.__state&&n.call(t,t.__error);break;case 3:n=n.call(t,t.__value,t.__error)}}catch(o){t.__state=2,t.__error=o,s.splice(0,r),r=0;continue}n&&n["flyingon.Async"]&&!n.__state?(e[3]=1,(n.__back_list||(n.__back_list=[])).push(s,e,t)):s.splice(--r,1)}}if(s.length>0)return;r=0}if(s=t.__back_list){for(;e=s[r++];)e.splice(e.indexOf(s[r++]),1),e=s[r++],t.__error&&t.bubble&&(e.__state=2,e.__error=t.__error),i(e);s.length=0,t.__back_list=null}}this.sleep=function(e,i,n){if(i!==!1||n!==!1){var s=function(t){var i=new flyingon.Async;return setTimeout(function(){i.resolve(t),i=null},0|e),i};return i=i!==!1?1:0,n!==!1&&(i+=2),t(this,!1,s,i)}return this},this.done=function(e,i){return t(this,e,i,1)},this.fail=function(e,i){return t(this,e,i,2)},this.complete=function(e,i){return t(this,e,i,3)},this.resolve=function(t){return e(this,1,t)},this.reject=function(t,i){return this.bubble=i,e(this,2,void 0,t)},this.progress=function(t){return"function"==typeof t&&(this.__progress||(this.__progress=[])).push(t),this},this.notify=function(t){var e=this.__progress;if(e)for(var i=0,n=e.length;i<n;i++)e[i].call(this,t);return this}},!1),flyingon.delay=function(t,e){var i=new flyingon.Async;return setTimeout(function(){"function"==typeof e?(e.call(i),e=null):i.resolve(),i=null},0|t),i},function(){this.pair=function(t){var e=flyingon.create(null);void 0===t&&(t=!0);for(var i=0,n=this.length;i<n;i++)e[this[i]]=t;return e},this.indexOf||(this.indexOf=function(t,e){if((e|=0)<0)return-1;for(var i=this.length;e<i;){if(this[e]===t)return e;e++}return-1}),this.lastIndexOf||(this.lastIndexOf=function(t,e){if((e|=0)>0)return-1;if(!e){if(arguments.length>1)return-1;e=-1}for(e+=this.length;e>=0;){if(this[e]===t)return e;e--}return-1}),this.forEach||(this.forEach=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)t.call(e,this[i],i,this)}),this.map||(this.map=function(t){for(var e=arguments[1],i=this.length,n=new Array(i),s=0;s<i;s++)n[s]=t.call(e,this[s],s,this);return n}),this.filter||(this.filter=function(t){for(var e=arguments[1],i=[],n=0,s=this.length;n<s;n++)t.call(e,this[n],n,this)&&i.push(this[n]);return i}),this.some||(this.some=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)if(t.call(e,this[i],i,this))return!0;return!1}),this.every||(this.every=function(t){for(var e=arguments[1],i=0,n=this.length;i<n;i++)if(!t.call(e,this[i],i,this))return!1;return!0}),this.reduce||(this.reduce=function(t){var e=arguments[1],i=0,n=this.length;for(void 0===e&&(e=this[0],i=1);i<n;)e=t(e,this[i],i++,this);return e}),this.reduceRight||(this.reduceRight=function(t){var e=arguments[1],i=this.length-1;for(void 0===e&&(e=this[i--]);i>=0;)e=t(e,this[i],i--,this);return e})}.call(Array.prototype),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(arguments.length>1){var i=[].slice.call(arguments,1),n=i.push;return function(){var s=i.slice(0);return arguments.length>0&&n.apply(s,arguments),e.apply(t||this,s)}}return function(){return e.apply(t||this,arguments)}}),function(){var t=/([yMdhmsSq]+)/g,e={GMT:"toGMTString",ISO:"toISOString",UTC:"toUTCString",date:"toDateString",time:"toTimeString",locale:"toLocaleString","locale-date":"toLocaleDateString","locale-time":"toLocaleTimeString"},i={y:"getFullYear",d:"getDate",h:"getHours",m:"getMinutes",s:"getSeconds",S:"getMilliseconds"};this.format=function(n){var s;return n?(s=e[n])?this[s]():(s=this,n.replace(t,function(t,e){var n=e.length;switch(e=e.charAt(0)){case"M":e=s.getMonth()+1;break;case"q":e=(s.getMonth()+3)/3|0;break;default:e=s[i[e]]()}return 1===n?e:("00"+e).substr(-n)})):this.toString()},this.addYear=function(t){return this.setFullYear(this.getFullYear()+(0|t)),this},this.addMonth=function(t){return this.setMonth(this.getMonth()+(0|t)),this},this.addDate=function(t){return this.setDate(this.getDate()+(0|t)),this}}.call(Date.prototype),flyingon.fragment("f.serialize",function(){this.deserialize_Class=!0,this.serialize=function(t){var e;(e=this.Class)&&(e=e.nickName||e.Class)&&t.writeProperty("Class",e),(e=this.__storage)&&t.writeProperties(e,this.getOwnPropertyNames(),this.__watches)},this.deserialize=function(t,e){var i,n,s=this.addBind;for(var r in e)i=e[r],s&&"string"==typeof i&&"{"===i.charAt(0)&&(n=i.match(/^\{\{(\w+)\}\}$/))?this.addBind(r,n[1]):(n=this["deserialize_"+r])?n!==!0&&n.call(this,t,i):this.set(r,i)}}),flyingon.SerializeReader=Object.extend(function(){function t(t,e){var i=this.callback;if((this.all||(this.all={}))[e]=t,i&&(i=i[e])){for(var n=0,s=i.length;n<s;n++)i[n](t);i[e]=t=null}}var e=flyingon.components,i=window.Array;this.deserialize=function(t){return t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(t=t instanceof i?this.readArray(t):this.readObject(t),this.all=this.callback=null)),t},this.readArray=function(t,e){if(t){for(var n,s=[],r=0,o=t.length;r<o;r++)(n=t[r])&&"object"==typeof n&&(n=!e&&n instanceof i?this.readArray(n):this.readObject(n,e)),s.push(n);return s}return null},this.readObject=function(i,n){if(i){var s,r;return(r=i.Class)?((r=e[r])?s=new r:(s=new flyingon.HtmlElement,s.tagName=i.Class),s.deserialize(this,i),(r=i.id)&&t.call(this,s,r)):n?(s=new n).deserialize?(s.deserialize(this,i),(r=i.id)&&t.call(this,s,r)):this.readProperties(s,i):this.readProperties(s={},i),s}return null},this.readProperties=function(t,e){var n;for(var s in e)(n=e[s])&&"object"==typeof n&&(n=n instanceof i?this.readArray(n):this.readObject(n)),t[s]=n},this.readReference=function(t,e){var i,n=this.all;n&&(i=n[t])?e(i):(i=this.callback)?(i[t]||(i[t]=[])).push(e):(this.callback={})[t]=[e]}},!1),flyingon.SerializeWriter=Object.extend(function(){var t=window.Array;this.serialize=function(e){if(e&&"object"==typeof e){var i=this.data=[];return e instanceof t?this.writeArray(e):this.writeObject(e),i.pop(),i.join("")}return""+e},this.write=function(e){if(null!=e)switch(typeof e){case"boolean":this.data.push(!!e,",");break;case"number":this.data.push(+e||0,",");break;case"string":this.data.push('"',e.replace(/"/g,'\\"'),'"',",");break;case"function":this.data.push('"',(""+e).replace(/"/g,'\\"'),'"',",");break;default:e instanceof t?this.writeArray(e):this.writeObject(e)}else this.data.push(null,",")},this.writeArray=function(t){var e,i=this.data;if(null!=t)if((e=t.length)>0){i.push("[");for(var n=0;n<e;n++)this.write(t[n]);i.pop(),i.push("]",",")}else i.push("[]",",");else i.push(null,",")},this.writeObject=function(t){var e=this.data;if(null!=t){if(e.push("{"),t.serialize)t.serialize(this);else for(var i in t)e.push('"',i,'":'),this.write(t[i]);e.push(","===e.pop()?"}":"{}",",")}else e.push(null,",")},this.writeProperties=function(t,e,i){for(var n,s,r=this.data,o=0,a=e.length;o<a;o++)n=e[o],i&&(s=i[n])&&(s=s[0])?r.push('"',n,'":"{{',s.replace(/"/g,'\\"'),'}}"',","):(r.push('"',n,'":'),this.write(t[n]))},this.writeProperty=function(t,e,i){t&&(this.data.push('"',t,'":'),i?this.writeArray(e):this.write(e))},this.writeReference=function(t,e){if(t&&e){var i=e.id;i&&"function"==typeof i&&(i=i()),this.data.push('"',t,'":',i||"__auto_id_"+i++)}}},!1),flyingon.RowCollection=Object.extend._(function(){function t(t,e){var n;t.push("{");for(var s in e)n?t.push(","):n=!0,t.push('"',s,'":'),i(t,e[s]);t.push("}")}function e(t,e){t.push("[");for(var n=0,s=e.length;n<s;n++)n>0&&t.push(","),i(t,e[n]);t.push("]")}function i(i,n){if(null==n)return void i.push("null");switch(typeof n){case"string":i.push('"',n.replace(/"/g,'\\"'),'"');break;case"object":n instanceof Array?e(i,n):t(i,n);break;default:i.push(n)}}function n(i,n,s,r,o){var a,h;i.push("{");for(var l in n)if(a=n[l],h=s[l],a!==h||r&&r.test(l)){if(null==a){i.push('"',l,'":null',",");continue}switch(typeof a){case"string":i.push('"',l,'":"',a.replace(/"/g,'\\"'),'"',",");break;case"object":o&&(h=o[l])?(h=h.toJSON(!0),h.length>2&&i.push('"',l,'":',h,",")):(i.push('"',l,'":'),a instanceof Array?e(i,a):t(i,a),i.push(","));break;default:i.push('"',l,'":',a,",")}}i.push(","===i.pop()?"}":"{}")}this.length=0,this.find=function(t){for(var e,i=new flyingon.RowCollection,n=0,s=this.length,r=0;r<s;r++)!(e=this[r])||t&&!t(e)||(i[n++]=e);return i.length=n,i},this.findAll=function(t){for(var e,i=arguments[1]||new flyingon.RowCollection,n=0,s=this.length;n<s;n++)!(e=this[n])||t&&!t(e)||(i[i.length++]=e),e.length>0&&e.findAll(t,i);return i},this.toJSON=function(e,i){var s,r,o,a,h=["["];e&&i&&("string"==typeof i&&(i=i.match(/\w+/g)),i=i&&i.length>0?new RegExp("^("+i.join("|")+")$","i"):null);for(var l=0,f=this.length;l<f;l++)(s=this[l])&&(r=s.data)&&(o?h.push(","):o=!0,e&&(a=s.originalData)?n(h,r,a,i,this.tables):t(h,r));return h.push("]"),h.join("")}}),flyingon.fragment("f.dataset",function(){function t(t,e,i){var n=t.length;if(!(n<=0)){var s,r,o,a=flyingon.DataRow,h=this.dataset,l=null;h?l=this:h=this,s=h.primaryKey;for(var f=e;f<n;f++)(o=t[f])&&o.dataset&&(o=o.data),r=new a,r.dataset=h,r.parent=l,r.data=o=o||{},r.state="added",h.__keys1[r.uniqueId=h.__new_id++]=r,s&&(h.__keys2[r.id=o[s]]=r),h.__changed_rows.push(t[f]=r);for(i.apply(this,t);e<n;)h.trigger("row-added","parent",l,"row",t[e++])}}function e(t,e){var i,s,r=this.dataset,o=null;r?o=this:r=this;for(var a=0;a<e;a++)i=this[t+a],"unchanged"!==i.state&&i.rejectChange(),i.dataset=i.parent=null,r.trigger("row-removed","parent",o,"row",i);return s=n.call(this,t,e),i.uniqueId===r.__current_id&&(i=this[t]||this[--t])&&r.currentRow(i),s}var i=Array.prototype,n=i.splice;this.load=function(t,e){var i=this.dataset;return(i||this).__load_data(i?this:null,t,e),this},this.loadTreeList=function(t,e,i){var n=this.dataset;return(n||this).__load_data(n?this:null,t,e,i||"children"),this},this.indexOf=this.lastIndexOf=[].indexOf,this.push=function(){return t.call(this,arguments,0,i.push),this.length},this.pop=function(){return e.call(this,this.length-1,1)},this.unshift=function(){return t.call(this,arguments,0,i.unshift),this.length},this.shift=function(){return e.call(this,0,1)},this.splice=function(n,s){var r,o=arguments.length;return this.length>0&&(1===o?e.call(this,n,this.length):s>0&&e.call(this,n,s)),o>2&&(arguments[1]=0,t.call(this,arguments,2,i.splice)),r||[]},this.clear=function(){return this.length>0&&e.call(this,0,this.length),this},this.children=function(){return i.slice.call(this,0)},this.removeProperty=function(t){if(t)for(var e,i,n=this.length-1;n>=0;n--)(e=this[n])&&(i=e.data)&&(delete i[t],(i=e.originalData)&&delete i[t],e.length>0&&e.removeProperty(t));return this}}),flyingon.DataRow=Object.extend._(flyingon.RowCollection,function(){var t=new flyingon.Event,e=[].splice;this.dataset=null,this.parent=null,this.id=null,this.uniqueId=0,this.data=null,this.originalData=null,this.state="unchanged",this.isCurrent=function(){return this.uniqueId===this.dataset.__current_id},this.index=function(){var t,e=this.parent||this.dataset;if(e&&(t=e.length)>0)for(var i=0;i<t;i++)if(e[i]===this)return i;return-1},this.get=function(t){var e;if(e=t&&this.data)return e[t]},this.originalValue=function(t){var e;if(t&&(e=this.originalData||this.data))return e[t]},this.set=function(e,i,n){var s,r;if(e&&void 0!==i&&(s=this.data)&&i!==(r=s[e])){var o,a,h,l=this.dataset;if(n!==!1){if(o=t,o.type="value-changing",o.row=this,o.name=e,o.value=i,o.oldValue=r,o&&l.trigger(o)===!1)return this;(h=o.value)!==i&&void 0!==h&&(i=h)}if("unchanged"===this.state){h={};for(a in s)h[a]=s[a];this.originalData=s,this.data=s=h,this.state="changed",l.__changed_rows.push(this)}s[e]=i,o&&(o.type="value-changed",l.trigger(o)),l.dispatch("change",this,e)}return this},this.rollback=function(t){var e=t&&this.originalData;e&&(this.data[t]=e[t])},this.remove=function(){var t=this.parent||this.dataset;return t&&t.removeAt(this.index()),this},this.acceptChange=function(){var t=this.dataset;if(t&&"unchanged"!==this.state)for(var e=t.__changed_rows,i=e.length-1;i>=0;i--)if(e[i]===this)return this.originalData=null,this.state="unchanged",e.splice(i,1),this;return this},this.rejectChange=function(){var t=this.dataset;if(t&&"unchanged"!==this.state)for(var i,n=t.__changed_rows,s=n.length-1;s>=0;s--)if(n[s]===this)return(i=this.originalData)?(this.data=i,this.originalData=null,this.state="unchanged"):e.call(this.parent||t,this.index(),1),n.splice(s,1),this;return this},flyingon.fragment("f.dataset",this),this.level=function(){for(var t=0,e=this;e=e.parent;)t++;return t},this.count=function(){var t=this.length,e=t;if(t>0)for(var i=0;i<t;i++){var n=this[i];n.length>0&&(e+=n.count())}return e}},!1),flyingon.DataSet=Object.extend(flyingon.RowCollection,function(){function t(e,i,n,s,r,o,a){for(var h,l,f=i||e,c=f.rowType||e.rowType,u=e.__keys1,d=e.__keys2,_=f.length,p=n.length,g=0;g<p;g++)l=new c,l.dataset=e,i&&(l.parent=i),l.data=h=n[g]||{},u[l.uniqueId=a++]=l,s&&(d[l.id=h[s]]=l),r||(f[_++]=l,o&&(h=h[o])&&h.length>0&&(a=t(e,l,h,s,null,o,a)));if(r)for(var g=0;g<p;g++)h=n[g],l=d[h[s]],(i=d[h[r]])?(l.parent=i,i[i.length++]=l):e[_++]=l;return f.length=_,a}this.init=function(){this.__new_id=1,this.__keys1=flyingon.create(null),this.__keys2=flyingon.create(null),this.__changed_rows=[]},this.primaryKey="",this.rowType=flyingon.DataRow,flyingon.fragment("f.serialize",this),flyingon.fragment("f.dataset",this),this.loadTreeFromList=function(t,e,i){return this.__load_data(null,t,this.primaryKey=e||"id",i||"parentId")},this.__load_data=function(e,i,n,s,r){return i&&i.length>0&&(this.__new_id=t(this,e,i,this.primaryKey=n,s,r,this.__new_id++),this.trigger("load","parent",e)),this},this.currentRow=function(t){var e=this.__keys1,i=this.__current_id,n=i&&e[i]||null;if(void 0===t)return n;if(n!==t){if(this.trigger("current-changing","value",t,"oldValue",n)===!1)return this.__current_id=i,this;this.__current_id=t&&t.uniqueId,this.trigger("current-changed","value",t,"oldValue",n),this.dispatch("move",t)}return this},this.first=function(){var t;return(t=this[0])&&this.currentRow(t),this},this.previous=function(){var t=this.currentRow(),e=t&&t.index()-1||0;return(t=this[e])&&this.currentRow(t),this},this.next=function(){var t=this.currentRow(),e=t&&t.index()+1||0;return(t=this[e])&&this.currentRow(t),this},this.last=function(){var t;return(t=this[this.length-1])&&this.currentRow(t),this},this.moveTo=function(t){var e;return(e=this[t])&&this.currentRow(e),this},this.id=function(t){return this.__keys2(t)||null},this.uniqueId=function(t){return this.__keys1[t]||null},this.getChanges=function(t){var e=new flyingon.RowCollection,i=this.__changed_rows,n=i.length;if(n>0)if(t&&"string"==typeof t){for(var s,r=0,o=0;o<n;o++)(s=i[o])&&t.indexOf(s.state)>=0&&(e[r++]=s);e.length=r}else i.push.apply(e,i);return e},this.acceptChanges=function(){var t,e=this.__changed_rows,i=e.length;if(i>0){for(var n=0;n<i;n++)(t=e[n])&&(t.originalData=null,t.state="unchanged");e.length=0}return this},this.rejectChanges=function(){var t,e,i=this.__changed_rows,n=i.length;if(n>0){for(var s=n-1;s>=0;s--)(t=i[s])&&((e=t.originalData)?(t.data=e,t.originalData=null,t.state="unchanged"):(i.splice.call(t.parent||this,t.index(),1),t.dataset=t.parent=null));i.length=0,this.dispatch("bind")}return this},this.subscribe=function(t,e){if(t&&t.subscribeBind){var i,n=this.__subscribe;n?(i=n.indexOf(t),e?i>=0&&n.splice(i,1):i<0&&n.push(t)):e||(this.__subscribe=[]).push(t)}return this};var e={type:"",row:null,name:null,current:!1};this.dispatch=function(t,i,n){var s;if(t&&(s=this.__subscribe)){var r,o=e;o.type=t,o.name=n||null,(o.row=i)?o.current=!!i&&i.uniqueId===this.__current_id:(o.row=this.currentRow(),o.current=!0);for(var a=0,h=s.length;a<h;a++)(r=s[a])?r.subscribeBind(this,o):(h--,s.splice(a--,1))}return this},this.bind=function(){var t;return!this.__current_id&&(t=this[0])&&(this.__current_id=t&&t.uniqueId),this.dispatch("bind"),this},this.expression=function(t,e,i){var n;return t&&"string"==typeof t&&("function"==typeof e?("function"!=typeof i&&(i=null),n=this.__expression_keys||(this.__expression_keys=flyingon.create(null)),n[t]=[e,i]):(n=this.__expression_keys)&&delete n[t]),this},this.getBindingValue=function(t,e){var i=this.__expression_keys;return i&&(i=i[t])?i[0].call(this,e.row):(i=(i=e.row.data)&&i[t],void 0!==i?i:"")},this.setBindingValue=function(t,e,i){var n=this.__expression_keys;return n&&(n=n[t])?(n=n[1])&&n.call(this,e,i||this.currentRow()):(i||this.currentRow()).set(t,e),this}},!1),flyingon.fragment("f.bindable",function(){this.defineProperty("dataset",null,{fn:function(t){var e=this.__dataset||null;return void 0===t?e:e===t?this:this.__watch_list&&flyingon.__do_watch(this,name,t)===!1?this:(this.__dataset=t,e&&e.subscribe(this,!0),t&&t.subscribe(this),this)}}),this.addBind=function(t,e){if(t&&e){var i,n=this.__watches||(this.__watches={});(i=n[t])?i[0]=e:n[t]=[e]}return this},this.removeBind=function(t){var e,i=this.__watches;return i&&(e=i[t])&&e[0]&&(e[1]?e[0]="":delete i[t]),this},this.subscribeBind=function(t,e){var i,n,s,r;if(e&&e.current&&(i=this.__watches)){n=e.name;for(var o in i)if((r=i[o])&&(s=r[0])&&(!n||s===n)){r[0]="";try{this.set(o,t.getBindingValue(s,e))}finally{r[0]=s}}}return this},this.pushBack=function(t,e){var i,n=this;do if(i=n.__dataset)return i.setBindingValue(t,e),this;while(n=n.parent);return this}}),function(){var t=flyingon.components,e=new flyingon.SerializeReader;flyingon.__uniqueId||((flyingon.__uniqueId=flyingon.create(null)).id=1),flyingon.ui=function(i){var n=new(t[i.Class]||arguments[1]||flyingon.HtmlElement);return n.deserialize(e,i),n},flyingon.__find_id=function(t,e){for(var i,n,s=[],r=0;i=t[r++];)(n=i.__storage)&&n.id===e&&s.push(i);return s},flyingon.__find_type=function(t,e){var i,n=flyingon.components[e],s=[],r=0;if(n)for(;i=t[r++];)i instanceof n&&s.push(i);return s},flyingon.__find_class=function(t,e){for(var i,n,s=[],r=0;i=t[r++];)(n=i.__class_keys)&&n[e]&&s.push(i);return s}}(),flyingon.fragment("f.visual",function(){function t(t,e){for(var i,n=t.__class_keys={},s=0;i=e[s++];)n[i]=!0;t.className(e.join(" "))}function e(t,e,i){var n=[];for(var s in e)e[s]&&n.push(s);t.className(n.join(" "))}var i=flyingon.__uniqueId;this.__selector_extend=flyingon.Query,this.eventBubble="parent",this.parent=null,this.hasRender=!1,this.__uniqueId=0,this.uniqueId=function(){return this.__uniqueId||(this.__uniqueId=i.id++)},this.__custom_get=function(t){var e,i;if(t&&(i=t.indexOf(":"))>0){if(!(e=this[t.substring(0,++i)]))throw'"'+t+'" is not a valid property!';e.call(this,t.substring(i))}return(this.__storage||this.__defaults)[t]},this.__custom_set=function(t,e){var i,n;if(t&&(n=t.indexOf(":"))>0){if(!(i=this[t.substring(0,++n)]))throw'"'+t+'" is not a valid property!';i.call(this,t.substring(n),e)}else(this.__storage||(this.__storage=flyingon.create(this.__defaults)))[t]=e,(n=this.__view_patch)?n[t]=e:this.renderer.set(this,t,e)},this.remove=function(){var t,e=this.parent;e&&(t=e.indexOf(this))>=0&&e.splice(t,1)},this.detach=function(){var t,e=this.parent;e&&(this.parent=null,(t=e.indexOf(this))>=0&&(Array.prototype.splice.call(e,t,1),this.view&&this.renderer.set(this,"detach"),e.__update_dirty||e.invalidate(2)))},this.defineProperty("id","",{set:function(t,e){var i;this.view&&((i=this.__view_patch)?i.id=t:this.renderer.set(this,"id",t))}}),this["class"]=this.defineProperty("className","",{set:function(t){var e;this.fullClassName=t=t?this.defaultClassName+" "+t:this.defaultClassName,this.view&&((e=this.__view_patch)?e["class"]=t:this.renderer.set(this,"class",t))}}),this.hasClass=function(t){var e;return t&&(e=this.__class_keys)&&e[t]||!1},this.addClass=function(e){var i,n,s;if(e&&(i=e.match(/[\w-]+/g)))if(n=this.__class_keys){for(s=i.length;s--;)n[e=i[s]]?i.splice(s,1):n[e]=!0;i.length>0&&this.className(this.__storage.className+" "+i.join(" "))}else t(this,i);return this},this.removeClass=function(t){var i,n,s;if(t&&(i=t.match(/\w+/g))&&(n=this.__class_keys)){for(s=i.length;s--;)n[t=i[s]]?n[t]=!1:i.splice(s,1);i.length>0&&e(this,n,i)}return this},this.toggleClass=function(i){var n,s,r;if(i&&(n=i.match(/\w+/g)))if(s=this.__class_keys){for(r=n.length;r--;)s[i=n[r]]=!s[i];e(this,s,n)}else t(this,n);return this},this["class:"]=function(t,e){e?this.addClass(t):this.removeClass(t)},this["#model"]=function(t,e){this.on("change",function(i){t.$set(e,i.value)})},this.__class_init=function(t,e){var i=t.module,n=t.typeName;this.renderer===e.renderer&&flyingon.renderer.bind(this,n),n&&(n=((i.className||i.moduleName)+"-"+n).toLowerCase(),(e=e.defaultClassName)&&(n=e+" "+n),this.fullClassName=this.defaultClassName=n)}}),flyingon.globalEval=function(t){window.execScript?window.execScript(t):window.eval(t)},flyingon.absoluteUrl=function(){var t,e=document.createElement("a"),i=location.href.replace(/[?#][\s\S]*/,"");return e.href="",e.href||(e=document.createElement("div"),t=/"/g),function(n,s){return n?t?(e.innerHTML='<a href="'+n.replace(t,"%22")+'"></a>',n=e.firstChild.href):(e.href=n,n=e.href):n=i,s?n.substring(0,n.lastIndexOf("/")+1):n}}(),document.head||(document.head=document.getElementsByTagName("head")[0]),flyingon.script=-[1]&&9!==document.documentMode?function(t,e){var i=document.createElement("script");return i.onload=i.onerror=function(){i=i.onload=i.onerror=null,e&&(e.call(this),e=null)},i.async=!1,i.src=t,document.head.appendChild(i),i}:function(){function t(){for(var t,n;(t=e[0])&&"loaded"===t.readyState;)e.shift(),t.onreadystatechange=null,i.insertBefore(t,i.lastChild||null),(n=e.shift())&&n.call(t)}var e=[],i=document.head;return function(i,n){var s=document.createElement("script");return e.push(s,n),s.onreadystatechange=t,s.src=i,s}}(),flyingon.link=function(t,e,i){var n=document.createElement("link");return n.href=t,n.type=e||"text/css",n.rel=i||"stylesheet",document.head.appendChild(n),n},flyingon.style=function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.head.appendChild(e),e},function(t,e){function i(t){var e,i=this.__events;if(i=i&&i[t.type]){t.target||(t.target=t.srcElement),t.preventDefault||(t.preventDefault=s,t.stopPropagation=r,t.stopImmediatePropagation=o);for(var n=0,a=i.length;n<a&&(!(e=i[n])||e.disabled||(e.call(this,t)===!1&&t.returnValue!==!1&&t.preventDefault(),!t.cancelBubble));n++);}}function n(e){function n(e){i.call(n.dom,e||t.event)}return n.dom=e,e=null,n}function s(){this.returnValue=!1,this.__preventDefault&&this.__preventDefault()}function r(){this.cancelBubble=!0,this.__stopPropagation&&this.__stopPropagation()}function o(){this.cancelBubble=!0,this.returnValue=!1,this.__stopImmediatePropagation&&this.__stopImmediatePropagation()}function a(t){t.stopPropagation()}var h=t.Event&&Event.prototype,l="addEventListener";t[l]?h&&!h.__stopPropagation&&(h.__preventDefault=h.preventDefault,h.__stopPropagation=h.stopPropagation,h.__stopImmediatePropagation=h.stopImmediatePropagation,h.preventDefault=s,h.stopPropagation=r,h.stopImmediatePropagation=o):l=!1,e.dom_once=function(t,i,n){function s(){n.apply(this,arguments),e.dom_off(t,i,s)}e.dom_on(t,i,s)},e.dom_on=function(t,e,s,r){if(t&&e&&s){var o,a=t.__events;if(a){if(o=a[e])return o.push(s),this}else a=t.__events={};a[e]=[s],l?t[l](e,i,r):t.attachEvent("on"+e,a.trigger||(a.trigger=n(t)))}},e.dom_suspend=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i.unshift(a)},e.dom_resume=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i[0]===a&&i.shift()},e.dom_off=function(t,e,n){var s,r=t&&t.__events;if(s=r&&r[e]){if(n){for(var o=s.length-1;o>=0;o--)s[o]===n&&s.splice(o,1);if(s.length>0)return}l?t.removeEventListener(e,i):t.detachEvent("on"+e,r.trigger),delete r[e];for(e in r)return;(n=r.trigger)&&(r.trigger=n.dom=null),t.__events=void 0}},e.dom_trigger=function(e,n){if(t&&n)return i.call(e,n.type?n:{type:n})}}(window,flyingon),function(t,e){var i=e.create(null),n=e.create(null),s=e.create(null);!function(e,i){var n,s,r,o=t.documentElement.style,a=[];for(var h in o)switch(h){case"cssFloat":case"styleFloat":a.push("float");break;case"cssText":break;default:a.push(h)}r=a.join(","),(h=r.match(/\b(webkit|ms|moz|o)[A-Z]/))?(h=h[1],r=r.replace(new RegExp("\\b"+h+"(?=[A-Z])","g"),"-"+h),r=r.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()}),n=r.split(","),s=r.replace(new RegExp("-"+h+"-","g"),"").split(",")):n=s=a;for(var l=0,f=a.length;l<f;l++)r=s[l],e[r]=a[l],i[r]=n[l]}(i,n),e.css_name=function(t,e){return(e?n:i)[t]||""},e.css_map=function(t){return t?n:i},e.css_value=function(t,e,n){var r;(r=i[e])?t.style[r]=n:(r=s[e])&&r(n,t)},e.css_fixed=function(t,e){t&&e&&!i[t]&&(s[t]=e)},e.css_fixed("user-select",function(){function e(){return!1}return function(i,n){n&&((n===t.body?t:n).onselectstart="none"===i?e:null)}}())}(document,flyingon),flyingon.ready=function(){function t(){var i=e;if(i){i.ready=!0,flyingon.dom_off(document,"DOMContentLoaded",t),flyingon.dom_off(window,"load",t);for(var n=0;n<i.length;n++)i[n++].call(i[n]);e=null}}var e;return"complete"!==document.readyState&&(e=[],flyingon.dom_on(document,"DOMContentLoaded",t),flyingon.dom_on(window,"load",t)),function(i,n){"function"==typeof i?e?e.push(i,n):i.call(n):e&&!e.ready&&t()}}(),flyingon.dom_id=function(t){if(t)return"#"===t.charAt(0)&&(t=t.substring(1)),document.getElementById(t)},flyingon.dom_test=function(){var t,e=document.createElement("div");return e.id="f-dom-test",e.style.cssText="position:absolute;overflow:hidden;margin:0;border:0;padding:0;left:-10px;top:0;width:0;height:0;",document.body?document.body.appendChild(e):(t=[],flyingon.ready(function(){var i,n=0;for(t=null,document.body.appendChild(e);i=this[n++];)i.call(this[n++],e)},t)),function(i,n){t?t.push(i,n):i.call(n,e)}}(),flyingon.dom_html=function(t,e,i){if(t&&e){var n,s;i||(i=t.lastChild)&&(n=1)?(s=i.insertAdjacentHTML)?s.call(i,n?"afterend":"beforebegin",e):(s=document.createRange(),e=s.createContextualFragment(e),n?(s.setStartAfter(i),t.appendChild(e)):(s.setStartBefore(i),t.insertBefore(e,i))):t.innerHTML=e}},flyingon.dom_drag=function(t,e,i,n,s,r,o){function a(e){i&&(e.dom=c,i.call(t,e)),flyingon.dom_suspend(c,"click",!0),flyingon.css_value(document.body,"user-select","none"),c.setCapture&&c.setCapture(),a=null}function h(e){var i=e.clientX-v,s=e.clientY-y;(!a||(i<-2||i>2||s<-2||s>2)&&a(e))&&(n&&(e.dom=c,e.distanceX=i,e.distanceY=s,n.call(t,e),i=e.distanceX,s=e.distanceY),m=i,b=s,r!==!0&&("x"!==r&&(u.left=p+i+"px"),"y"!==r&&(u.top=g+s+"px")),e.stopImmediatePropagation())}function l(e){_(document,"mousemove",h),_(document,"mouseup",l),a||(flyingon.css_value(document.body,"user-select",""),c.setCapture&&c.releaseCapture(),setTimeout(f,0),s&&(e.dom=c,e.distanceX=m,e.distanceY=b,s.call(t,e)),t=c=null)}function f(){flyingon.dom_resume(c,"click",!0)}var c=e.dom||e.target,u=c.style,d=flyingon.dom_on,_=flyingon.dom_off,p=c.offsetLeft,g=c.offsetTop,v=e.clientX,y=e.clientY,m=0,b=0;o===!1&&a(e),d(document,"mousemove",h),d(document,"mouseup",l),e.stopImmediatePropagation()},flyingon.dom_align=function(t,e,i,n,s){var r=t.offsetWidth,o=t.offsetHeight,a=t.style,h=document.body.scrollLeft,l=document.body.scrollTop,f=h+e.left,c=l+e.top,u=h+e.right,d=l+e.bottom;if(s!==!1)switch(t=document.documentElement,h=window.innerWidth||t.offsetWidth||0,l=window.innerHeight||t.offsetHeight||0,i){case"left":f<r&&h-u>=r&&(i="right");break;case"top":c<o&&l-d>=o&&(i="bottom");break;case"right":f>=r&&h<u+r&&(i="left");break;default:c>=o&&l<d+o&&(i="top")}if("left"===i||"right"===i)switch(h="left"===i?f-r:u,n){case"middle":l=c+(d-c-o>>1);break;case"bottom":l=d-o;break;default:l=c}else{switch(n){case"center":h=f-(u-f-r>>1);break;case"right":h=u-r;break;default:h=f}l="top"===i?c-o:d}return a.left=h+"px",a.top=l+"px",{left:h,top:l}},flyingon.dom_overlay=function(){var t=[],e=document.createElement("div");return e.className="f-overlay",function(i,n){if(i){var s;if(n===!1){if(t[t.length-1]===i){for(i.flyingon_overlay=!1,t.pop();i=t[t.length-1];){if(e.style.zIndex=i.style.zIndex,s=i.parentNode)return void s.insertBefore(e,i);i.flyingon_overlay=!1,t.pop()}(s=e.parentNode)&&s.removeChild(e)}}else(s=i.parentNode)&&(e.style.zIndex=i.style.zIndex,s.insertBefore(e,i),i.flyingon_overlay=!0,t.push(i))}}}(),function(t){function e(t,e){if(void 0===e)return o[t];if(o[t]!==e){var i=a;o[t]=e;for(var n in i)n.indexOf(t)>0&&(i[n]=void 0)}}function i(t,e){var i,n=a[t];if(void 0!==n)return n;if(n=h[t])return n*e/100+.5|0;if(n=t.match(/[+-]?\d+(.\d+)?|[\w%]+/g))if(i=n[1]){if("%"===i)return(h[t]=n[0])*e/100+.5|0;n=n[0]*(i[i.toLowerCase()]||1)+.5|0}else n=+n[0]+.5|0;else n=0;return a[t]=n}function n(t,e){var i=l[t];return i?i:(i=f[t])?s(t,i,e):(i=+t,i!==i&&(i=t.match(/[+-]?[\w%.]+/g))?t.indexOf("%")<0?l[t]=s(i,e):s(f[t]=i,e):l[t]={left:i|=0,top:i,right:i,bottom:i})}function s(t,e){var n={},s=i;switch(t.length){case 1:n.left=n.top=n.right=n.bottom=s(t[0],e);break;case 2:n.left=n.right=s(t[1],e),n.top=n.bottom=s(t[0],e);break;case 3:n.left=n.right=s(t[1],e),n.top=s(t[0],e),n.bottom=s(t[2],e);break;default:n.left=s(t[3],e),n.top=s(t[0],e),n.right=s(t[1],e),n.bottom=s(t[2],e)}return n}var r=t.create,o=(t.pixel_unit=e).unit=r(null),a=(t.pixel=i).cache=r(null),h=r(null),l=(t.pixel_sides=n).cache=r(null),f=r(null);o.em=o.rem=12,o.ex=6,o.pc=16,o.px=1,o.pt=4/3,o.mm=(o.cm=96/2.54)/10,o["in"]=96}(flyingon),flyingon.dom_test(function(t){var e=flyingon.pixel_unit.unit;t.innerHTML='<div style="position:absolute;left:-10000in;"></div><div style="position:absolute;overflow:scroll;left:-10000em;top:-10000ex;width:100px;height:100px;"><div style="width:200px;height:200px;"></div></div>',e.px=1,e.pt=(e.pc=(e["in"]=-t.children[0].offsetLeft/1e4)/6)/12,e.mm=(e.cm=e["in"]/2.54)/10,t=t.children[1],e.em=e.rem=-t.offsetLeft/1e4,e.ex=-t.offsetTop/1e4,flyingon.vscroll_width=t.offsetWidth-t.clientWidth,flyingon.hscroll_height=t.offsetHeight-t.clientHeight}),flyingon.MouseEvent=flyingon.Event.extend(function(){this.init=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,(this.which=t.which)||(this.which=1&t.button?1:2&t.button?3:2),this.clientX=t.clientX,this.clientY=t.clientY}}),flyingon.KeyEvent=flyingon.Event.extend(function(){this.init=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.which=t.which||t.charCode||t.keyCode}}),flyingon.Ajax=flyingon.Async.extend(function(){function t(t,i,n,s){var r,o=t.xhr=new XMLHttpRequest;if(n.start&&(i=i+n.start+n.join("&")),t.CORS&&("withCredentials"in o?o.withCredentials=!0:(r=window.XDomainRequest)&&(o=new r)),(r=t.timeout)>0&&(t.__timer=setTimeout(function(){o.abort(),t.fail("timeout")},r)),o.onreadystatechange=function(){e(t,o,i)},o.open(t.method,i,t.async),r=t.header)for(var a in r)o.setRequestHeader(a,r[a]);o.setRequestHeader("Content-Type",t.contentType),s&&(s=flyingon.encode(s),o.setRequestHeader("Content-Length",s.length)),o.send(s)}function e(t,e,n){var s=e.readyState;if(4===s){if((s=t.__timer)&&(clearTimeout(s),t.__timer=0,s=void 0),e.status<300)try{switch(t.dataType){case"json":t.resolve(flyingon.parseJSON(e.responseText));break;case"xml":t.resolve(e.responseXML);break;default:t.resolve(e.responseText)}}catch(r){t.reject(r)}else t.reject(s=e.statusText);i(t,n,s),t.xhr=t.onreadystatechange=null}else t.notify(s)}function i(t,e,i){var n=flyingon.Ajax.end;if(n)for(var s=0,r=n.length;s<r;s++)n[s].call(t,e,i)}function n(t,e,s){var r=n,o=r.cache||(r.cache=[]),a=o.pop()||"flyingon_callback"+(++r.id||(r.id=1));window[a]=function(n){t.resolve(n),i(t,e)},s.push(t.jsonp||"jsonp","=",a),t.version||s.push("jsonp-version="+(++r.version||(r.version=1))),flyingon.script(e=e+s.start+s.join("&"),function(n,s){o.push(a),s&&(t.reject(s),i(t,e,s)),window[a]=void 0,this.parentNode.removeChild(this),t=null})}function s(t,e,i,n){function s(){h?(this.contentWindow.location="about:blank",a(t,e,this.contentWindow.name),r(this),flyingon.dom_off(this,"load",s),t=l=i=n=null):(h=1,this.contentWindow.name=this.name,o(this,e,n,t.method))}var h,l=r();i.push("jsonp=post"),e=e+i.start+i.join("&"),flyingon.dom_on(l,"load",s),l.src="about:blank",document.head.appendChild(l)}function r(t){var e=r.cache||(r.cache=[]);return t?(e.push(t),void t.parentNode.removeChild(t)):(t=e.pop(),t||(t=document.createElement("iframe"),t.name="jsonp-iframe"),t)}function o(t,e,i,n){var s=['<form id="form" enctype="application/x-www-form-urlencoded"'];s.push(' action="',e,'" method="',"GET",'">');for(var r in i)s.push('<input type="hidden" name="',r,'"'),"string"==typeof(r=i[r])&&(r=r.replace(/"/g,'\\"')),s.push(' value="',r,'" />');s.push("</form>","<script>form.submit();</script>"),t.contentWindow.document.write(s.join(""))}function a(t,e,n){try{t.resolve(flyingon.parseJSON(n)),i(t,e)}catch(s){t.reject(s),i(t,e,s)}}this.url="",this.version="",this.method="GET",this.dataType="text",this.contentType="application/x-www-form-urlencoded",this.header=null,this.async=!0,this.CORS=!1,this.jsonp="jsonp",this.timeout=0,this.send=function(e,i){var r,o,a,h=[];if(i)for(var l in i)"data"!==l?this[l]=i[l]:r=i[l];if(a=flyingon.Ajax.start){for(var f=0,c=a.length;f<c;f++)if(a[f].call(this,e)===!1)return!1;e=this.url}return!!(this.url=e)&&((o=/get|head|options/i.test(this.method))&&r&&(h.push(flyingon.encode(r)),r=null),a="jsonp"===this.dataType,this.version&&h.push("ajax-version=",this.version),(a||h.length>0)&&(h.start=e.indexOf("?")>=0?"&":"?"),a=a?o?n:s:t,a(this,e,h,r),this)}}),flyingon.ajaxStart=function(t){(flyingon.Ajax.start||(flyingon.Ajax.start=[])).push(t)},flyingon.ajaxEnd=function(t){(flyingon.Ajax.end||(flyingon.Ajax.end=[])).push(t)},flyingon.ajax=function(t,e){return(new flyingon.Ajax).send(t,e)},flyingon.ajaxPost=function(t,e){return e=e||{},e.method="POST",(new flyingon.Ajax).send(t,e)},flyingon.jsonp=function(t,e){return e=e||{},e.dataType="jsonp",(new flyingon.Ajax).send(t,e)},flyingon.jsonpPost=function(t,e){return e=e||{},e.dataType="jsonp",e.method="POST",(new flyingon.Ajax).send(t,e)},function(t){function e(i,n){if(i){switch(typeof i){case"string":return void e.require([e.path(i)],n);case"function":return void i.call(t,t)}if(i instanceof Array){for(var s,r=[],o=0,a=i.length;o<a;o++)(s=i[o])&&"string"==typeof s&&r.push(e.path(s));if(r.length>0)return void e.require(r,n)}}"function"==typeof n&&n.call(t,t)}function i(t,e){var i=h;if(t){t+=".";for(var n in e)i[t+n]=e[n]}else for(t in e)i[t]=e[t]}var n=t.create,s="",r=n(null),o=n(null),a=n(null),h=n(null),l=n(null),f={layout:"default",skin:"default",i18n:navigator.language||"zh-CN"};e.__root_path="",e.__base_path="",e.base=function(t){return void 0===t?e.__base_path:(t&&"string"==typeof t?("/"===t.charAt(0)?t=e.__root_path+t.substring(1):t.indexOf("://")<0&&(t=e.__root_path+t),"/"!==t.charAt(t.length-1)&&(t+="/")):t=e.__root_path,void(e.__base_path=t))},e.version=function(t,e){if("string"==typeof t?s=t:e=t,e){var i=r;for(var n in e)i[n]=e[n]}},e.merge=function(t){if(t){var e,i=a;for(var n in t)if("string"==typeof(e=t[n]))i[e]=n;else for(var s=0,r=e.length;s<r;s++)i[e[s]]=n}},e.path=function(t){var i,n,h,c,u=t=a[t]||t;if(c=o[u])return c;if((h=t.indexOf("{"))>=0&&(c=t.indexOf("}"))>h&&(n=t.substring(h+1,c))&&(c=f[n])){if(u=t.replace("{"+n+"}",c),c=o[u])return c}else i=!1;return c=(c=r[t]||s)?u+(t.indexOf("?")>=0?"&":"?")+"require-version="+c:u,"/"===t.charAt(0)?c=e.__root_path+c.substring(1):t.indexOf("://")<0&&(c=e.__base_path+c),i!==!1&&((l[n]||(l[n]={}))[c]=t),o[u]=c},e.key=function(t,i,n,s){var r=f;return i?void(i&&r[t]!==i&&(r[t]=i,s&&s(),(r=l[t])&&e.__change(r,t,n))):r[t]},t.skin=function(t){return e.key("skin",t)},t.i18ntext=function(t,e){return h[t]||(null!=e?e:t)},t.i18n=function(t,s){if(s&&"object"==typeof s)i(t,s);else{if("object"!=typeof t)return e.key("i18n",t,null,function(){h=n(null),"function"==typeof s&&s()});i(null,t)}},t.require=e}(flyingon),function(t){function e(e){for(var n,s=l,r=0,o=e.length;r<o;r++)s[n=e[r]]||(s[n]=1,c++,t.script(n,i))}function i(){var t=l,i=f,r=u,o=--c,a=this.src,d=r.indexOf(a);d>=0&&r.splice(d,1),r.length>0?(u=[],t[a]=2,r.src=a,e(r)):(t[a]=3,n(t,i,a)),o||(s(t,i),h.wait&&(h.wait(),h.wait=null))}function n(e,i,s){var r,o,a,h=i[s];if(delete i[s],h){for(var l=h.length-1;l>=0;l--)if(r=h[l],(a=r.indexOf(s))>=0&&r.splice(a,1),!(r.length>0)&&(h.splice(l,1),(a=r.src)&&(e[a]=3,(o||(o=[])).push(a)),a=r.callback)){r.callback=null;for(var f=0,c=a.length;f<c;f++)a[f++].apply(t,a[f])}if(o)for(var l=0,c=o.length;l<c;l++)n(e,i,o[l])}}function s(t,e){var i,s,o=[];for(i in e)o.push(i);for(var a=o.length-1;a>=0;a--)if((s=e[i=o[a]])&&r(e,s,i))for(var h=a;h>=0;h--)if(s=e[o[h]])for(var l=s.length-1;l>=0;l--)if(s[l]&&s[l].src===i){n(t,e,i);break}}function r(t,e,i){for(var n,s,o=e.length-1;o>=0;o--)if((s=e[o])&&(n=s.src)){if(n===i)return!0;if((s=t[n])&&r(t,s,i))return!0}}function o(e,i,n){var s={},r=[];if(i.replace(/<(script|template|style)([^>]*)>\s*([\s\S]*?)\s*<\/\1>/gm,function(e,i,n,o){switch(i){case"template":(n=n.match(/id="([^"]+)"|'([^']+)'/))&&(s["#"+(n[1]||n[2])]=o.replace(/[\r\n]+\s*/gm,"").replace(/(['"])/gm,"\\$1"));break;case"link":(n=n.match(/href="([^"]+)"|'([^']+)'/))&&t.link(n[1]||n[2]);break;case"style":t.style(o);break;case"script":(n=n.match(/src=("[^"]"|'[^']')/))?r.push("flyingon.require(",n[1],");\n"):r.push("flyingon.defineModule(function () {\n\n\n\n",o,"\n\n\n\n});\n\n")}}),r.length>0){r.push("\n\n//# sourceURL=",e),i=r.join("");for(var o in s)i=i.replace(new RegExp(o,"gm"),s[o]);t.globalEval(i)}t.require.done(n)}var a=t.create,h=t.require,l=a(null),f=a(null),c=0,u=[];h.__root_path=h.__base_path=t.absoluteUrl("/"),h.__change=function(t,e,i){for(var n,s=document.getElementsByTagName("skin"===e?"link":"script"),r=s.length-1;r>=0;r--)(n=s[r])&&t[n.src||n.href]&&n.parentNode.removeChild(n);s=[];for(n in t)t[n]&&(s.push(h.path(t[n])),l[n]=0);h.require(s,i||function(){})},h.callback=function(e,i){var n=u;if(n&&n.length>0)return(n.callback||(n.callback=[])).push(e,i||[t]),!0},h.require=function(i,n){var s,r,o,a,h=l,c=f;s=n?[]:u;for(var d=0,_=i.length;d<_;d++)(r=i[d])&&3!==(a=h[r])&&(r.indexOf(o||".css")>0?a||(h[r]=3,t.link(r)):s[r]||(s[r]=!0,s.push(r),(c[r]||(c[r]=[])).push(s)));n&&(s.length>0?(s.callback=[n,[t]],e(s)):n.call(t,t))},h.done=function(t){c>0?h.wait=t:t()},t.load=function(e,i){e&&(e.indexOf(".js")>0?t.require(e,i):t.ajax(t.require.path(e)).done(function(t){t&&o(e,t,i)}).fail(function(t){console&&console.error(t)}))}}(flyingon),function(){function t(e,s){var r=i[e];return r?void(r instanceof Array?s&&r.push(s):s&&s(r)):(n.push(e,s),void(n.length>2||(r=i[e]=[],s&&r.push(s),flyingon.__load_plugin=function(t){i[e]=t},flyingon.load(e,function(){var s=i[e],o=r;if(flyingon.__load_plugin=null,n.splice(0,2),s instanceof Array)throw i[e]=null,'"'+e+'" not include any flyingon.Plugin!';for(var a=0,h=o.length;a<h;a++)o[a](s);(o=n).length>0&&t(o.shift(),o.shift())}))))}function e(t){var i,n,r=e.host,o=r&&r.selectedPage(),a=o&&o.url;if(!r)throw"must use flyingon.route.init set route host!";if("string"==typeof t)if(a=t.replace(/^[#!]+/g,""),n=e.find){if(!(t=n(a)))return}else t={};else{if(!(a=t&&t.url))throw"route url can not empty!";a=a.replace(/^[#!]+/g,"")}switch(n=r.header()?t.target:"_self"){case"_blank":n=null;break;case"_self":if((i=r.selectedPage())&&i.url===a)return;n=null;break;default:if((i=r.findByKey(n))&&i.url===a)return void(i.selected()||(r.selectedPage(i),i.route.update(),i[0].openPlugin(i.route.next(),!1)))}i?(i[0].closePlugin(),i.clear()):r.push(i=(new flyingon.TabPage).layout("fill")),n&&i.key(n),(new s).load(e.current=i,a,t)}var i=flyingon.create(null),n=[];e.preload=function(e){e&&(e=e.replace(/^[#!]+/g,""))&&t(e.split("#")[0])},e.init=function(t,i){if(!(t instanceof flyingon.Tab))throw"route host must be a flyingon.Tab control!";e.host=t,e.find=i,e.__init(t)},flyingon.route=e;var s=Object.extend(function(){this.plugin="",this.load=function(i,n,s){var r;i.route=this,e.__update(i.url=this.url=n),0===n.indexOf("iframe:")?n=n.substring(7):(this.parse(n),(r=s.icon)&&i.icon(r),(r=s.text)?i.text(r):i.parent.header(0),i.closable(s.closable!==!1),i.parent.selectedPage(i),r=this,t(this.plugin,function(t){var e,n=r;i.push(e=new t),e.loadPlugin(n=n.next()),e.openPlugin(n,!0),i=r=null,flyingon.__delay_update()}))},this.parse=function(t){var e,i=t.split("#"),n=this;this.plugin=i[0];for(var s=1,o=i.length;s<o;s++)(e=i[s])&&(n=n.__next=new r(this,e))},this.next=function(){return this.__next||(this.__next=new r(this,""))},this.update=function(){for(var t,i=this.plugin,n=this;(n=n.__next)&&(t=n.value);)i+="#"+t;e.__update(i)}},!1),r=Object.extend(function(){this.value="",this.init=function(t,e){this.__root=t,this.value=e},this.change=function(t){this.value=""+t,this.__root.update()},this.clear=function(){this.__next=null,this.__root.update()},this.next=function(){return this.__next||(this.__next=new r(this.__root,""))},this.dispatch=function(t){var e;if(t)if(e=t.subscribeRoute)e.call(t,this);else for(var i=0,n=t.length;i<n;i++)(e=t[i].subscribeRoute)&&e.call(t[i],this)}},!1)}(),function(){function t(){location.hash!==i&&flyingon.route(i=location.hash)}function e(){t(),setTimeout(e,200)}var i=location.hash;i&&flyingon.route.preload(i),this.__init=function(n){i&&flyingon.route(i),n.on("tab-change",function(t){if(t.target===this){var e=flyingon.route.current=t.newValue;e?e.route.update():location.hash=i=""}}),"onhashchange"in window?flyingon.dom_on(window,"hashchange",t):setTimeout(e,200)},this.__update=function(t){location.hash=i=t?"#!"+t:""}}.call(flyingon.route),function(){function t(t,n){for(var s,r,o,a=flyingon.Selector_node,h=" ";o=t[n++];)switch(o){case"#":case".":r=new a(h,o,t[n++],r),h="";break;case"*":r=new a(h,"*","*",r),h="";break;case" ":case"\t":h||(h=" ");break;case">":case"+":case"~":h=o;break;case",":r&&(s=s||new flyingon.Selector_nodes,s[s.length++]=r.top),r=null,h=" ";break;case"[":r&&!h||(r=new a(h,"*","*",r),h=""),n=e(r,t,n);break;case":":r&&!h||(r=new a(h,"*","*",r),h=""),o=new flyingon.Selector_pseudo(r,t[n++]),"("===t[n]&&(n=i(o,t,++n));break;default:r=new a(h,"",o,r),h=""}return s?(r&&(s[s.length++]=r.top),s):r&&r.top||r}function e(t,e,i){for(var n,s,r;s=e[i++];)switch(s){case"]":return i;case"*":case"^":case"$":case"~":case"|":n&&(n.relation=s);break;case"=":n&&(n.relation+="=");break;case" ":case"\t":break;default:if(n){switch(s){case"undefined":s=void 0;break;case"null":s=null;break;case"true":s=!0;break;case"false":s=!1;break;default:s='"'===(r=s.charAt(0))||"'"===r?s.substring(1,s.length-1):+s}n.value=s}else n=new flyingon.Selector_property(t,s)}return i}function i(t,e,i){for(var n,s=i,r=1;r&&(n=e[i++]);)switch(n){case"(":r++;break;case")":r--}switch(n=e.slice(s,i-1).join(""),t.name){case"eq":case"gt":case"lt":n|=0}return t.value=n,i}var n=flyingon.create(null);flyingon.__parse_selector=function(e,i){return e&&"string"==typeof e?i!==!1&&(i=n[e])?i:(i=e.match(/"[^"]*"|'[^']*'|[\w-]+|[*.#\[\]:(), \t>+~=|^$]/g),n[e]=t(i,0)):null}}(),flyingon.Selector_node=Object.extend(function(){this.init=function(t,e,i,n){this.find=this[this.relation=t],this.filter=this[this.type=e],this.name=i,n?(t?n.next=this:n[n.length++]=this,this.top=n.top||n):this.top=this},this.relation="",this.type="",this.name="",this.length=0,this.next=null,this.select=function(t){var e,i;if(t=this.find(t),t[0]){for(e=0;i=this[e++];)t=i.filter(t);t[0]&&(i=this.next)&&(t=i.select(t))}return t},this.check=function(t){for(var e,i=0;e=this[i++];)if(!(t=e.filter(t,[])).length)return t;return(e=this.next)?e.find(t):t},this[""]=function(t,e){var i=this.name;return i?flyingon.__find_type(t,i):[]},this["*"]=function(t,e){return t},this["."]=function(t,e){var i=this.name;return i?flyingon.__find_class(t,i):[]},this["#"]=function(t,e){var i=this.name;return i?flyingon.__find_id(t,i):[]},this[" "]=function(t){for(var e,i,n,s=0;i=t[s++];)i.length>0&&i.all&&(n=i.all(),e?n.push.apply(e,n):e=n);return e&&e[0]?this.filter(e,1):e||[]},this[">"]=function(t){for(var e,i=0,n=[];e=t[i++];)e.length>0&&n.push.apply(n,e);return n[0]&&this.filter(n,2)||n},this["+"]=function(t){for(var e,i=[],n=0,s=0;e=t[n++];)(e=e.nextSibling)&&(i[s++]=e);return i[0]?this.filter(i):i},this["~"]=function(t){for(var e,i=[],n=0,s=0;e=t[n++];)for(;e=e.nextSibling;)i[s++]=e;return i[0]?this.filter(i):i}},!1),flyingon.Selector_nodes=Object.extend(function(){this.type=",",this.length=0,this.select=function(t,e){var i,n,s=1;if(n=this[0])for(e=n.select(t,e);n=this[s++];)i=n.select(t,[]),i.length>0&&e.push.apply(e,i);return e}},!1),flyingon.Selector_property=Object.extend(function(){this.init=function(t,e){this.name=e,t[t.length++]=this},this.type="[]",this.name="",this.relation="",this.value="",this.filter=function(t){var e,i=[],n=this.name;return n&&(e=this[this.relation])&&e.call(this,t,n,i,0),i},this[""]=function(t,e,i,n){for(var s,r=0;s=t[r++];)void 0!==s[e]&&(i[n++]=s)},this["="]=function(t,e,i,n){for(var s,r,o=this.value,a=0;s=t[a++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),r===o&&(i[n++]=s))},this["*="]=function(t,e,i,n){for(var s,r,o=this.value,a=0;s=t[a++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),r=""+r,r.indexOf(o)>=0&&(i[n++]=s))},this["^="]=function(t,e,i,n){for(var s,r,o=this.value,a=0;s=t[a++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),r=""+r,0===r.indexOf(o)&&(i[n++]=s))},this["$="]=function(t,e,i,n){for(var s,r,o=this.value,a=o.length,h=0;s=t[h++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),r=""+r,r.lastIndexOf(o)===r.length-a&&(i[n++]=s))},this["~="]=function(t,e,i,n){for(var s,r,o=this.regex||(this.regex=new RegExp("(?:^|s+)"+this.value+"(?:s+|$)")),a=0;s=t[a++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),o.text(r)&&(i[n++]=s))},this["|="]=function(t,e,i,n){for(var s,r,o=this.regex||(this.regex=new RegExp("\b"+this.value+"\b")),a=0;s=t[a++];)void 0!==(r=s[e])&&("function"==typeof r&&(r=r.call(s)),o.text(r)&&(i[n++]=s))}},!1),flyingon.Selector_pseudo=Object.extend(function(){this.init=function(t,e){this.name=e,t[t.length++]=this},this.type=":",this.name="",this.value=0,this.filter=function(t){var e,i=[],n=this.name;return n&&(e=this[n])&&e.call(this,t,i,0),i},this.active=function(t,e,i){},this.disabled=function(t,e,i){for(var n,s=0;n=t[s++];)(n.__storage||n.__defaults).disabled&&(e[i++]=n)},this.enabled=function(t,e,i){for(var n,s=0;n=t[s++];)(n.__storage||n.__defaults).disabled||(e[i++]=n)},this.checked=function(t,e,i){for(var n,s=0;n=t[s++];)(n.__storage||n.__defaults).checked&&(e[i++]=n)},this.has=function(t,e,i){var n=this.value;return n&&(n=flyingon.__parse_selector(n)),t},this.not=function(t,e,i){},this.empty=function(t,e,i){for(var n,s=0;n=t[s++];)n.length<=0&&(e[i++]=n)},this.only=function(t,e,i){for(var n,s=0;n=t[s++];)1===n.parent.length&&(e[i++]=n)},this.first=function(t,e,i){for(var n,s=0;n=t[s++];)(n=n.parent[0])&&(e[i++]=n)},this.last=function(t,e,i){for(var n,s=0;n=t[s++];)n.nextSibling||(e[i++]=n)},this.odd=function(t,e,i){for(var n,s=(this.value,0);n=t[s++];)1&n.index()||(e[i++]=n)},this.even=function(t,e,i){for(var n,s=(this.value,0);n=t[s++];)1&n.index()&&(e[i++]=n)},this.eq=function(t,e,i){for(var n,s=this.value,r=0;n=t[r++];)n.index()===s&&(e[i++]=n)},this.gt=function(t,e,i){for(var n,s=this.value,r=0;n=t[r++];)n.index()>s&&(e[i++]=n)},this.lt=function(t,e,i){for(var n,s=this.value,r=0;n=t[r++];)n.index()<s&&(e[i++]=n)}},!1),flyingon.Query=Object.extend(function(){var t=flyingon.__parse_selector;this.length=0,this.init=function(e,i){var n,s,r,o,a,h;if(i&&(h=t(e))&&(n=h.select(i))&&(o=n.length)>0){r=this.length,a=flyingon.create(null);for(var l=0;l<o;l++)(s=n[l])&&(h=s.__uniqueId||s.uniqueId())&&!a[h]&&(a[h]=!0,this[r++]=s)}},this.find=function(t){var e=new this.Class(t,this);return e.previous=this,e},this.children=function(t,e,i){},this.end=function(){return this.previous||this},this.on=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.on(t,e);return this},this.once=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.once(t,e);return this},this.off=function(t,e){for(var i,n=0;i=this[n++];)i.off(t,e);return this},this.trigger=function(t){if(t)for(var e,i=0;e=this[i++];)e.trigger.apply(e,arguments);return this},this.hasClass=function(t){var e;return!(!t||!(e=this[0]))&&e.hasClass(t)},this.addClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.addClass(t);return this},this.removeClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.removeClass(t);return this},this.toggleClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.toggleClass(t);return this}},!1),function(){function t(t){var e=+t;return e===e?a[t]=(0|e)+"px":a[t]=t?t.replace(/(\d+)(\s+|$)/g,"$1px$2"):""}function e(){var t,e,i=_,n=0;for(flyingon.__update_patch();t=i[n++];)t.__delay_update=!1,t.__update_dirty&&(e=t.view)&&(e=e.parentNode)?t.renderer.__update_top(t,e.clientWidth,e.clientHeight):t.update();i.length=c=0}function i(t){var e,r,o=t.__parent;if(o=o&&i(o)||n,r=t.__name)return e=flyingon.create(o),t.call(e,o),s[r]=e}flyingon.rtl=!1;var n=this,s=flyingon.create(null),r=flyingon.__uniqueId,o=document.createElement("div"),a=flyingon.create(null),h=flyingon.css_map(!0),l=flyingon.css_map(),f={32:["minWidth","min-width"],64:["maxWidth","max-width"],128:["minHeight","min-height"],256:["maxHeight","max-height"]};this.__scroll_html='<div style="position:static;overflow:hidden;visibility:hidden;margin:0;border:0;padding:0;" tag="scroll"></div>',this.__text_name="textContent"in document.head?"textContent":"innerText",this.__auto_size=!0,this.__no_border=!1,this.__no_padding=!0,this.padding=1,this.checkBoxModel=function(t){var e=t.style;flyingon.pixel;return e.width=e.height="100px",e.padding="2px",e.overflow="scroll",this.__no_border=100!==t.offsetWidth},flyingon.dom_test(function(t){t.innerHTML='<div class="f-control"><div>',this.checkBoxModel(t.children[0])},this),this.createView=function(t,e){var i,n,s=o;return this.render(n=[],t),s.innerHTML=n.join(""),i=s.firstChild,s.removeChild(i),s.innerHTML="",e===!1||(n=i.style).position||(n.position="relative"),this.mount(t,i),i},this.render=function(t,e){t.push("<div"),this.renderDefault(t,e),t.push("></div>")},this.renderDefault=function(e,i,n,s){var r,o=i.__storage||i.__defaults,h=flyingon.html_encode,l=i.__as_html;i.hasRender=!0,(r=o.id)&&e.push(' id="',h(r),'"'),e.push(' class="',h(i.fullClassName),l?" f-html":" f-absolute",n?" "+n:"",'" style="'),s&&e.push(s),(r=i.__style)&&this.__render_style(e,i,r,h),(r=i.__location_dirty)&&(i.__location_dirty=0,l&&this.__render_location(e,i,r)),(r=o.border)&&e.push("border-width:",a[r]||t(r),";"),(r=o.padding)&&this.padding&&e.push("padding:",a[r]||t(r),";"),o.visible||e.push("display:none;"),e.push('"'),(r=i.__view_patch)&&this.__render_patch(e,i,r,h)},this.__render_style=function(t,e,i,s){var r,o,a=h;for(var l in i)if("cssText"!==l&&""!==(r=i[l]))switch(o=this[l]){case 1:t.push(l,":",s(r),";");break;case 2:t.push(a[l],":",s(r),";");break;case 9:(e.__style_patch||(e.__style_patch={}))[l]=r;break;default:if("function"!=typeof o){if(o=a[l]){t.push(o,":",s(r),";"),n[l]=o===l?1:2;break}n[l]=9}(o=e.__style_patch)||(o=e.__view_patch||(e.__view_patch={}),o=o.__style_patch=u.__style_patch={}),o[l]=r}},this.__render_patch=function(t,e,i,n){var s,r;for(var o in i)this[o]?s=!0:(((r=i[o])||0===r)&&t.push(" ",o,'="',n(""+r),'"'),i[o]=null);s||(e.__view_patch=null)},this.__render_location=function(e,i,n){for(var s,r,o,h=i.__storage||i.__defaults,l=1;n>=l;){if(n&l)switch(l){case 1:case 2:(r=h[s=1===l?"width":"height"])&&("default"===r||"auto"===r?e.push(s,":auto;"):e.push(s,":",r>=0?r+"px":r,";"));break;case 4:(r=h.margin)&&e.push("margin:",a[r]||t(r),";");break;case 8:(r=h.border)&&e.push("border-width:",a[r]||t(r),";");break;case 16:this.padding&&(r=h.padding)&&e.push("padding:",a[r]||t(r),";");break;case 32:case 64:case 128:case 256:o=f[l],(r=h[o[0]])&&e.push(o[1],":",r>0?r+"px":r,";");break;case 512:case 1024:(r=h[s=l<1e3?"left":"top"])&&e.push(s,":",(o=+r)===o?r+"px":r,";")}l<<=1}},this.mount=function(t,e){var i=r;t.view=e,i[e.flyingon_id=t.__uniqueId||i.id++]=t,(i=t.onmount)&&i.call(t,e),(i=t.__view_patch)&&(t.__view_patch=null,this.__apply_patch(t,e,i))},this.unmount=function(t){var e,i=t.view;i&&((e=t.onunmount)&&e.call(t,i),t.view=i.onscroll=null,(e=i.parentNode)&&e.removeChild(i))},this.__update_top=function(t,e,i){var n=t.view,s=n.className.indexOf(" f-rtl");t.__location_values=null,t.left=t.top=0,t.measure(e,i,e,i,i?3:1),flyingon.rtl?s<0&&(n.className+=" f-rtl"):s>=0&&(n.className=n.className.replace(" f-rtl","")),(t.__update_dirty||t.__arrange_dirty)&&this.update(t)},this.update=function(e){var i,n=e.view.style,s=e.__style_cache,r=this.__auto_size&&e.__auto_size,o=e.offsetLeft,h=e.offsetTop,l=1&r?"auto":e.offsetWidth,f=2&r?"auto":e.offsetHeight;return(i=!s)&&(s=e.__style_cache={}),(i||o!==s.left)&&(n[flyingon.rtl?"right":"left"]=(s.left=o)+"px"),(i||h!==s.top)&&(n.top=(s.top=h)+"px"),(i||l!==s.width)&&(s.width=l,1&r?n.width=l:(this.__no_border&&(l-=e.borderLeft+e.borderRight,this.__no_padding&&(l-=e.paddingLeft+e.paddingRight),l<0&&(l=0)),n.width=l+"px")),(i||f!==s.height)&&(s.height=f,2&r?n.height=f:(this.__no_border&&(f-=e.borderTop+e.borderBottom,this.__no_padding&&(f-=e.paddingTop+e.paddingBottom),f<0&&(f=0)),n.height=f+"px")),(i=e.__location_dirty)&&(e.__location_dirty=0,8&i&&(r=e.border(),n.borderWidth=a[r]||t(r)),16&i&&this.padding&&(r=e.padding(),n.padding=a[r]||t(r))),e.__update_dirty=!1,s},this.__update_position=function(t){var e,i=t.view.style,n=t.__locate_cache;n&&(n.left!==(e=t.offsetLeft)&&(i.left=(n.left=e)+"px"),n.top!==(e=t.offsetTop)&&(i.top=(n.top=e)+"px"))},this.__location_patch=function(e,i){var n,s,r,o=i.style,h=e.__storage||e.__defaults,l=e.__location_dirty,c=1;for(e.__location_dirty=0;l>=c;){if(l&c)switch(c){case 1:case 2:(s=h[n=1===c?"width":"height"])&&("default"===s||"auto"===s?o[n]="auto":o[n]=s>=0?s+"px":s);break;case 4:case 16:s=h[n=4===c?"margin":"padding"],o[n]=a[s]||t(s);break;case 8:s=h.border,o.borderWidth=a[s]||t(s);break;case 32:case 64:case 128:case 256:r=f[c],s=h[n=r[0]],o[n]=s>0?s+"px":s;break;case 512:case 1024:s=h[n=c<1e3?"left":"top"],o[n]=(r=+s)===r?s+"px":s}c<<=1}},this.visible=function(t,e,i){e.style.display=i?"":"none"},this.focus=function(t){t.view.focus()},this.blur=function(t){t.view.blur()},this.detach=function(t,e){var i=e.parentNode;i&&i.removeChild(e)},this.detachAll=function(t,e){var i;for(e=t.view_content||e;(i=e.firstChild)&&i.flyingon_id;)e.removeChild(i)};var c,u=[],d=[],_=[];flyingon.__delay_update=function(t){var i=_;t?t.__delay_update||(t.__delay_update=!0,i.push(t),c||(c=setTimeout(e,0))):e()},flyingon.__update_patch=function(){for(var t,e,i,n=d,s=0;t=n[s++];)(i=t.__remove_patch)&&(t.__remove_patch=null,t.renderer.__remove_patch(t,i)),t.__insert_patch&&(t.__insert_patch=!1,t.renderer.__insert_patch(t,t.view,0,t.length));for(n=u,s=0;t=n[s++];)(i=t.__view_patch)&&(e=t.view)&&(t.__view_patch=null,t.renderer.__apply_patch(t,e,i));d.length=u.length=0},this.set=function(t,i,n){var s=t.__view_patch;s?s[i]=n:((t.__view_patch={})[i]=n,u.push(t),t.view&&(c||(c=setTimeout(e,0))))},this.__apply_patch=function(t,e,i){var n,s;for(var r in i)null!==(s=i[r])&&((n=this[r])?"function"==typeof n&&n.call(this,t,e,s):s||0===s?e.setAttribute(r,s):e.removeAttribute(r))},this.__style_patch=function(t,e,i){var s,r=l,o=e.style;t.__style_patch=null;for(var a in i)switch(s=this[a]){case 0:break;case 1:o[a]=i[a];break;case 2:o[r[a]]=i[a];break;case 9:flyingon.css_value(e,a,i[a]);break;default:"function"!=typeof s?(s=r[a])?(o[s]=i[a],n[a]=s===a?1:2):(flyingon.css_value(e,a,i[a]),n[a]=9):s.call(this,t,e,i[a])}},this.__render_children=function(t,e,i,n){for(var s;i<n;)(s=e[i++])&&(s.view||s.renderer.render(t,s))},this.__mount_children=function(t,e,i,n){for(var s,r;s=t[i++];)(r=s.view)?e.insertBefore(r,n):(s.renderer.mount(s,n),n=n.nextSibling)},this.__unmount_children=function(t,e){for(var i=t.length-1;i>=0;i--){var n=t[i];!n||!n.view||e&&n.parent||n.renderer.unmount(n)}},this.__arrange=function(t){var e,i,n,s=[],r=t.__style,o=t.__auto_size;if(1&o)t.__hscroll=!1;else switch(r&&(r["overflow-x"]||r.overflow)){case"scroll":t.__hscroll=!0;break;case"hidden":t.__hscroll=!1;break;default:e=!0}if(2&o)t.__vscroll=!1;else switch(r&&(r["overflow-y"]||r.overflow)){case"scroll":t.__vscroll=!0;break;case"hidden":t.__vscroll=!1;break;default:i=!0}for(var a=0,h=t.length;a<h;a++)(n=t[a])&&(n.__storage||n.__defaults).visible&&s.push(n);flyingon.arrange(t,s,e,i),this.__sync_scroll(t),t.__arrange_dirty=0},this.__sync_scroll=function(t){var e=(t.view_content||t.view).style;e.overflowX=t.__hscroll?"scroll":"hidden",e.overflowY=t.__vscroll?"scroll":"hidden"},this.__update_children=function(t,e,i){for(var n;e<i;)(n=t[e++])&&n.view&&n.renderer.update(n)},this.__children_dirty=function(t){d.push(t),c||(c=setTimeout(e,0))},this.__insert_patch=function(t,e,i,n){for(var s,r,o=(e=t.view_content||e).lastChild||null,a=-1,h=n-1;h>=i;h--)(s=t[h])&&((r=s.view)?(r.parentNode!==e&&e.insertBefore(r,o||null),a>0&&(this.__unmount_html(t,e,h+1,a,o),a=-1),o=r):a<0&&(a=h+1));a>0&&this.__unmount_html(t,e,i,a,o)},this.__unmount_html=function(t,e,i,n,s){var r,o=[],a=s&&s.previousSibling;for(this.__render_children(o,t,i,n),flyingon.dom_html(e,o.join(""),s),a=a&&a.nextSibling||e.firstChild;i<n;)r=t[i++],r.renderer.mount(r,a),a=a.nextSibling},this.__remove_patch=function(t,e){for(var i,n,s,r=0;i=e[r++];)(n=i.parent)!==t&&(s=i.view,n||!i.autoDispose?(n=s&&s.parentNode)&&n.removeChild(s):(i.renderer.unmount(i),i.dispose()))},this.__view_order=function(t,e){var i,n,s,r;e=t.view_content||e,(n=e.lastChild)&&"scroll"===n.getAttribute("tag")&&(r=n,n=n.previousSibling);for(var o=t.length-1;o>=0;o--)(i=t[o])&&(s=i.view)&&(s!==n&&e.insertBefore(s,r||null),n=(r=s).previousSibling)},this.dispose=function(t,e){var i=e.parentNode;i&&i.removeChild(e),this.unmount(t),e.innerHTML=""},flyingon.renderer=function(t,e,i){if(!t)throw"renderer name not allow empty!";if("function"==typeof e)i=e,e="";else if("function"!=typeof i)return;e&&(e=s[e])&&(i.__parent=e),s[i.__name=t]=i},flyingon.renderer.bind=function(t,e){var r=s[e];r&&"function"==typeof r&&(r=i(r)),r?t.renderer=r:t.renderer||(t.renderer=n)}}.call(flyingon.create(null)),flyingon.renderer("HtmlElement",function(t){this.__scroll_html="",this.render=function(t,e){var i,n=e.__storage||e.__defaults,s=e.tagName;e.__content_render=!0,t.push("<",s),this.renderDefault(t,e),t.push(">"),(i=n.text)?(n.html||(i=flyingon.html_encode(i)),t.push(i)):e.length>0&&e.__visible&&this.__render_children(t,e,0,e.length),t.push("</",s,">")},this.mount=function(e,i){t.mount.call(this,e,i),e.__content_render&&this.__mount_children(e,i,0,i.firstChild),i.onscroll=flyingon.__dom_scroll},this.unmount=function(e){e.view.onscroll=null,this.__unmount_children(e),t.unmount.call(this,e)},this.update=function(e){t.update.call(this,e),e.length>0&&e.arrange()?this.__arrange(e):e.__arrange_dirty=0},this.__arrange=function(t){var e,i,n,s=flyingon.HtmlElement;e=t.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight,i=t.offsetHeight-t.borderTop-t.borderBottom-t.paddintTop-t.paddingBottom;for(var r=0,o=t.length;r<o;r++)!(n=t[r])||n instanceof s||n.measure(e,i,e,i);t.__arrange_dirty=0},this.__measure_auto=function(t,e){var i=t.view;2&e&&(t.__content_render&&this.update(t),t.offsetHeight=i&&i.offsetHeight||0)},this.text=function(t,e,i){t.html()?e.innerHTML=i:e[this.__text_name]=i}}),flyingon.renderer("Label",function(t){this.render=function(t,e){var i=e.__storage||e.__defaults,n=i.text;n&&!i.html&&(n=flyingon.html_encode(n)),t.push("<span"),this.renderDefault(t,e),t.push(">",n,"</span>")},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.text=function(t,e){var i=t.__storage||t.__defaults;i.html?e.innerHTML=i.text:e[this.__text_name]=i.text}}),flyingon.renderer("Button",function(t){this.render=function(t,e){t.push('<button type="button"'),this.renderDefault(t,e),t.push(">"),this.__render_content(t,e),t.push("</button>")},this.__render_content=function(t,e){var i,n=flyingon.html_encode,s=e.__storage||e.__defaults;(i=s.icon)&&(t.push('<span class="',n(i),'" style="width:',i=s.iconSize,"px;height:",i,'px;">',"</span>"),i=!0),(i=s.text)&&(i&&s.vertical&&t.push("<br/>"),s.html||(i=n(i)),t.push("<span>",i,"</span>"))},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.icon=this.iconSize=this.vertical=function(t,e,i){var n=[];this.__render_content(n,t),e.innerHTML=n.join("")},this.text=this.html=function(t,e){var i=t.__storage||t.__defaults;i.html?e.lastChild.innerHTML=i.text:e.lastChild[this.__text_name]=i.text}}),flyingon.renderer("LinkButton",function(t){this.render=function(t,e){var i,n=e.__storage||e.__defaults;t.push('<a type="button"'),this.renderDefault(t,e),(i=n.href)&&t.push(' href="',flyingon.html_encode(i),'"'),t.push(">"),(i=n.text)&&(n.html||(i=flyingon.html_encode(i)),t.push(i)),t.push("</a>")},this.__measure_auto=function(t,e){var i=t.view;1&e&&(t.offsetWidth=i&&i.offsetWidth||0),2&e&&(i.style.width=t.offsetWidth+"px",t.offsetHeight=i&&i.offsetHeight||0)},this.text=this.html=function(t,e){var i=t.__storage||t.__defaults;i.html?e.innerHTML=i.text:e[this.__text_name]=i.text},this.href=function(t,e,i){e.href=i}}),flyingon.renderer("Image",function(t){this.render=function(t,e){var i=flyingon.html_encode,n=e.__storage||e.__defaults,s=n.src,r=n.alt;s&&(s=i(s)),r&&(r=i(r)),t.push("<img"),this.renderDefault(t,e),t.push(' src="',s,'" alt="',r,'"></img>')},this.src=function(t,e,i){e.src=i},this.alt=function(t,e,i){e.alt=i}}),flyingon.renderer("Slider",function(t){function e(t){var e=flyingon.findControl(this),i=e.__storage||e.__defaults,n=e.view.offsetWidth-i.buttonSize,s=t.offsetX;void 0===s&&(s=t.clientX-e.view.getBoundingClientRect().left),s/=n,s=(i.max-i.min)*(s>1?1:s)|0,e.value(s),e.trigger("change","value",s)}function i(t){var e=flyingon.findControl(this),i=e.__storage||e.__defaults,r={control:e},o=r.size=e.view.offsetWidth-i.buttonSize,a=i.value*o/(i.max-i.min)+.5|0;t.dom=this,r.min=-a,r.max=o-a,flyingon.dom_drag(r,t,null,n,s,"y")}function n(t){var e=t.distanceX;e<this.min?t.distanceX=this.min:e>this.max&&(t.distanceX=this.max)}function s(t){var e=this.control,i=e.__storage||e.__defaults,n=t.distanceX-this.min;n=(i.max-i.min)*n/this.size|0,e.value(n),e.trigger("change","value",n)}this.render=function(t,e){t.push("<div"),this.renderDefault(t,e),t.push(">",'<div class="f-slider-bar"><div></div></div>','<div class="f-slider-button"><div></div></div>',"</div>")},this.update=function(e){t.update.call(this,e),this.refresh(e)},this.__location_patch=function(e){t.__location_patch.call(this,e),this.refresh(e)},this.mount=function(n,s){t.mount.call(this,n,s),s.firstChild.onclick=e,s.lastChild.onmousedown=i},this.unmount=function(e){var i=e.view;i.firstChild.onclick=i.lastChild.onmousedown=null,t.unmount.call(this,e)},this.refresh=function(t){var e=t.__storage||t.__defaults,i=t.view,n=i.lastChild.style,s=i.offsetWidth-e.buttonSize;n.left=(e.value*s/(e.max-e.min)|0)+"px",n.width=e.buttonSize+"px"}}),flyingon.renderer("ProgressBar",function(t){this.render=function(t,e){var i=(e.__storage||e.__defaults).value;t.push("<div"),this.renderDefault(t,e),t.push(">",'<div class="f-progressbar-back" style="width:',i,'%;"></div>','<div class="f-progressbar-text"><span>',i,"%</span></div>","</div>")},this.value=function(t,e,i){e.firstChild.style.width=i+"px",e.lastChild.firstChild[this.__text_name]=i+"%"},this.text=function(t,e,i){e.lastChild.style.display=i?"":"none"}}),flyingon.renderer("Panel",function(t){this.__auto_size=0,this.__no_padding=0,this.padding=0,this.render=function(t,e){t.push("<div"),this.renderDefault(t,e),t.push(">"),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,0,e.length)),t.push(this.__scroll_html,"</div>")},this.__render_content=function(t,e){var i=[];t.__content_render=!0,this.__render_children(i,t,0,t.length),i.push(this.__scroll_html),e.innerHTML=i.join(""),this.mount(t,e)},this.mount=function(e,i){t.mount.call(this,e,i),i=e.view_content||i,i.onscroll=flyingon.__dom_scroll,e.__content_render&&this.__mount_children(e,i,0,i.firstChild)},this.unmount=function(e){e.view=e.view_content=(e.view_content||e.view).onscroll=null,this.__unmount_children(e),t.unmount.call(this,e)},this.update=function(e){t.update.call(this,e),e.length>0&&!e.__content_render&&this.__render_content(e,e.view_content||e.view),e.__arrange_dirty>1&&(this.__arrange(e),this.__update_scroll(e)),this.__update_children(e,0,e.length)},this.__update_scroll=function(t){var e,i=(t.view_content||t.view).lastChild.style;t.__scroll_cache||(t.__scroll_cache={});t.__hscroll_length!==(e=t.arrangeRight)&&(i.width=(t.__hscroll_length=e)+"px"),t.__vscroll_length!==(e=t.arrangeBottom)&&(i.height=(t.__vscroll_length=e)+"px")}}),flyingon.renderer("GroupBox","Panel",function(t){function e(t){if(this.collapsable())for(var e=this.view,i=t.original_event.target;i!==e;)"head"===i.getAttribute("tag")&&this.collapsed(!this.collapsed()),i=i.parentNode}this.render=function(t,e){var i,n=e.__storage||e.__defaults,s=n.header,r=n.text;t.push("<div"),this.renderDefault(t,e),r&&(r=flyingon.html_encode(r)),(i=e.format)&&(r=i.call(e,r)),t.push(">",'<div class="f-groupbox-head" style="height:',s,"px;line-height:",s,"px;text-align:",n.align,';" tag="head">','<span class="f-groupbox-icon ',(i=n.icon)?i:'" style="display:none;','"></span>','<span class="f-groupbox-text">',r,"</span>",'<span class="f-groupbox-flag f-groupbox-',n.collapsed?'close"':'open"',2===n.collapsable?"":' style="display:none;"',"></span>",'<span class="f-groupbox-line"></span>',"</div>",'<div class="f-groupbox-body" style="top:',s,"px;overflow:auto;",(n.collapsed,""),'">'),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,0,e.length)),t.push(this.__scroll_html,"</div></div>")},this.mount=function(i,n){i.view_content=n.lastChild,t.mount.call(this,i,n),i.on("click",e)},this.header=function(t,e,i){e.firstChild.style.height=e.lastChild.style.top=i+"px"},this.text=function(t,e,i){e=e.firstChild.firstChild.nextSibling,t.format?(i&&(i=flyingon.html_encode(i)),e.innerHTML=t.format(i)):e[this.__text_name]=i},this.icon=function(t,e,i){e=e.firstChild.firstChild,e.className="f-groupbox-icon"+(i?" "+i:""),e.style.display=i?"":"none"},this.collapsable=function(t,e,i){e.firstChild.lastChild.style.display=2===i?"":"none"},this.collapsed=function(t,e,i){e.firstChild.lastChild.previousSibling.className="f-groupbox-flag f-groupbox-"+(i?"close":"open"),e.lastChild.style.display=i?"none":""},this.align=function(t,e,i){e.firstChild.style.textAlign=i}}),flyingon.renderer("ScrollPanel",function(t){function e(t){var e=this.view;"hidden"!==e.style.overflowY&&(e.firstChild.scrollTop-=100*t.wheelDelta/120,t.stopPropagation())}this.__auto_size=0,this.__no_padding=0,this.padding=0,this.render=function(t,e){var i=this.__scroll_html;t.push("<div"),this.renderDefault(t,e),t.push(">",'<div style="position:absolute;left:0;top:0;right:0;bottom:0;width:auto;height:auto;overflow:auto;">',i,"</div>",'<div class="f-body" style="position:relative;overflow:hidden;margin:0;border:0;padding:0;left:0;top:0;width:100%;height:100%;">',i,"</div>","</div>")},this.mount=function(i,n){t.mount.call(this,i,n),i.view_content=n.lastChild,i.view.firstChild.onscroll=flyingon.__dom_scroll,i.on("mousewheel",e)},this.unmount=function(e){e.view.firstChild.onscroll=null,this.__unmount_children(e),t.unmount.call(this,e)},this.update=function(e){var i,n,s,r=t.update.call(this,e),o=flyingon.rtl?"paddingLeft":"paddingRight";if(e.__arrange_dirty>1&&(i=e.__visible_start,n=e.__visible_end+1,this.__arrange(e),this.__update_scroll(e),e.__compute_visible(),i>=0))for(;i<=n;)(s=e[i++])&&!s.__visible_area&&this.__update_position(s);return r[o]!==(s=e.__vscroll?flyingon.vscroll_width:0)&&(e.view.style[o]=(r[o]=s)+"px"),r.paddingBottom!==(s=e.__hscroll?flyingon.hscroll_height:0)&&(e.view.style.paddingBottom=(r.paddingBottom=s)+"px"),i=e.__visible_start,n=e.__visible_end+1,i>=0&&(e.__visible_unmount&&(e.__visible_unmount=!1,this.__insert_patch(e,e.view.lastChild,i,n)),this.__update_children(e,i,n)),r},this.scroll=function(t,e,i){var n=t.view.lastChild;this.update(t),n.scrollLeft!==e&&(n.scrollLeft=e),n.scrollTop!==i&&(n.scrollTop=i)},this.__update_scroll=function(t){var e,i=t.view,n=i.firstChild.firstChild.style,s=i.lastChild.lastChild.style,r=t.__scroll_cache||(t.__scroll_cache={});n=i.firstChild.firstChild.style,r.x2!==(e=t.arrangeRight)&&(n.width=s.width=(r.x2=e)+"px"),r.y2!==(e=t.arrangeBottom)&&(n.height=s.height=(r.y2=e)+"px")},this.__sync_scroll=function(t){}}),flyingon.renderer("Splitter",function(t){function e(t){var e=t.parent,i=t.vertical;if(e&&(t=e[e.indexOf(t)-1]))return[t,i,i?t.offsetHeight:t.offsetWidth]}function i(t){var e=this[0],i=this[1],n=i?"distanceY":"distanceX";e[i?"height":"width"](this[2]+t[n]),t[n]=(i?e.offsetHeight:e.offsetWidth)-this[2]}this.render=function(t,e){t.push("<div"),this.renderDefault(t,e,"","cursor:ew-resize;"),t.push("><div></div></div>")},this.update=function(e){var i=e.offsetWidth>e.offsetHeight;t.update.call(this,e),e.vertical!==i&&(e.vertical=i,e.view.style.cursor=i?"ns-resize":"ew-resize")},this.mount=function(n,s){t.mount.call(this,n,s),n.on("mousedown",function(t){var s=e(n);s&&flyingon.dom_drag(s,t.original_event,null,i,null,s[1]?"x":"y")})}}),flyingon.renderer("ListBox",function(t){function e(t){for(var e=t.target||t.srcElement;e!==this;){var n=e.getAttribute("index");if(n)return void i(flyingon.findControl(this),this,0,0|n,!0);e=e.parentNode}}function i(t,e,i,s,r){var o,a=t.__list_type;if(r&&(i=t.__selectedIndex),"checkbox"===a)if(r)i&&(o=i.indexOf(s))>=0?(i.splice(o,1),n(e,s,!1,a)):(n(e,s,!0,a),i?i.push(s):i=[s]),s=i;else{if(i)for(var h=i.length-1;h>=0;h--)(!s||s.indexOf(i[h])<0)&&n(e,i[h],!1,a);if(s)for(var h=s.length-1;h>=0;h--)(!i||i.indexOf(s[h])<0)&&n(e,s[h],!0,a)}else{if(s===i)return;i>=0&&n(e,i,!1,a),s>=0&&n(e,s,!0,a)}r&&(t.__use_index=!0,t.__selectedIndex=s,t.trigger("change","value",t.selectedValue()))}function n(t,e,i,n){if(t=t.children[e]){var s=" f-listbox-selected",e=t.className.indexOf(s);i?e<0&&(t.className+=s,n&&(t=t.firstChild)&&(t.checked=!0)):e>=0&&(t.className=t.className.replace(s,""),n&&(t=t.firstChild)&&(t.checked=!1))}}function s(t,e,i,n,s,r){var o,a,h=n.Class||"div";t.push("<",h);for(var l in n)switch(l){case"Class":case"children":break;default:null!=(a=n[l])&&(":"===l.charAt(0)&&(l=l.substring(1),a="index"===a?i:s?e?e[s]:"":"item"===a?e:""),a&&"string"==typeof a&&(a=r(a)),"text"===l?o=a:t.push(" ",l,'="',a,'"'))}if(t.push(">"),o)t.push(o);else if(a=n.children)if(a instanceof Array)for(var f=0,c=a.length;f<c;f++)render_item(t,e,a[f]);else render_item(t,e,a);t.push("</",h,">")}this.render=function(t,e){t.push("<div"),this.renderDefault(t,e),t.push("></div>")},this.mount=function(i,n){t.mount.call(this,i,n),n.onclick=e},this.unmount=function(e){e.view.onclick=null,t.unmount.call(this,e)},this.update=function(e){t.update.call(this,e),this.content(e)},this.content=function(t){var e=t.__storage||t.__defaults,i=e.items;if(!i)return"";var n,r,o,a,h,l,f=[],c=flyingon.html_encode,u=t.__template,d=t.__list_type,_=t.selectedIndex(),p=!d&&e.clear?1:0,g=e.columns,v=e.itemHeight,y=e.displayField,m=' style="height:'+v+"px;line-height:"+v+"px;",b=flyingon.rtl?"right:":"left:",w=0,x=i.length;switch(g<=0&&(g=i.length),g>1?(l=t.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight,t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom<Math.ceil(i.length/g)*v&&(l-=flyingon.vscroll_width),n=l/g|0,m+="width:"+(n-10)+"px;"):(n=0,m+=flyingon.rtl?"left:0;":"right:0;"),d){case"radio":break;case"checkbox":r=_.length>0&&_.pair();break;default:d=null}for(!u&&(u=e.template)&&("string"==typeof u&&(u=new flyingon.view.Template(u).parse(!0)),t.__template=u=u instanceof Array?u:[u]),u&&(x=u.length);w<x;){if(o=i[w],l=w+p,g>1?(a=l%g*n,h=(l/g|0)*v):(a=0,h=l*v),l=r?r[w]:_===w,f.push('<div class="f-listbox-item',l?' f-listbox-selected"':'"',m,"top:",h,"px;",b,a,'px;" index="',w++,'">'),d&&f.push('<input type="',d,'"',l?' checked="checked"':"","/>"),u)for(var k=0,C=u.length;k<C;k++)s(f,o,w,u[k],y,c);else l=o,y&&(l=l&&l[y]||""),l&&"string"==typeof l&&(l=c(l)),f.push(l);f.push("</div>")}p&&f.push('<div class="f-listbox-item f-listbox-clear"',m,"top:0;",b,'0;" index="-1"><span>',flyingon.i18ntext("listbox.clear"),"</span></div>"),t.view.innerHTML=f.join("")}}),flyingon.renderer("CheckBox",function(t){function e(){var t=flyingon.findControl(this);t.hasRender=!1,t.checked(this.checked),t.hasRender=!0,t.trigger("change","value",this.checked)}this.render=function(t,e){t.push('<input type="radio" name="',e.name(),'"'),this.renderDefault(t,e),t.push("/>")},this.mount=function(i,n){t.mount.call(this,i,n),n.onchange=e},this.unmount=function(e){e.view.onchange=null,t.unmount.call(this,e)}}),flyingon.renderer("CheckBox",function(t){function e(){var t=flyingon.findControl(this);t.hasRender=!1,t.checked(this.checked),t.hasRender=!0,t.trigger("change","value",this.checked)}this.render=function(t,e){t.push('<input type="checkbox" name="',e.name(),'"'),this.renderDefault(t,e),t.push("/>")},this.mount=function(i,n){t.mount.call(this,i,n),n.onchange=e},this.unmount=function(e){e.view.onchange=null,t.unmount.call(this,e)}}),flyingon.renderer("TextBox",function(t){function e(){var t=flyingon.findControl(this);t.hasRender=!1,t.value(this.value),t.hasRender=!0,this.value=t.text(),t.trigger("change","value",this.value)}flyingon.dom_test(function(t){t.innerHTML='<input type="text" class="f-control f-textbox"/>',this.checkBoxModel(t.children[0])},this),this.render=function(t,e){var i=e.text();i&&(i=flyingon.html_encode(i)),t.push('<input type="text"'),this.renderDefault(t,e),t.push(' value="',i,'"/>')},this.text=function(t,e){e.value=t.text()},this.mount=function(i,n){t.mount.call(this,i,n),n.onchange=e},this.unmount=function(e){e.view.onchange=null,t.unmount.call(this,e)}}),flyingon.renderer("TextButton",function(t){function e(t){(t.target||t.srcElement).className.indexOf("f-textbutton-button")>=0&&flyingon.findControl(this).__on_click()}function i(){var t=flyingon.findControl(this),e=this.firstChild.firstChild;t.hasRender=!1,t.value(e.value),t.hasRender=!0,t.trigger("change","value",e.value)}this.render=function(t,e){var i=e.__storage||e.__defaults,n=e.text(),s=i.buttonSize;n&&(n=flyingon.html_encode(n)),t.push("<div"),this.renderDefault(t,e),t.push(">",'<div class="f-textbutton-body" style="right:',s,'px;">','<input type="text" class="f-textbutton-text" value="',n,'"/>',"</div>",'<div class="f-textbutton-button ',i.button,'" style="width:',s,'px;"></div>',"</div>")},this.text=function(t,e){e.firstChild.firstChild.value=t.text()},this.mount=function(n,s){t.mount.call(this,n,s),s.onclick=e,s.onchange=i},this.unmount=function(e){var i=e.view;i.onclick=i.onchange=null,t.unmount.call(this,e)}}),flyingon.renderer("Calendar",function(t){function e(t){var e,i=t.target||t.srcElement,r=flyingon.findControl(i),o=r.__data;switch(i.getAttribute("tag")){case"to-year":a(r,o);break;case"to-month":h(r,o);break;case"to-date":l(r,o);break;case"date-2":o[4]-=1,l(r,o);break;case"date-1":--o[5]<1&&(o[5]=12,o[4]--),l(r,o);break;case"date+1":++o[5]>12&&(o[5]=1,o[4]++),l(r,o);break;case"date+2":o[4]+=1,l(r,o);break;case"month-2":o[4]-=10,h(r,o);break;case"month-1":o[4]-=1,h(r,o);break;case"month+1":o[4]+=1,h(r,o);break;case"month+2":o[4]+=10,h(r,o);break;case"year-2":o[4]-=100,a(r,o);break;case"year-1":o[4]-=20,a(r,o);break;case"year+1":o[4]+=20,a(r,o);break;case"year+2":o[4]+=100,a(r,o);break;case"today":e=new Date,o[0]=o[4]=e.getFullYear(),o[1]=o[5]=e.getMonth()+1,o[2]=e.getDate(),n(r,o,l);break;case"clear":o[0]=o[1]=o[2]=0,s(r,null)&&l(r,o);break;case"year":o[0]=o[4]=+i.innerHTML,(r.month()?h:l)(r,o);break;case"month":o[0]=o[4],o[1]=o[5]=+i.getAttribute("value"),r.month()?n(r,o,h):l(r,o);break;case"date":i.className.indexOf("f-calendar-disabled")<0&&(e=o[5]+(0|i.getAttribute("offset")),e<1?(e=12,o[4]--):e>12?(e=1,o[4]++):o[4],o[0]=o[4],o[1]=o[5]=e,o[2]=+i.innerHTML,n(r,o,l))}}function i(t){var e=t.target||t.srcElement,i=flyingon.findControl(e),n=e.value.match(/\d+/g);e.value=i.__data[4]=n?r(n):"00:00:00"}function n(t,e,i){var n,r,o=t.__storage||t.__defaults;if(o.month?n=e[0]+"-"+e[1]:(n=e[0]+"-"+e[1]+"-"+e[2],o.time&&(r=e[3].split(":"),n+=" "+r[0]+":"+r[1]+":"+r[2]),n=new Date(n)),s(t,n))return i&&i(t,e),!0}function s(t,e){return t.value()!==e&&(t.hasRender=!1,t.value(e),t.hasRender=!0,t.trigger("change","value",e)),t.trigger("selected","value",e)!==!1}function r(t){for(var e,i=[],n=24,s=0;s<3;s++)e=(e=t[s])?e>n?n:("0"+e).substr(-2):"00",i.push(e),n=60;return i.join(":")}function o(t){var e,i=t.__storage||t.__defaults,n=t.__data;n||(e=i.value,t.__data=n=[e?e.getFullYear():0,e?e.getMonth()+1:0,e?e.getDate():0,"",(e=e||new Date).getFullYear(),e.getMonth()+1],i.time&&!i.month&&(n[3]=r([e.getHours(),e.getMinutes(),e.getSeconds()]))),i.month?h(t,n):l(t,n)}function a(t,e){var i,n,s,r,o=[],a=t.__storage||t.__defaults,h=a.min,l=a.max,_=t.oncheck;h&&(h=h.match(/\d+/g)),l&&(l=l.match(/\d+/g)),r=(c(t)-30)/4|0,n='<div style="height:'+r+"px;line-height:"+r+'px;">',i=20*(e[4]/20|0)+1,r=flyingon.i18ntext("calendar.title","Y")[0],r=r.replace("Y",i)+" - "+r.replace("Y",i+19),r='<span tag="to-'+(t.month()?'month">':'date">')+r+"</span>",f(o,e,"year",r),o.push('<div class="f-calendar-year">'),r=e[0];for(var p=0;p<4;p++){o.push(n);for(var g=0;g<5;g++)s=i===r?"f-calendar-selected ":"",(h&&u(h,i)||l&&d(l,i)||_&&_(i)===!1)&&(s+="f-calendar-disabled "),o.push('<span class="',s,'" tag="year">',i++,"</span>");o.push("</div>")}t.view.innerHTML=o.join("")}function h(t,e){var i,n,s,r,o=[],a=flyingon.i18ntext,h=t.__storage||t.__defaults,l=h.min,p=h.max,g=t.oncheck,v=a("calendar.month","")||_,y=e[4];(l=l&&l.match(/\d+/g))&&(l[1]||(l[1]=0)),(p=p&&p.match(/\d+/g))&&(p[1]||(p[1]=12)),r='<span tag="'+(t.month()?'to-year">':'to-date">')+a("calendar.title","Y")[0].replace("Y",y)+"</span>",f(o,e,"month",r),r=(c(t)-30)/3|0,s='<div style="height:'+r+"px;line-height:"+r+'px;">',o.push('<div class="f-calendar-month">'),r=e[1];for(var m=0;m<3;m++){o.push(s);for(var b=0;b<4;b++)i=4*m+b+1,n=i===r?"f-calendar-selected ":"",(l&&u(l,y,i)||p&&d(p,y,i)||g&&g(y,i)===!1)&&(n+="f-calendar-disabled"),o.push('<span class="',n,'" value="',i,'" tag="month">',v[i-1],"</span>");o.push("</div>")}o.push("</div>"),t.view.innerHTML=o.join("")}function l(t,e){var i,n,s,r,o,a,h,l,g,v,y=[],m=flyingon.i18ntext,b=t.__storage||t.__defaults,w=b.min,x=b.max,k=b.today||b.clear||b.time,C=t.oncheck,P=0;(w=w&&w.match(/\d+/g))&&(w[1]||(w[1]=0),w[2]||(w[2]=0)),(x=x&&x.match(/\d+/g))&&(x[1]||(x[1]=12),x[2]||(x[2]=31)),o=m("calendar.title",["Y","M","M Y"]),a=o[0].replace("Y",e[4]),h=o[1].replace("M",(m("calendar.month","")||_)[e[5]-1]),v=o[2].replace("Y",'<span tag="to-year">'+a+"</span>"),v=v.replace("M",'<span tag="to-month">'+h+"</span>"),f(y,e,"date",v),v=m("calendar.week","")||p,y.push('<div class="f-calendar-week" style="height:25px;line-height:25px;">');for(var T=0;T<7;T++)y.push("<span>",v[T],"</span>");y.push('</div><div class="f-calendar-line" style="height:1px;"></div><div class="f-calendar-space" style="height:4px;"></div>'),v=new Date(e[4],e[5],1),i=v.getDay(),v.setDate(-1),n=v.getDate()+1,v=new Date(e[4],e[5]+1,1),v.setDate(-1),s=v.getDate()+1,v=(c(t)-(k?90:60))/6|0,r='<div class="f-calendar-date" style="height:'+v+"px;line-height:"+v+'px;">';for(var T=0;T<6;T++){for(y.push(r);P++<7;)l=7*T-i+P,a=e[4],h=e[5],l<1?(--h<1&&(a--,h=12),l+=n,g=-1):l>s?(++h>12&&(a++,h=1),l-=s,g=1):g=0,o=g?"f-calendar-dark ":"",e[2]===l&&e[1]===h&&e[0]===a&&(o+="f-calendar-selected "),(w&&u(w,a,h,l)||x&&d(x,a,h,l)||C&&C(a,h,l)===!1)&&(o+="f-calendar-disabled "),1!==P&&7!==P||(o+="f-calendar-weekend"),y.push('<span class="',o,'" tag="date" offset="',g,'">',l,"</span>");P=0,y.push("</div>")}k&&(y.push('<div class="f-calendar-space" style="height:4px;"></div><div class="f-calendar-foot" style="height:25px;line-height:25px;">'),b.time&&y.push('<input type="text" class="f-calendar-time" value="',e[3],'" />'),b.clear&&y.push('<span class="f-calendar-clear" tag="clear">',m("calendar.clear","clear"),"</span>"),b.today&&y.push('<span class="f-calendar-today" tag="today">',m("calendar.today","today"),"</span>"),y.push("</div>")),t.view.innerHTML=y.join("")}function f(t,e,i,n){t.push('<div class="f-calendar-head" style="height:30px;line-height:30px;">','<span class="f-calendar-before2" tag="',i,'-2"></span>','<span class="f-calendar-before1" tag="',i,'-1"></span>','<span class="f-calendar-title">',n,"</span>",'<span class="f-calendar-after1" tag="',i,'+1"></span>','<span class="f-calendar-after2" tag="',i,'+2"></span>',"</div>")}function c(t){return t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom}function u(t,e,i,n){var s=e-t[0];return s<0||(0===s&&i>0?(s=i-t[1],s<0||0===s&&n<t[2]):void 0)}function d(t,e,i,n){var s=e-t[0];return s>0||(0===s&&i>0?(s=i-t[1],s>0||0===s&&n>t[2]):void 0)}var _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];this.render=function(t,e){t.push("<div"),this.renderDefault(t,e,"","padding:8px;"),t.push("></div>")},this.mount=function(n,s){s.onclick=e,s.onchange=i,t.mount.call(this,n,s)},this.unmount=function(e){var i=e.view;i.onclick=i.onchange=null,t.unmount.call(this,e)},this.update=function(e){t.update.call(this,e),e.__data=null,o(e)},this.__location_patch=function(e,i){t.__location_patch.call(this,e,i),e.__data=null,o(e)},this.refresh=function(t){t.__data=null,o(t)}}),flyingon.renderer("Tree",function(t){function e(t){for(var e=t.original_event.target;e;)switch(e.getAttribute("tag")){case"folder":return e=t.target,e.collapsed(!e.collapsed()),void t.stopPropagation();case"check":return e=t.target,e.checked(!e.checked()),void t.stopPropagation();case"text":if(this.editable())return void t.target.beginEdit();case"node":return void this.trigger("node-click","node",t.target);case"tree":return;default:e=e.parentNode}}this.__scroll_html="",this.render=function(t,e){var i=e.__storage||e.__defaults;t.push("<div"),this.renderDefault(t,e,"f-tree-theme-"+i.theme+(i.checked?"":" f-tree-no-check")+(i.icon?"":" f-tree-no-icon"),"overflow:auto;padding:2px;"),t.push(' tag="tree">'),(i=e.length)>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,0,i)),t.push("</div>")},this.__render_children=function(t,e,i,n){for(var s,r=e.format,o=e.length;i<n;)(s=e[i++])&&(s.view||s.renderer.render(t,s,i===o,r,0))},this.mount=function(i,n){t.mount.call(this,i,n),i.__content_render&&this.__mount_children(i,n,0,n.firstChild),i.on("click",e)},this.unmount=function(e){this.__unmount_children(e),t.unmount.call(this,e)},this.theme=function(t,e,i){e.className=e.className.replace(/f-tree-theme-\w+/,"f-tree-theme-"+i)},this.checked=function(t,e,i){var n=e.className;i?n=n.replace(" f-tree-no-check",""):n+=" f-tree-no-check",e.className=n},this.icon=function(t,e,i){var n=e.className;i?n=n.replace(" f-tree-no-icon",""):n+=" f-tree-no-icon",e.className=n}}),flyingon.renderer("TreeNode",function(t){function e(t,e,i){for(var n=t.firstChild.lastChild;n;){if(n.getAttribute("tag")===e)return i&&(n.className=i),n;n=n.previousSibling}}var i=[];this.render=function(t,e,n,s,r){var o,a,h,l=flyingon.html_encode,f=e.__storage||e.__defaults;e.hasRender=!0,t.push('<div class="',l(e.fullClassName),'"><div class="f-tree-node',n?" f-tree-node-last":"",(h=f.className)?' class="'+l(h)+'"':"",(h=f.id)?'" id="'+l(h)+'"':"",'" tag="node">'),r>0&&t.push(i[r]||(i[r]=new Array(r+1).join('<span class="f-tree-space"></span>'))),(h=f.delay)&&(f.delay=!1),h||e.length>0?h||f.collapsed?(o="f-tree-icon-close",t.push('<span class="f-tree-folder f-tree-close" tag="folder"></span>')):(o="f-tree-icon-open",t.push('<span class="f-tree-folder f-tree-open" tag="folder"></span>')):(o="f-tree-icon-file",t.push('<span class="f-tree-file"></span>')),a=(a=f.text)?l(a):"",s&&(a=s(a)),t.push('<span class="f-tree-check f-tree-',f.checked?"checked":"unchecked",'" tag="check"></span>','<span class="f-tree-icon ',f.icon||o,'" tag="icon"></span>','<span class="f-tree-text" tag="text">',a,"</span></div>",'<div class="f-tree-list',n?" f-tree-list-last":"",'">'),!f.collapsed&&e.length>0&&this.__render_children(t,e,0,e.length,s,++r),t.push("</div></div>")},this.__render_children=function(t,e,i,n,s,r){var o,a;if(e.__content_render=!0,void 0===s){for(o=e,r=0;(a=o.parent)&&a.isTreeNode;)o=a,r++;s=o.format||null}for(a=e.length;i<n;)if(o=e[i++]){if(o.view){if(o.__level===r)continue;o.renderer.unmount(o)}o.renderer.render(t,o,i===a,s,o.__level=r)}},this.mount=function(e,i){t.mount.call(this,e,i),e.__content_render&&this.__mount_children(e,i,0,i.lastChild.firstChild)},this.unmount=function(e){this.__unmount_children(e),t.unmount.call(this,e)},this.checked=function(t,i,n){n=n?"checked":t.checkedChildren?"checked2":"unchecked",e(i,"check","f-tree-check f-tree-"+n)},this.icon=function(t,i,n){e(i,"icon","f-tree-icon "+n)},this.text=function(t,i,n){var s;if(i=e(i,"text")){for(;(s=t.parent)&&s.isTreeNode;)t=s;(s=t&&t.format)?i.innerHTML=format(flyingon.html_encode(n)):i[this.__text_name]=n}},this.expand=function(t){var i,n=t.view;e(n,"folder","f-tree-folder f-tree-open"),(i=e(n,"icon"))&&(i.className=i.className.replace("f-tree-icon-close","f-tree-icon-open")),n=n.lastChild,t.__content_render||(this.__render_children(i=[],t,0,t.length),n.innerHTML=i.join(""),this.__mount_children(t,n,0,n.firstChild)),n.style.display=""},this.collapse=function(t){var i=t.view;i.lastChild.style.display="none",e(i,"folder","f-tree-folder f-tree-close"),(i=e(i,"icon"))&&(i.className=i.className.replace("f-tree-icon-open","f-tree-icon-close"))}}),flyingon.renderer("BaseGrid",function(t){this.renderRow=function(t,e,i,n){},this.renderHead=function(t,e,i,n){}}),flyingon.renderer("Grid","BaseGrid",function(t){}),flyingon.renderer("TreeGrid","BaseGrid",function(t){}),flyingon.renderer("Tab",function(t){function e(t){var e=t.original_event.target;switch(e.getAttribute("tag")){case"forward":(this.__scroll_header-=100)<0&&(this.__scroll_header=0),i(this);break;case"back":this.__scroll_header+=100,i(this)}}function i(t){var e,i,n,s,r=t.view.firstChild.firstChild.nextSibling,o=r.firstChild,a=t.length,h=flyingon.rtl?"right":"left",l=t.__storage||t.__defaults,f="left,right".indexOf(l.direction)>=0,c=l.space;if(s=l.header-l.offset,f?(e="margin-top:"+c+"px;width:"+s+"px;line-height:"+(l.size-1)+"px;",i=t.offsetHeight-t.borderTop-t.borderBottom-l.start):(e="margin-"+h+":"+c+"px;height:"+s+"px;line-height:"+(s-1)+"px;",i=t.offsetWidth-t.borderLeft-t.borderRight-l.start),l.fill){for(i-=c*(a+1)+l.end,s=e+(f?"height:":"width:");o;)n=i/a|0,o.style.cssText=s+n+"px;",o=o.nextSibling,a--,i-=n;a=0}else{for(s=(n=l.size)>0?n+"px;":"auto;",e+=f?"height:"+s+"margin-top:"+c+"px;":"width:"+s+"margin-"+h+":"+c+"px;";o;)o.style.cssText=e,o=o.nextSibling;a=n>0?(n+c)*a+c:(f?r.offsetHeight:r.offsetWidth)+c}(s=a-i)>0?(s+=l.scroll-1,t.__scroll_header>s?t.__scroll_header=n=s:n=t.__scroll_header-l.scroll+1):t.__scroll_header=n=s=0,r.style[f?"top":h]=-(l.start+n)+"px",o=r.nextSibling,o.style.display=o.nextSibling.style.display=s>0?"":"none"}function n(t){var e,i=t.view,n=t.__storage||t.__defaults,s=i.firstChild.style,r=i.lastChild.style,o=n.direction,a=n.header,h=":"+a+"px";switch(i.className=i.className.replace(/f-tab-direction-\w+/,"f-tab-direction-"+o),o){case"left":s.cssText="right:auto;width"+h,r.cssText=o+h,h="height";break;case"right":s.cssText="left:auto;width"+h,r.cssText=o+h,h="height";break;case"bottom":s.cssText="top:auto;height"+h,r.cssText=o+h,h="width";break;default:s.cssText="bottom:auto;height"+h,r.cssText=o+h,h="width"}if(a>0){if(i=i.firstChild.firstChild,i=i.nextSibling)for(i.style.cssText=e=o+":"+n.offset+"px",h=h+":"+n.scroll+"px;display:none;"+e;i=i.nextSibling;)i.style.cssText=h;s.display=""}else s.display="none"}this.__scroll_html="",this.render=function(t,e){var i,n=e.__storage||e.__defaults;e.__content_render=!0,t.push("<div"),this.renderDefault(t,e,"f-tab-direction-"+n.direction),t.push('><div class="f-tab-head f-tab-theme-',n.theme,'" tag="head">','<div class="f-tab-line"></div>','<div class="f-tab-content"></div>','<div class="f-tab-forward" tag="forward"><span class="f-tab-scroll" tag="forward"></span></div>','<div class="f-tab-back" tag="back"><span class="f-tab-scroll" tag="back"></span></div>',"</div>",'<div class="f-tab-body">'),(i=e.selectedPage())&&i.renderer.render(t,i,!1),t.push("</div></div>")},this.mount=function(i,n){var s=i.selectedPage();t.mount.call(this,i,n),this.__insert_patch(i,n),s&&s.renderer.mount(s,n.lastChild.firstChild),i.on("click",e)},this.unmount=function(e){this.__unmount_children(e),t.unmount.call(this,e)},this.selected=function(t,e,n){var s=t.__storage||t.__defaults,r=s.size,o=s.space;n.view||(e.lastChild.appendChild(n.renderer.createView(n,!1)),n.renderer.update(n,!1)),r=r>0?t.indexOf(n)*(r+o):"left,right".indexOf(s.direction)>=0?n.view_head.offsetTop-o:n.view_head.offsetLeft-o,t.__scroll_header=r,t.__update_dirty||i(t)},this.theme=function(t,e,i){e.className=e.className.replace(/f-tab-type-\w+/,"f-tab-type-"+i)},this.__insert_patch=function(t,e){var i,n,s;e=e.firstChild.firstChild.nextSibling;for(var r=t.length-1;r>=0;r--)if(i=t[r]){if(n=i.view_head){if(n.parentNode===e){s=n;continue}}else i.renderer.__render_header(i),n=i.view_head;s?e.insertBefore(n,s):e.appendChild(n),s=n}},this.__remove_patch=function(e,i){for(var n,s,r=e.view.firstChild.firstChild.nextSibling,o=0;n=i[o++];)n.parent!==e&&(s=n.view_head)&&s.parentNode===r&&r.removeChild(s);t.__remove_patch.apply(this,arguments)},this.update=function(e){var s=e.selectedPage();t.update.call(this,e),e.__reset_header&&(e.__reset_header=!1,n(e)),e.length>0&&(e.header()>0&&i(e),this.__arrange(e)),s&&(s.view||e.view.lastChild.appendChild(s.renderer.createView(s,!1)),s.renderer.update(s,!1)),e.__arrange_dirty=0},this.__arrange=function(t){var e=t.__storage||t.__defaults,i=e.header,n=t.offsetWidth-t.borderLeft-t.borderRight-t.paddingLeft-t.paddingRight,s=t.offsetHeight-t.borderTop-t.borderBottom-t.paddingTop-t.paddingBottom;i>0&&("left,right".indexOf(e.direction)>=0?n-=i:s-=i);for(var r=t.length-1;r>=0;r--){var o=t[r];o.measure(n,s,n,s,3),o.locate(0,0)}}}),flyingon.renderer("TabPage","Panel",function(t){function e(t){var e,i=this.page;for(t=t||window.event,e=t.target||t.srcElement;e&&e!==this;){switch(e.getAttribute("tag")){case"close":return void i.remove();case"button":return void this.trigger("button-click","page",i)}e=e.parentNode}i.parent.selectedPage(i)}this.__render_header=function(t){var i,n=t.view_head=document.createElement("span"),s=[],r=flyingon.html_encode,o=t.__storage||t.__defaults;n.className="f-tab-item-host"+(t.selected()?" f-tab-selected":""),s.push('<a class="f-tab-item">','<span class="f-tab-icon ',(i=o.icon)?r(i):"f-tab-icon-none",'"></span>','<span class="f-tab-text">',(i=o.text)?r(i):"","</span>"),(i=o.buttons)&&(i=r(i).replace(/(\w+)\W*/g,'<span class="f-tab-button $1" tag="button"></span>'))&&s.push(i),s.push('<span class="f-tab-close"',o.closable?"":' style="display:none"',' tag="close"></span>','</a><span class="f-tab-line"></span>'),n.innerHTML=s.join(""),n.page=t,n.onclick=e},this.unmount=function(e){var i=e.view_head;e.view_head=i.control=i.onclick=null,t.unmount.call(this,e)},this.icon=function(t,e){t.view_head.firstChild.firstChild.className="f-tab-icon "+(e||"f-tab-icon-none")},this.text=function(t,e){t.view_head.firstChild.firstChild.nextSibling[this.__text_name]=e},this.buttons=function(t,e){for(var i=(view=t.view_head).firstChild.lastChild,n=i.previousSibling;n&&"button"===n.getAttribute("tag");)n=n.previousSibling,view.removeChild(n.nextSibling);e&&(e=flyingon.html_encode(any).replace(/(\w+)\W*/g,'<span class="f-tab-button $1" tag="button"></span>'),flyingon.dom_html(view,e,i))},this.closable=function(t,e){t.view_head.firstChild.lastChild.style.display=e?"":"none"},this.selected=function(t,e){t.view&&(t.view.style.display=e?"":"none"),t.view_head.className="f-tab-item-host"+(e?" f-tab-selected":"")}}),flyingon.renderer("Popup","Panel",function(t){function e(t){var e,i;if((e=s)&&(i=e.__closeAway)){var n=e.__view_rect,r=t.clientX,o=t.clientY;n?(n.left-r>i.x1||r-n.right>i.x2||n.top-o>i.y1||o-n.bottom>i.y2)&&e.close("auto"):(e.__view_rect=n=e.view.getBoundingClientRect(),e.__closeAway={x1:(i=n.left-r)>0?i+4:4,x2:(i=r-n.right)>0?i+4:4,y1:(i=n.top-o)>0?i+4:4,y2:(i=o-n.bottom)>0?i+4:4})}}function i(t){var e=s;if(e&&e.view===this){var i=this.getBoundingClientRect(),n=t.clientX,r=t.clientY;(n>=i.right||r>=i.bottom||n<=i.left||r<=i.top)&&e.close("auto")}}var n=[],s=null,r=flyingon.dom_on,o=flyingon.dom_off;r(document,"mousedown",function(t){var e;if(e=s){for(var i=e.view,n=e.__view_reference,r=t.target;r;){if(r===i||r===n)return;r=r.parentNode}e.trigger("autoclosing","dom",t.target)!==!1&&e.close("auto")}}),r(document,"keydown",function(t){var e;(e=s)&&27===t.which&&e.close("cancel")}),this.show=function(t,e,i,n,s,r){var o=(t.__view_reference=e.view||e).getBoundingClientRect();i&&(o={top:o.top-(0|i[0]),right:o.right+(0|i[1]),bottom:o.bottom+(0|i[2]),left:o.left-(0|i[3])}),this.showAt(t,0,0),o=flyingon.dom_align(t.view,o,n,s,r),t.offsetLeft=o.left,t.offsetTop=o.top},this.showAt=function(t,o,a){var h=t.view||this.createView(t,!1);document.body.appendChild(h),t.trigger("showing"),t.measure(document.body.clientWidth,0),t.locate(0|o,0|a),flyingon.__update_patch(),this.update(t,!1),n.push(s=t),(t.__closeAway=t.closeAway())&&!e.count++&&(e.count=1,r(document,"mousemove",e)),(t.__closeLeave=t.closeLeave())&&r(h,"mouseout",i),t.trigger("shown")},this.close=function(t){var r,a=t.view;t.__view_reference=null,t.__closeAway&&(t.__closeAway=t.__view_rect=null,--e.count||o(document,"mousemove",e)),t.__closeLeave&&o(a,"mouseout",i),n.pop(),s=n[n.length-1],(r=a.parentNode)&&r.removeChild(a)}}),flyingon.renderer("Dialog","Panel",function(t){function e(t){1===t.which&&t.target===this&&this.movable()&&n(this.view,t)&&(this.active(),this.renderer.movable(this,t))}function i(t){if(t.target===this)switch(n(this.view,t)){case"close":this.close();break;case"head":this.active()}}function n(t,e){for(var i,n=e.original_event.target;n&&n!==t;){if(i=n.getAttribute("tag"))return i;n=n.parentNode}}this.render=function(t,e){var i,n=e.__storage||e.__defaults,s=n.header,r=n.text;t.push("<div"),this.renderDefault(t,e),r&&(r=flyingon.html_encode(r)),(i=e.format)&&(r=i.call(e,r)),t.push(">",'<div class="f-dialog-head" style="height:',s,"px;line-height:",s,'px;" tag="head">','<span class="f-dialog-icon ',(i=n.icon)?i:'" style="display:none;','"></span>','<span class="f-dialog-text">',r,"</span>",'<span class="f-dialog-close"',n.closable?"":' style="display:none;"',' tag="close"></span>','<span class="f-dialog-line"></span>',"</div>",'<div class="f-dialog-body" style="top:',s,'px;">'),e.length>0&&e.__visible&&(e.__content_render=!0,this.__render_children(t,e,0,e.length)),t.push(this.__scroll_html,"</div></div>")},this.mount=function(n,s){n.view_content=s.lastChild,t.mount.call(this,n,s),n.on("mousedown",e),n.on("click",i)},this.active=function(t,e){var i=t.view,n=" f-dialog-active";e?i.className.indexOf(n)<0&&(i.className+=n):i.className=i.className.replace(n,"")},this.header=function(t,e,i){e.firstChild.style.height=e.lastChild.style.top=i+"px"},this.text=function(t,e,i){e=e.firstChild.firstChild.nextSibling,t.format?(i&&(i=flyingon.html_encode(i)),e.innerHTML=t.format(i)):e[this.__text_name]=i},this.icon=function(t,e,i){e=e.firstChild.firstChild,e.className="f-groupbox-icon"+(i?" "+i:""),e.style.display=i?"":"none"},this.closable=function(t,e,i){e.firstChild.lastChild.style.display=i?"":"none"},this.show=function(t,e){var i=document.body,n=t.view||this.createView(t,!1),s=i.clientWidth;i.appendChild(n),t.trigger("showing"),t.measure(s,0),this.center(t),e&&flyingon.dom_overlay(n),flyingon.__update_patch(),this.update(t,!1),t.trigger("shown")},this.center=function(t){var e=document.body,i=t.view.style;i.left=(t.offsetLeft=e.clientWidth-t.offsetWidth>>1)+"px",i.top=(t.offsetTop=((window.innerHeight||document.documentElement.clientHeight)-t.offsetHeight>>1)-e.clientLeft)+"px"},this.movable=function(t,e){e=e.original_event,e.dom=t.view,flyingon.dom_drag(t,e),e.dom=null},this.close=function(t){var e,i=t.view;(e=i.parentNode)&&e.removeChild(i),i.flyingon_overlay&&flyingon.dom_overlay(i,!1)}}),flyingon.showMessage=function(t,e,i,n,s){var r,o;arguments.length<4&&(s=n,n=i,i=""),n=n?""+n:"ok",o=n.match(/\w+/g),n=[];for(var a=0,h=o.length;a<h;a++)n.push({Class:"button",type:"button",height:25,style:"min-width:80px;vertical-align:middle;",tag:o[a],text:flyingon.i18ntext("system."+o[a],o[a])});return r=flyingon.ui({layout:"vertical-line",width:300,height:"auto",padding:0,text:t,children:[{Class:"Panel",layout:"dock",height:"auto",padding:8,minHeight:60,style:"overflow:hidden;",children:[{Class:"Label",dock:"left",width:50,height:50,visible:i,className:"f-message-icon"+(i?" f-message-"+i:"")},{Class:"Label",dock:"fill",height:"auto",text:e}]},{Class:"div",height:40,className:"f-message-foot",style:"overflow:hidden;line-height:40px;",children:n}]},flyingon.Dialog).showDialog(),o=r.offsetHeight/200,o>1&&(o=300*o,r.width(o>800?800:o),r.showDialog()),r.view.lastChild.firstChild.nextSibling.children[0|s].focus(),r.on("click",function(t){var e=t.target.tag();e&&this.close(e)}),r},Object.extend("Control",function(){function t(t,n){var s,r,o,a,h=this.__watches,l=this.view,f=0,c=n.length;for(t=t||(this.__style={});f<c;){for(;":"===(s=n[f++]););s&&(":"===n[f++]?r=n[f++]||"":(f--,r=""),(a=t&&t[s]||"")!==r&&(t[s]=r,h&&h["style:"+s]&&this.notify("style:"+s,r,a),l?(o||(o=this.__style_patch||e(this)))[s]=r:o=!0))}o&&(h&&h.style?(a=t.cssText||"",this.notify("style",i(t),a)):t.cssText=!1)}function e(t){var e=t.__view_patch,i=t.__style_patch={};return e?e.__style_patch=i:t.renderer.set(t,"__style_patch",i),i}function i(t){var e,i=[];for(var n in t)"cssText"!==n&&""!==(e=t[n])&&i.push(n,":",e,";");return t.cssText=i.join("")}function n(t,e,i){var n,s,r,o=[];for(var a in e)"cssText"!==a&&""!==(s=e[a])&&(i&&(r=i[n="style:"+a])&&(r=r[0])?t.writeProperty(n,"{{"+r+"}}"):o.push(a,":",s,";"));o[0]&&t.writeProperty("style",o.join(""))}var s=(flyingon.create,flyingon.pixel),r=flyingon.pixel_sides;this.defaultWidth=100,this.defaultHeight=25,this.offsetLeft=this.offsetTop=this.offsetWidth=this.offsetHeight=0,this.marginLeft=this.marginTop=this.marginRight=this.marginBottom=0,this.borderLeft=this.borderTop=this.borderRight=this.borderBottom=0,this.paddingLeft=this.paddingTop=this.paddingRight=this.paddingBottom=0,this.scrollLeft=this.scrollTop=0,flyingon.fragment("f.visual",this),flyingon.fragment("f.bindable",this),this["#focused"]=function(t){t?this.focus():this.blur()},this.__visible=!0,this.defineProperty("visible",!0,{group:"layout",set:function(t){var e;this.__visible=t,this.view&&((e=this.__view_patch)?e.visible=t:this.renderer.set(this,"visible",t)),this.__update_dirty||this.invalidate()}}),this.__location_dirty=0,this.__update_dirty=!0;var o=function(t,e,i,n){return t.defineProperty(e,i,{group:"layout",set:function(){var t;this.__location_dirty|=n,!this.__as_html||(t=this.__view_patch)&&t.__location_patch||this.renderer.set(this,"__location_patch"),this.__update_dirty||this.invalidate()}})};o(this,"left","",512),o(this,"top","",1024),o(this,"width","default",1),o(this,"height","default",2),this["min-width"]=o(this,"minWidth","",32),this["max-width"]=o(this,"maxWidth","",64),this["min-height"]=o(this,"minHeight","",128),this["max-height"]=o(this,"maxHeight","",256),o(this,"margin","",4),o(this,"border","",8),o(this,"padding","",16),o=function(t,e,i,n){return t.defineProperty(e,i,{group:"layout",set:function(){this.__update_dirty||this.invalidate()}})},this["align-x"]=o(this,"alignX","left"),this["align-y"]=o(this,"alignY","top"),o(this,"dock","left"),this.defineProperty("style","",{group:"appearance",fn:function(e,n){var s,r=this.__style;return void 0===e?r&&(s=r.cssText)===!1?r.cssText=i(r):s||"":(e=""+e,void 0!==n?(this["style:"](e,n),this):e.length<36&&e.indexOf(":")<0?r&&r[e]||"":((n=e.match(/\:|[^\s:;]+(\s+[^\s:;]+)?/g))&&t.call(this,r,n),this))}}),this["style:"]=function(t,n){var s,r,o=this.__style;t&&(r=o&&o[t]||"")!==n&&((o||(o=this.__style={}))[t]=n,(s=this.__watches)?(s["style:"+t]&&this.notify("style:"+t,n,r),s.style&&(r=o.cssText||"",this.notify("style",i(o),r))):o.cssText=!1,this.view&&((this.__style_patch||e(this))[t]=n))},o=function(t,e,i,n){n=n||{},n.set=function(t){var i;(i=this.__view_patch)?i[e]=t:this.renderer.set(this,e,t)},t.defineProperty(e,i,n)},o(this,"tabindex",0),o(this,"disabled",!1),o(this,"readonly",!1),o(this,"title",""),o(this,"accesskey",""),this.defineProperty("resizable","none"),this.defineProperty("movable",!1),this.defineProperty("droppable",!1),this.defineProperty("key",""),this.defineProperty("tag",null),this.locationValue=function(t){return(this.__location_values||this.__storage||this.__defaults)[t]},this.measure=function(t,e,i,n,o){var a,h=this.__storage||this.__defaults,l=this.__location_values||h,f=l.minWidth,c=l.maxWidth,u=l.minHeight,d=l.maxHeight,_=l.width,p=l.height,g=0,v=r,y=v.cache;switch(a=y[a=l.margin]||v(a,t),this.marginLeft=a.left,this.marginTop=a.top,this.marginRight=a.right,this.marginBottom=a.bottom,a=y[a=h.border]||v(a,0),this.borderLeft=a.left,this.borderTop=a.top,this.borderRight=a.right,this.borderBottom=a.bottom,a=y[a=h.padding]||v(a,t),this.paddingLeft=a.left,this.paddingTop=a.top,this.paddingRight=a.right,this.paddingBottom=a.bottom,v=s,y=v.cache,f=f>0?0|f:y[f]||v(f,t),c=c>0?0|c:y[c]||v(c,t),u=u>0?0|u:y[u]||v(u,e),d=d>0?0|d:y[d]||v(d,e),_){case"default":1&o?(a=i>=0?i:t,_=a-this.marginLeft-this.marginRight):_=this.defaultWidth;break;case"auto":g=1,_=i||this.defaultWidth;break;default:_=(a=+_)===a?0|a:y[_]||v(_,t)}switch(a<0&&(_=0),p){case"default":2&o?(a=n>=0?n:e,p=a-this.marginTop-this.marginBottom):p=this.defaultHeight;break;case"auto":g|=2,p=n||this.defaultHeight;break;default:p=(a=+p)===a?0|a:y[p]||v(p,e)}p<0&&(p=0),this.__auto_size=g,_<f?_=f:c>0&&_>c&&(_=c),p<u?p=u:d>0&&p>d&&(p=d),this.offsetWidth=_,this.offsetHeight=p,(v=this.onmeasure)&&v.call(this,g)!==!1&&(this.offsetWidth!==_&&((_=this.offsetWidth)<f?this.offsetWidth=_=f:c>0&&_>c&&(this.offsetWidth=_=c)),this.offsetHeight!==p&&((p=this.offsetHeight)<u?this.offsetHeight=p=u:d>0&&p>d&&(this.offsetHeight=p=d)))},this.locate=function(t,e,i,n,s){var r,o=this.offsetWidth,a=this.offsetHeight;if(i>0&&(r=i-o))switch((this.__location_values||this.__storage||this.__defaults).alignX){case"center":t+=r>>1;break;case"right":t+=r;break;default:t+=this.marginLeft}else t+=this.marginLeft;if(n>0&&(r=n-a))switch((this.__location_values||this.__storage||this.__defaults).alignY){case"middle":e+=r>>1;break;case"bottom":e+=r;break;default:e+=this.marginTop}else e+=this.marginTop;this.offsetLeft=t,this.offsetTop=e,(r=this.onlocate)&&r.call(this)!==!1&&(t=this.offsetLeft,e=this.offsetTop),s&&(s.arrangeX=t+=o+this.marginRight,s.arrangeY=e+=a+this.marginBottom,t>s.arrangeRight&&(s.arrangeRight=t),e>s.arrangeBottom&&(s.arrangeBottom=e))},this.canFocus=function(){return!!this.tabindex},this.focus=function(){this.view&&this.renderer.focus(this)},this.blur=function(){this.view&&this.renderer.blur(this)},this.mountTo=function(t){var e,i;if("string"==typeof t&&(t=document.getElementById(t)),!t)throw"can not find host!";return e=t.clientWidth,i=t.clientHeight,flyingon.ready(),this.__top_control||(this.__top_control=!0,this.fullClassName+=" f-host"),t.appendChild(this.view||this.renderer.createView(this)),this.renderer.__update_top(this,e,i),this},this.unmount=function(){if(this.__top_control){var t,e;this.__top_control=!1,(t=this.view)&&(e=t.parentNode)&&e.removeChild(t),this.fullClassName=this.fullClassName.replace(" f-host","")}return this},this.invalidate=function(){var t=this.parent;this.__update_dirty=!0,t&&t.invalidate()},this.update=function(){return this.hasRender&&this.__visible&&(flyingon.__update_patch(),this.renderer.update(this)),this},this.__do_scroll=function(t,e){},flyingon.fragment("f.serialize",this),this.serialize=function(t){var e;(e=this.Class)&&(e=e.nickName||e.fullName)&&t.writeProperty("Class",e),(e=this.__storage)&&t.writeProperties(e,this.getOwnPropertyNames(),this.__watches),(e=this.__style)&&n(t,e,this.__watches)},this.autoDispose=!0,this.dispose=function(){var t;this.__storage;return(t=this.distroyed)&&t.call(this),arguments[0]!==!1&&this.view&&this.renderer.set(this,"dispose"),(t=this.__dataset)&&t.subscribe(this,!0),this.__events&&this.off(),this.parent=this.__loop_vm=null,this}}).register(),flyingon.Control.extend("HtmlElement",function(t){this.tagName="div",this.defineProperty("text","",{set:function(t){this.length>0&&this.clear(),this.hasRender&&this.renderer.set(this,"text",t)}}),this.defineProperty("html",!1),this.defineProperty("arrange",!0),flyingon.fragment("f.container",this),this.onmeasure=function(t){var e=(this.offsetHeight<<16)+this.offsetWidth;return this.__size_tag!==e&&(this.__size_tag=e,this.__arrange_dirty=2),!!t&&void this.renderer.__measure_auto(this,t)},this.serialize=function(e){return t.serialize.call(this,e),this.length>0&&e.writeProperty("children",this,!0),this},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}),flyingon.Control.extend("Label",function(t){var e=function(t,e,i){t.defineProperty(e,i,{set:function(){this.hasRender&&this.renderer.set(this,"text")}})};e(this,"text",""),e(this,"html",!1),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("Button",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{set:function(t){this.hasRender&&this.renderer.set(this,e,t)}})};e(this,"icon",""),this["icon-size"]=e(this,"iconSize",16),e(this,"vertical",!1),e(this,"text",""),e(this,"html",!1),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("LinkButton",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{set:function(t){this.hasRender&&this.renderer.set(this,e,t)}})};e(this,"text",""),e(this,"html",!1),e(this,"href",""),this.onmeasure=function(t){return!!t&&void this.renderer.__measure_auto(this,t)}}).register(),flyingon.Control.extend("Image",function(t){this.defaultWidth=400,this.defaultHeight=300,this.defineProperty("src","",{set:function(t){this.hasRender&&this.renderer.set(this,"src",t)}}),this.defineProperty("alt","",{set:function(t){this.hasRender&&this.renderer.set(this,"alt",t)}})}).register(),flyingon.Control.extend("Slider",function(t){var e=function(t,e,i){return t.defineProperty(e,i,{dataType:"integer",check:function(t){return t<0?0:t},set:function(){this.hasRender&&!this.__location_dirty&&this.renderer.set(this,"refresh")}})};e(this,"value",0),e(this,"min",0),e(this,"max",100),e(this,"buttonSize",8)}).register(),flyingon.Control.extend("ProgressBar",function(t){this.defaultHeight=20,this.defaultValue("border",1),this.defineProperty("value",0,{dataType:"integer",check:function(t){return t<0?0:t>100?100:t},set:function(t){this.hasRender&&this.renderer.set(this,"value",t)}}),this.defineProperty("text",!0,{set:function(t){this.hasRender&&this.renderer.set(this,"text",t)}})}).register(),flyingon.fragment("f.collection",function(){var t=Array.prototype;this.length=0,this.indexOf=this.lastIndexOf=[].indexOf,this.push=function(){return this.__insert_items(arguments,0,t.push),this.length},this.pop=function(){var e=t.pop.call(this);return e&&this.__remove_item(e),e},this.unshift=function(){return this.__insert_items(arguments,0,t.unshift),this.length},this.shift=function(){var e=t.shift.call(this);return e&&this.__remove_item(e),e},this.splice=function(e,i){var n,s=arguments.length;return this.length>0&&(1===s?(n=t.splice.call(this,e),this.__remove_items(n)):i>0&&(n=t.splice.call(this,e,i),this.__remove_items(n))),s>2&&(arguments[1]=0,this.__insert_items(arguments,2,t.splice)),n||[]},this.clear=function(){return this.length>0&&this.__remove_items(t.splice.call(this,0)),this}}),flyingon.fragment("f.container",function(t){function e(t,e){for(var i,n,s=0,r=t.length;s<r;s++)(i=t[s])&&(e.push(i),(n=i.all)&&e.push.apply(e,n.call(i)));return e}var i=Array.prototype;this.childrenClass=t||flyingon.Control,flyingon.fragment("f.collection",this),this.detachAll=function(){this.length>0&&(i.splice.call(this,0),this.view&&this.renderer.set(this,"detachAll"),this.__update_dirty||this.invalidate(2))},this.children=function(){return i.slice.call(this,0)},this.__insert_items=function(t,e,i){var n=t.length;if(!(n<=0)){for(var s,r,o=this.childrenClass,a=this instanceof flyingon.HtmlElement,h=this.__content_render&&!this.__insert_patch;e<n;)s=t[e],s.__flyingon_class?s instanceof o?(r=s.parent)&&r.__remove_item(s):this.__check_error(o):(s=flyingon.ui(s,o))instanceof o?t[e]=s:this.__check_error(o),s.parent=this,!(s.__as_html=a)||!s.__location_dirty||(r=s.__view_patch)&&r.__location_patch||s.renderer.set(s,"__location_patch"),(r=s.onparentchange)&&r.call(s,this),h&&(h=!1,this.__insert_patch=!0,this.renderer.__children_dirty(this)),e++;return r=i.apply(this,t),this.__update_dirty||this.invalidate(2),r}},this.__check_error=function(t){throw'"'+this.Class.fullName+'" type can push "'+t.fullName+'" type only!'},this.__remove_items=function(t){for(var e,i,n=this.__remove_patch,s=t.length-1;s>=0;s--)(e=t[s])&&(e.parent=null,(i=e.onparentchange)&&i.call(e,this),n?n.push(e):(this.__remove_patch=n=[e],this.renderer.__children_dirty(this)));this.__update_dirty||this.invalidate(2)},this.__remove_item=function(t){var e=this.__remove_patch;t.parent=null,(e=t.onparentchange)&&e.call(t,null),e?e.push(t):(this.__remove_patch=e=[t],this.renderer.__children_dirty(this)),this.__update_dirty||this.invalidate(2)},this.find=function(t){return new flyingon.Query(t,[this])},this.findById=function(t,e){var i,n=flyingon.create(flyingon.Query.prototype);return t&&(i=flyingon.__find_id(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.findByType=function(t,e){var i,n=flyingon.create(flyingon.Query.prototype);return t&&(i=flyingon.__find_type(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.findByClass=function(t,e){var i,n=flyingon.create(flyingon.Query.prototype);return t&&(i=flyingon.__find_class(e!==!1?this.all():this,t),i.push.apply(n,i)),n},this.all=function(){return this.__all||(this.__all=e(this,[]))},this.findDropTarget=function(t,e){var i=this.controlAt(t,e);return i?[this,i]:[this,null]},this.controlAt=function(t,e){return this},this.subscribeBind=function(t,e){var i;this.base.subscribeBind.call(this,t,e);for(var n=0,s=this.length;n<s;n++)(i=this[n])&&!i.__dataset&&i.subscribeBind(t,e);return this},this.__arrange_dirty=2,this.invalidate=function(){var t,e;if(2===arguments[0]&&(e=this.__all))for(this.__all=null;e=e.parent;)e.__all=null;if(this.__update_dirty=!0,this.__arrange_dirty=2,t=this.parent){if(t.__arrange_dirty>1)return this;for(t.__arrange_dirty=2,e=t;t=e.parent;)t.__arrange_dirty||(t.__arrange_dirty=1),e=t}else e=this;return e.__top_control&&flyingon.__delay_update(e),this},this.update=function(){if(this.view)switch(flyingon.__update_patch(),this.__arrange_dirty){case 2:this.renderer.update(this);break;case 1:this.__update_children()}return this},this.__update_children=function(){for(var t,e=0,i=this.length;e<i;e++)if((t=this[e])&&t.view)switch(t.__arrange_dirty){case 2:t.renderer.update(t);break;case 1:t.__update_children()}this.__arrange_dirty=0},this.deserialize_children=function(t,e){if("function"==typeof e){var i=[];e(i),e=i}this.push.apply(this,t.readArray(e,this.childrenClass))}}),flyingon.Control.extend("Panel",function(t){this.defaultWidth=300,this.defaultHeight=150,this.arrangeLeft=this.arrangeTop=this.arrangeRight=this.arrangeBottom=this.arrangeWidth=this.arrangeHeight=0,this.defaultValue("droppable",!0),this.defineProperty("layout",null,{group:"locate",query:!0,set:function(t){this.__layout=null,(this.scrollLeft||this.scrollTop)&&this.renderer.__reset_scroll(this),this.invalidate()}}),flyingon.fragment("f.container",this),this.onmeasure=function(t){var e=(this.offsetHeight<<16)+this.offsetWidth;return this.__size_tag!==e&&(this.__size_tag=e,this.__arrange_dirty=2),!!t&&(this.renderer.update(this),1&t&&(this.offsetWidth=this.arrangeRight+this.borderLeft+this.borderRight),2&t&&(this.offsetHeight=this.arrangeBottom+this.borderTop+this.borderBottom),void 0)},this.controlAt=function(t,e){if(this.length<=0)return this;var i,n=flyingon.getLayout(this);return t+=this.scrollLeft-this.borderLeft,e+=this.scrollTop-this.borderTop,(i=n.__sublayouts)?(i=n.controlAt(i,t,e))?i.controlAt(t,e):null:n.controlAt(this,t,e)},this.serialize=function(e){return t.serialize.call(this,e),this.length>0&&e.writeProperty("children",this,!0),this},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}).register(),flyingon.Panel.extend("GroupBox",function(t){function e(t,e,i){t.defineProperty(e,i,{set:function(t){this.hasRender&&this.renderer.set(this,e,t)}})}this.defaultValue("border",1),this.defineProperty("header",25,{set:function(t){this.hasRender&&this.renderer.set(this,"header",t),this.__update_dirty||this.invalidate()}}),e(this,"align","left"),e(this,"icon",""),e(this,"text",""),e(this,"collapsable",0),this.defineProperty("collapsed",!1,{set:function(t){this.hasRender&&this.renderer.set(this,"collapsed",t),!t&&(t=this.mutex())&&this.__do_mutex(t),this.__update_dirty||this.invalidate()}}),this.defineProperty("mutex",""),this.__do_mutex=function(t){var e,i=this.parent;if(i)for(var n=0,s=i.length;n<s;n++)(e=i[n])&&e!==this&&e.__do_mutex&&e.mutex()===t&&e.collapsed(!0)},this.onmeasure=function(e){return this.collapsed()?(this.offsetHeight=this.header(),!1):!!e&&(t.onmeasure.call(this,e),void(this.offsetHeight+=this.header()))},this.arrangeArea=function(){var t=this.header();this.arrangeHeight-=t,this.arrangeBottom-=t}}).register(),flyingon.Panel.extend("ScrollPanel",function(t){this.defineProperty("prerender","none"),this.__visible_start=this.__visible_end=-1,this.__visible_unmount=!0,this.__compute_visible=function(){var t,e,i=-1,n=-1,s=this.scrollLeft,r=this.scrollTop,o=this.offsetWidth,a=this.offsetHeight,h=!0;e=this.prerender(),o+=s+(e.indexOf("x")>=0?o:0),a+=r+(e.indexOf("y")>=0?a:0);for(var l=0,f=this.length;l<f;l++)(t=this[l])&&(t.__visible_area=(e=t.offsetLeft)<o&&e+t.offsetWidth>s&&(e=t.offsetTop)<a&&e+t.offsetHeight>r)&&(h&&!t.view&&(h=!1),i<0&&(i=l),n=l);this.__visible_start=i,this.__visible_end=n,this.__visible_unmount=!h},this.__do_scroll=function(t,e){this.scrollLeft=t,this.scrollTop=e,this.__compute_visible(),this.renderer.scroll(this,t,e)}}).register(),flyingon.Control.extend("Splitter",function(t){this.defaultWidth=this.defaultHeight=4,this.vertical=!1}).register(),flyingon.Panel.extend("Plugin",function(t){this.loadPlugin=function(t){},this.openPlugin=function(t){},this.closePlugin=function(){},this.__class_init=function(e){var i=flyingon.__load_plugin;t.__class_init.apply(this,arguments),i&&e!==flyingon.Plugin&&i(e)}}).register(),flyingon.plugin=function(t,e){return e||(e=t,t=flyingon.Plugin),t.extend(e).init()},flyingon.Control.extend("ListBox",function(t){function e(t,e,i,n){return t.defineProperty(e,i,{set:function(){this.__template=null,this.hasRender&&this.renderer.set(this,"content")}})}this.defaultWidth=200,this.defaultHeight=100,this.defaultValue("border",1),e(this,"columns",1),e(this,"clear",!1),e(this,"template",null),this["item-height"]=e(this,"itemHeight",21),this["value-field"]=this.defineProperty("valueField","",{set:function(){this.__template=null,this.__use_index||(this.__selectedIndex=void 0),this.hasRender&&this.renderer.set(this,"content")}}),this["display-field"]=e(this,"displayField",""),this.defineProperty("items",null,{check:function(t){return t?("string"==typeof t&&(t=flyingon.parseJSON(t)),t instanceof Array?t:[t]):null},set:function(){this.hasRender&&this.renderer.set(this,"content")}}),this.defineProperty("index",-1,{dataType:"integer",set:function(t){this.__use_index=!0,this.__selectedIndex=t,this.hasRender&&this.renderer.set(this,"change")}}),this.defineProperty("type","string",{set:function(){this.__use_index||(this.__selectedIndex=void 0),this.hasRender&&this.renderer.set(this,"change")}}),this.defineProperty("value","",{set:function(){this.__use_index=!1,this.__selectedIndex=void 0,this.hasRender&&this.renderer.set(this,"change")}}),this.selectedIndex=function(){var t=this.__selectedIndex;if(void 0===t){var e,i,n,s=this.__storage;if(s&&(e=s.items)&&e.length>0){switch(n=s.value,s.type){case"boolean":n=!!n&&n!==!1;break;case"integer":n|=0;break;case"number":n=+n}if(i=s.valueField){for(var r=0,o=e.length;r<o;r++)if((s=e[r])&&s[i]===n)return this.__selectedIndex=r;return this.__selectedIndex=-1}return this.__selectedIndex=e.indexOf(n)}return-1}return t},this.selectedItem=function(t){var e=this.__storage,i=e&&(i=e.items)&&i[this.selectedIndex()];return t?((t=e[t])&&(i=i?i[t]:""),void 0!==i?""+i:""):i},this.selectedValue=function(){return this.selectedItem("valueField")},this.selectedText=function(){return this.selectedItem("displayField")}}).register(),flyingon.ListBox.extend("RadioListBox",function(t){this.__list_type="radio"}).register(),flyingon.ListBox.extend("CheckListBox",function(t){this.__list_type="checkbox",this.defineProperty("index",null,{check:function(t){if(t){if(t>0)return[0|vlaue];if(t instanceof Array)return t;if("string"==typeof t&&(t=t.match(/\d+/g)))for(var e=t.length-1;e>=0;e--)t[e]|=0}else if(0===t)return[0];return null},set:function(t){this.__use_index=!0,this.__selectedIndex=t,this.hasRender&&this.renderer.set(this,"content")}}),this.defineProperty("separator",",",{set:function(){this.__use_index||(this.__selectedIndex=void 0,this.hasRender&&this.renderer.set(this,"change"))}}),this.selectedIndex=function(){var t=this.__selectedIndex;if(void 0===t){var e,i,n,s=this.__storage;if(this.__selectedIndex=t=[],s&&(e=s.items)&&e.length>0&&(i=s.value)){if(i=s.value.split(s.separator),n=s.type,"string"!==n)for(var r=i.length-1;r>=0;r--)switch(n){case"boolean":i[r]=!!i[r]&&i[r]!==!1;break;case"integer":i[r]|=0;break;case"number":i[r]=+i[r]}if(s.selected=t,n=s.valueField)for(var r=0,o=e.length;r<o;r++)(s=e[r])&&i.indexOf(s[n])>=0&&t.push(r);else for(var r=0,o=e.length;r<o;r++)i.indexOf(e[r])>=0&&t.push(r)}}return t},this.selectedItem=function(t){var e,i,n,s,r=[],o=this.__storage,a=t&&o[t];if(o&&(e=o.items)&&(n=this.selectedIndex())&&(s=n.length)>0)for(var h=0;h<s;h++)i=e[n[h]],a?i&&r.push(i[a]):r.push(i);return t?r.join():r},this.selectedValue=function(){return this.selectedItem("valueField")},this.selectedText=function(){return this.selectedItem("displayField")}}).register(),flyingon.Control.extend("RadioButton",function(t){this.defineProprty("name",!1,{set:function(t){this.hasRender&&this.renderer.set(this,"name",t)}}),this.defineProprty("checked",!1,{set:function(t){this.hasRender&&this.renderer.set(this,"checked",t)}})}).register(),flyingon.Control.extend("CheckBox",function(t){this.defineProprty("name",!1,{set:function(t){this.hasRender&&this.renderer.set(this,"name",t)}}),this.defineProprty("checked",!1,{set:function(t){this.hasRender&&this.renderer.set(this,"checked",t)}})}).register(),flyingon.fragment("f.text",function(){this.defineProperty("placehodler",""),this.selectionStart=function(t){return this.renderer.selectionStart(t)},this.selectionEnd=function(t){return this.renderer.selectionEnd(t)},this.select=function(){return this.renderer.select()}}),flyingon.Control.extend("TextBox",function(t){this.defineProperty("value","",{set:function(t){this.hasRender&&this.renderer.set(this,"text")}}),this.text=function(){return(this.__storage||this.__defaults).value},flyingon.fragment("f.text",this),this["max-length"]=this.defineProperty("maxLength",0)}).register(),flyingon.Control.extend("TextButton",function(t){var e;this.defineProperty("value",null),this.defineProperty("format","",{set:function(t){this.hasRender&&this.renderer.set(this,"text")}}),this.text=function(){var t=this.__storage||this.__defaults,e=t.format;return e?e.replace(/\{\{value\}\}/g,value):""+t.value},this.defineProperty("button",""),this["button-size"]=this.defineProperty("buttonSize",16),flyingon.fragment("f.text",this),this.__on_click=function(){this.trigger("button-click")},this.__get_popup=function(t){var i=e;return i?i.close("auto"):(i=e=new flyingon.Popup,i.autoDispose=!1,i.on("closed",function(){this.__cache?this.detachAll():this.clear()}),i.width("auto").height("auto")),i.__cache=t,i}}).register(),flyingon.TextButton.extend("ComboBox",function(t){var e;this.defaultValue("button","f-combobox-button"),this.defineProperty("columns",1),this.defineProperty("clear",!1),this.defineProperty("template",null),this["item-height"]=this.defineProperty("itemHeight",21),this["value-field"]=this.defineProperty("valueField",""),this["display-field"]=this.defineProperty("displayField",""),this.defineProperty("items",null,{check:function(t){return t?("string"==typeof t&&(t=flyingon.parseJSON(t)),t instanceof Array?t:[t]):null}}),this.defineProperty("type","string"),this.defineProperty("value","",{set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.selectedIndex=function(){var t,e,i,n=this.__storage;if(n&&(t=n.items)&&t.length>0){switch(i=n.value,n.type){case"boolean":i=!!i&&i!==!1;break;case"integer":i|=0;break;case"number":i=+i}if(e=n.valueField){for(var s=0,r=t.length;s<r;s++)if((n=t[s])&&n[e]===i)return s;return-1}return t.indexOf(i)}return-1},this.selectedItem=function(t){var e=this.__storage,i=e&&(i=e.items)&&i[this.selectedIndex()];return t?((t=e[t])&&(i=i?i[t]:""),void 0!==i?""+i:""):i},this.selectedValue=function(){return this.selectedItem("valueField")},this.text=function(){return this.selectedItem("displayField")},this.popup=this.__on_click=function(){var t=this.__get_popup(!0),e=this.__storage||this.__defaults,i=this.__get_listbox();this.__before_popup(t,i,e),i.border(0).columns(e.columns).clear(e.clear).template(e.template).itemHeight(e.itemHeight).valueField(e.valueField).displayField(e.displayField).type(e.type).items(e.items).value(e.value),i.target=this,i.popup=t,t.push(i),t.show(this)},this.__before_popup=function(t,e,i){},this.__get_listbox=function(){return e=(new flyingon.ListBox).on("change",function(t){this.target.value(t.value),this.popup.close()})}}).register(),flyingon.ComboBox.extend("RadioComboBox",function(t){var e;this.__get_listbox=function(){return e=(new flyingon.RadioListBox).on("change",function(t){this.target.value(t.value),this.popup.close()})}}).register(),flyingon.ComboBox.extend("CheckComboBox",function(t){var e;this.defineProperty("separator",","),this.selectedIndex=function(){var t,e,i,n=[],s=this.__storage;if(s&&(t=s.items)&&t.length>0&&(e=s.value)){if(e=s.value.split(s.separator),i=s.type,"string"!==i)for(var r=e.length-1;r>=0;r--)switch(i){case"boolean":e[r]=!!e[r]&&e[r]!==!1;break;case"integer":e[r]|=0;break;case"number":e[r]=+e[r]}if(i=s.valueField)for(var r=0,o=t.length;r<o;r++)(s=t[r])&&e.indexOf(s[i])>=0&&n.push(r);else for(var r=0,o=t.length;r<o;r++)e.indexOf(t[r])>=0&&n.push(r)}return n},this.selectedItem=function(t){var e,i,n,s,r=[],o=this.__storage,a=t&&o[t];if(o&&(e=o.items)&&(n=this.selectedIndex())&&(s=n.length)>0)for(var h=0;h<s;h++)i=e[n[h]],a?i&&r.push(i[a]):r.push(i);return t?r.join():r},this.selectedValue=function(){return this.selectedItem("valueField")},this.text=function(){return this.selectedItem("displayField")},this.__get_listbox=function(){return e=(new flyingon.CheckListBox).on("change",function(t){this.target.value(t.value)})},this.__before_popup=function(t,e,i){e.separator(i.separator)}}).register(),flyingon.Control.extend("Calendar",function(t){function e(t,e,i,n){t.defineProperty(e,i,{dataType:n,set:function(){this.hasRender&&!this.__location_dirty&&this.renderer.set(this,"refresh")}})}this.defaultWidth=this.defaultHeight=240,this.defaultValue("border",1),this.defaultValue("padding",8),e(this,"value",null,"date"),e(this,"min",""),e(this,"max",""),e(this,"month",!1),e(this,"time",!1),e(this,"today",!1),e(this,"clear",!1)}).register(),flyingon.TextButton.extend("DatePicker",function(t){var e;this.defaultValue("button","f-datepicker-button"),this.defineProperty("value",null,{dataType:"date",set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.defineProperty("format","locale-date",{set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.defineProperty("min",""),this.defineProperty("max",""),this.defineProperty("time",!1),this.defineProperty("today",!1),this.defineProperty("clear",!1),this.text=function(){var t=this.__storage||this.__defaults,e=t.value;return e?e.format(t.format):""},this.popup=this.__on_click=function(){var t=this.__get_popup(!0),i=this.__storage||this.__defaults,n=e;n||(n=e=new flyingon.Calendar,n.border(0).on("selected",function(t){this.target.value(t.value),this.popup.close()})),n.value(i.value).min(i.min).max(i.max).time(i.time).today(i.today).clear(i.clear),n.oncheck=this.oncheck,n.target=this,n.popup=t,t.push(n),t.show(this)}}).register(),flyingon.TextBox.extend("TimePicker",function(t){this.defineProperty("value","",{check:function(t){return t&&(t=t.match(/\d+/g))?(t.length=3,t[1]|=0,t[2]|=0,t.join(":")):""},set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.defineProperty("format","",{set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.text=function(){var t,e=this.__storage||this.__defaults,i=e.value;return i&&(t=e.format)?(i=i.split(":"),new Date(2e3,1,1,0|i[0],0|i[1],0|i[2]).format(t)):i}}).register(),flyingon.TextButton.extend("MonthPicker",function(t){var e;this.defaultValue("button","f-datepicker-button"),this.defineProperty("value",null,{dataType:"date",set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.defineProperty("format","yyyy-MM",{set:function(){this.hasRender&&this.renderer.set(this,"text")}}),this.defineProperty("min",""),this.defineProperty("max",""),this.text=function(){var t=this.__storage||this.__defaults,e=t.value;return e?e.format(t.format):""},this.popup=this.__on_click=function(){var t=this.__get_popup(!0),i=this.__storage||this.__defaults,n=e;n||(n=e=new flyingon.Calendar,n.border(0).month(!0).on("selected",function(t){this.target.value(t.value),this.popup.close()})),n.value(i.value).min(i.min).max(i.max),n.oncheck=this.oncheck,n.target=this,n.popup=t,t.push(n),t.show(this)}}).register(),Object.extend("TreeNode",function(){function t(t,e,i){return t.defineProperty(e,i,{set:function(t){this.hasRender&&this.renderer.set(this,e,t)}})}flyingon.fragment("f.visual",this),this.isTreeNode=!0,this.checkedChildren=0,t(this,"icon",""),t(this,"text",""),t(this,"disabled",!1),this.defineProperty("checked",!1,{set:function(t){for(var e=this.parent;e&&e.isTreeNode;)(t?e.checkedChildren++:--e.checkedChildren)||!e.view||e.checked()||e.renderer.set(e,"checked",!1),e=e.parent;this.hasRender&&this.renderer.set(this,"checked",t),this.trigger("checked-change","value",t)}}),this.defineProperty("collapsed",!0,{set:function(t){this.view&&(t?this.collapse(!1):this.expand(!1,!1))}}),this.defineProperty("delay",!1),this.load=function(t){var e=this.__storage||(this.__storage=flyingon.create(this.__defaults));for(var i in t)switch(i){case"checked":case"collapsed":e[i]=!!t[i];break;case"children":case"items":this.push.apply(this,t[i]);break;default:e[i]=""+t[i]}return this},flyingon.fragment("f.container",this,flyingon.TreeNode),this.__insert_items=function(t,e,i){var n,s,r=this.childrenClass,o=this.hasRender,a=t.length;if(!(a<=0)){for(;e<a;){if((n=t[e])instanceof r?(s=n.parent)&&s.__remove_item(n):t[e]=n=(new r).load(n),n.parent=this,(s=n.onparentchange)&&s.call(n,this),n.__storage.checked)for(s=this;s&&s.isTreeNode;)s.checkedChildren++,s=s.parent;o&&(o=!1,(s=this.__children_patch)?s[1]=1:this.renderer.set(this,"__children_patch",this.__children_patch=[0,1])),e++}return i.apply(this,t)}},this.level=function(){for(var t=flyingon.TreeNode,e=this,i=-1;(e=e.parent)instanceof t;)i++;return i},this.expand=function(t){var e=arguments[1]!==!1;if(e&&!this.collapsed()||this.trigger("before-expand")===!1)e||(this.__storage.collapsed=!0);else{if(e&&this.collapsed(!1),this.trigger("after-expand"),t)for(var i=0,n=this.length;i<n;i++)this[i].expand(!0,!0,!1);this.hasRender&&arguments[2]!==!1&&this.renderer.expand(this)}return this},this.collapse=function(){var t=arguments[0]!==!1;return t&&this.collapsed()||this.trigger("before-collapse")===!1?t||(this.__storage.collapsed=!1):(t&&this.collapsed(!0),this.trigger("after-collapse"),this.hasRender&&this.renderer.collapse(this)),this}}).register(),flyingon.Control.extend("Tree",function(t){function e(t,e,i){return t.defineProperty(e,i,{set:function(t){this.hasRender&&this.renderer.set(this,e,t)}})}this.defaultValue("border",1),this.defaultValue("padding",2),e(this,"theme","default"),e(this,"checked",!1),e(this,"icon",!0),this.defineProperty("editable",!1),this.format=null,flyingon.fragment("f.container",this,flyingon.TreeNode),this.__insert_items=flyingon.TreeNode.init().prototype.__insert_items,this.expand=function(t){for(var e=0,i=this.length;e<i;e++)this[e].expand(t);return this},this.collapse=function(){for(var t=0,e=this.length;t<e;t++)this[t].collapse();return this},this.beginEdit=function(){},this.endEdit=function(){},this.dispose=function(){for(var e=this.length-1;e>=0;e--)this[e].dispose(!1);return t.dispose.apply(this,arguments),this}}).register(),flyingon.GridColumn=Object.extend(function(){var t=(flyingon.GridColumn.columns=flyingon.create(null),this.defineProperty);this.init=function(t){this.grid=t},this.defineProperty=function(e,i,n){if(void 0!==n){switch(n){case 1:n=function(){var t=this.grid;t&&t.refresh(!1,!0)};break;case 2:n=function(){var t=this.grid;t&&t.refresh(!0,!0)};break;case 3:n=function(t){var i=this.grid;i&&i.hasRender&&i.renderer.set(i,"__column_"+e,t)}}n={set:n}}return t.call(this,e,i,n)},this.defineProperty("type",""),this.defineProperty("name","",1),this.defineProperty("title",null,3),this.defineProperty("align","",3),this.defineProperty("width",100,3),this.defineProperty("height",20,3),this.defineProperty("visible",!0,3),this.defineProperty("readonly",!1,3),this.defineProperty("resizable",!0,3),this.defineProperty("sortable",!0),this.defineProperty("operate",!0),this.defineProperty("desc",!1,1),this.defineProperty("formatter",null,1)}),flyingon.GridColumn.extend=function(t,e){},flyingon.GridColumns=Object.extend(function(){flyingon.GridColumn.columns;this.init=function(t){this.grid=t},flyingon.fragment("f.collection",this),this.__insert_items=function(t,e,i){for(var n=flyingon.GridColumn,s=this.grid,r=t.length;e<r;)(t[e]=new n(t[e++])).grid=s;return r=i.apply(this,t),s.refresh(!0,!0),r},this.__remove_items=function(t){if(t){for(var e=t.length-1;e>=0;e--)t[e].grid=null;this.grid.refresh(!0,!0)}},this.__remove_item=function(t){t&&(t.grid=null,this.grid.refresh(!0,!0))}},!1),flyingon.GridRow=Object.extend._(function(){this.grid=null,this.uniqueId=null,this.selected=!1,this.checked=!1,this.cells=null}),flyingon.fragment("f.rows",function(t){flyingon.fragment("f.collection",this,t),this.__insert_items=function(t,e,i){for(var n,s=this.childrenClass,r=this.grid,o=t.length;e<o;)t[e]=n=new s(t[e++]),r?(n.parent=this,n.grid=r):n.grid=this;return i.apply(this,t)},this.__remove_items=function(t){},this.__remove_item=function(t){}}),flyingon.BaseGrid=flyingon.Control.extend(function(t){var e=this.defineProperty;this.defineProperty=function(t,i,n){if(void 0!==n){switch(n){case 1:n=function(){this.refresh(!1,!0)};break;case 2:n=function(){this.refresh(!0,!0)}}n={set:n}}return e.call(this,t,i,n)},this.defineProperty("columns",null,{fn:function(t){var e=this.__columns;return t&&(e.length>0&&e.clear(),"string"==typeof t&&(t=flyingon.parseJSON(t)),t instanceof Array?e.push.apply(e,t):e.push(t)),this.__columns}}),this.defineProperty("rowHeight",28),this.defineProperty("readonly",!0),this.defineProperty("lockedBefore",0),this.defineProperty("lockedAfter",0),this.defineProperty("headerHeight",30),this.defineProperty("selectedMode",0),this.defineProperty("pagination",""),flyingon.fragment("f.rows",this,flyingon.GridRow),this.visibleRows=function(){return this},this.refresh=function(t,e){if(this.hasRender&&this.__visible){var i=this.__view_patch;i&&void 0!==i.refresh?t&&(i.refresh=!0):this.renderer.set(this,"refresh",t||!1),i&&delete i.refresh,e||this.update()}return this}}),flyingon.BaseGrid.extend("Grid",function(t){this.init=function(){this.__columns=new flyingon.GridColumns(this)}}).register(),flyingon.BaseGrid.extend("DataGrid",function(t){this.init=function(){this.__columns=new flyingon.GridColumns(this)},this.defineProperty("dataset",null),this.defineProperty("group","",{})}).register(),flyingon.TreeGridRow=Object.extend._(flyingon.GridRow,function(t){this.childrenClass=flyingon.TreeGridRow,this.parent=null,this.expanded=!1,this.level=function(){for(var t=this.parent,e=0;t;)e++,t=t.parent;return e},flyingon.fragment("f.rows",this,flyingon.TreeGridRow),this.expand=function(){},this.collapse=function(){}}),flyingon.BaseGrid.extend("TreeGrid",function(t){this.defineProperty("dataset",null),this.childrenClass=flyingon.TreeGridRow,this.expand=function(){},this.collapse=function(){}}).register(),flyingon.BaseGrid.extend("VerticalGrid",function(t){this.defineProperty("dataset",null)}),flyingon.Panel.extend("TabPage",function(t){function e(t,e,i){return t[e]=t.defineProperty(e,i,{set:function(t){this.view_head&&this.renderer[e](this,t)}})}this.defaultValue("layout","vertical-line"),this.defineProperty("key",""),e(this,"icon",""),e(this,"text",""),e(this,"buttons",""),e(this,"closable",!1),this.selected=function(){var t,e=this.parent;return e&&(t=e.__storage)&&e[t.selected]===this||!1}}).register(),flyingon.Control.extend("Tab",function(t){this.defineWidth=this.defaultHeight=300,this.defaultValue("border",1),this.__scroll_header=0,this.__reset_header=!0,this.defineProperty("theme","default",{set:function(t){this.hasRender&&this.renderer.set(this,"theme",t)}});var e=function(t,e,i,n){t.defineProperty(e,i,{set:function(t){this.__reset_header=!0,this.__update_dirty||this.invalidate()}})};e(this,"direction","top"),e(this,"header",30),e(this,"offset",2),e(this,"scroll",16),e=function(t,e,i){t.defineProperty(e,i,{set:function(){this.__update_dirty||this.invalidate()}})},e(this,"size",60),e(this,"fill",!1),e(this,"start",0),e(this,"end",0),e(this,"space",2),this.defineProperty("selected",-1,{set:function(t){this.__selectedPage!==!0&&this.selectedPage(this[t],!1)}}),this.selectedPage=function(t){var e,i=this.__selectedPage;return void 0===t?void 0!==i?i:this.__selectedPage=this[this.selected()]:(i===t||t&&t.parent!==this||(i&&i.view_head&&i.renderer.selected(i,!1),t?(t&&t.view_head&&t.renderer.selected(t,!0),this.hasRender&&this.renderer.set(this,"selected",t),e=this.indexOf(t)):(t=null,e=-1),arguments[1]!==!1&&(this.__selectedPage=!0,this.selected(e)),this.__selectedPage=t,this.trigger("tab-change","newValue",t,"oldValue",i)),this)},flyingon.fragment("f.container",this,flyingon.TabPage);var i=this.__remove_items,n=this.__remove_item;this.__remove_items=function(t){var e=this.selected();i.call(this,t),this.selectedPage(this[e]||this[--e]||null)},this.__remove_item=function(t){var e=this.selected();n.call(this,t),this.selectedPage(this[e]||this[--e]||null)},this.findByKey=function(t,e){for(var i=this.length-1;i>=0;i--)if(this[i].key()===t)return e&&this.selected(i),this[i]},this.findByText=function(t,e){for(var i=this.length-1;i>=0;i--)if(this[i].text()===t)return e&&this.selected(i),this[i]}}).register(),flyingon.Panel.extend("Popup",function(){this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("width","auto"),this.defaultValue("height","auto"),this.defineProperty("closeLeave",!1),this.defineProperty("closeAway",!1),this.defineProperty("direction","bottom"),this.defineProperty("align","left"),this.defineProperty("reverse",!0),this.show=function(t,e){return this.renderer.show(this,t,e,this.direction(),this.align(),this.reverse()),this.shown=!0,this},this.showAt=function(t,e){return this.renderer.showAt(this,t,e),this.shown=!0,this},this.close=function(t){return t=t||"ok",this.trigger("closing","closeType",t)!==!1&&(this.hasRender&&this.renderer.close(this),this.shown=!1,this.trigger("closed","closeType",t),this.autoDispose&&this.dispose(),this)}}).register(),flyingon.Panel.extend("Dialog",function(t){var e=[];this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("padding",2),this.defaultValue("movable",!0),this.defineProperty("header",28,{set:function(t){this.hasRender&&this.renderer.set(this,"header",t),this.__update_dirty||this.invalidate()}}),this.defineProperty("icon","",{set:function(t){this.hasRender&&this.renderer.set(this,"icon",t)}}),this.defineProperty("text","",{set:function(t){this.hasRender&&this.renderer.set(this,"text",t)}}),this.defineProperty("closable",!0,{set:function(t){this.hasRender&&this.renderer.set(this,"closable",t)}}),this.onmeasure=function(e){return!!e&&(t.onmeasure.call(this,e),void(2&e&&(this.offsetHeight+=this.header())))},this.arrangeArea=function(){var t=this.header();this.arrangeHeight-=t,this.arrangeBottom-=t},this.show=function(){return this.renderer.show(this),this.shown=!0,this.active(),this},this.showDialog=function(){return this.renderer.show(this,!0),this.shown=!0,this.active(),this},this.moveTo=function(t,e){this.shown&&this.renderer.moveTo(this,t,e)},this.center=function(){this.shown&&this.renderer.center(this)},this.active=function(){var t=e[e.length-1];if(t!==this){var i=e.indexOf(this);i>=0&&e.splice(i,1),e.push(this),t&&(t.renderer.active(t,!1),t.trigger("deactivated")),this.renderer.active(this,!0),this.trigger("activated")}else t&&this.renderer.active(this,!0)},this.activated=function(){return e[e.length-1]===this},this.close=function(t){return t||(t="ok"),this.trigger("closing","closeType",t)!==!1&&(this.hasRender&&this.renderer.close(this),this.shown=!1,e.splice(e.indexOf(this),1),e[0]&&e[e.length-1].active(),this.trigger("closed","closeType",t),this.autoDispose&&this.dispose()),this}}).register(),flyingon.Sublayout=flyingon.Control.extend(function(t){this.defineProperty("scale",0,{check:function(t){return t>0?t:0}}),this.defineProperty("layout",null,{set:function(){this.__layout=null}}),this.defaultWidth=this.defaultHeight=200,this.onmeasure=function(t){return flyingon.arrange(this,this.__children,!1,!1,!0),!!t&&(1&t&&(this.offsetWidth=this.arrangeRight+this.borderLeft+this.borderRight),void(2&t&&(this.offsetHeight=this.arrangeBottom+this.borderTop+this.borderBottom)))},this.onlocate=function(){var t,e=this.__children,i=this.offsetLeft,n=this.offsetTop;if(e&&(i||n))for(var s=e.length-1;s>=0;s--)(t=e[s])&&(t.offsetLeft+=i,t.offsetTop+=n);return!1},this.controlAt=function(t,e){var i=this.__layout;return i?i.controlAt(this.__children,t,e):null},this.update=function(){}}),flyingon.Layout=Object.extend(function(){this.type=null,this.defineProperty("condition",null),this.defineProperty("spacingX","2"),this.defineProperty("spacingY","2"),this.defineProperty("location",null,{set:function(t){this.__location="function"==typeof t?t:null}}),this.defineProperty("sublayouts",null,{set:function(t){this.__sublayouts=!!t}}),this.arrange=function(t,e,i,n){},this.rearrange=function(t,e,i,n){var s=!1;if(i&&(1===i||t.arrangeRight>t.arrangeLeft+t.arrangeWidth)&&((t.arrangeHeight-=flyingon.hscroll_height)<0&&(t.arrangeHeight=0),i=!1,s=!0),n&&(1===n||t.arrangeBottom>t.arrangeTop+t.arrangeHeight)&&((t.arrangeWidth-=flyingon.vscroll_width)<0&&(t.arrangeWidth=0),n=!1,s=!0),s)return t.arrangeRight=t.arrangeLeft,t.arrangeBottom=t.arrangeTop,this.arrange(t,e,i,n),!0},this.controlAt=function(t,e,i){for(var n,s,r=0,o=t.length;r<o;r++)if((n=t[r])&&e>=(s=n.offsetLeft)&&e<=s+n.offsetWidth&&i>=(s=n.offsetTop)&&i<=s+n.offsetHeight)return t[r];return null},flyingon.fragment("f.serialize",this),this.deserialize_type=!0}),function(){function t(t){if(t){if("string"!=typeof t)return i(t);if(t=h[t])return t[1]||(t[1]=i(t[0]))}return new a.flow}function e(t,e,n){for(var s,r,o,h,l=0,f=t.length;l<f;l++)if(r=t[l]){if(o=r.condition){if((h=o.width)&&(e<h[0]||e>h[1]))continue;if((h=o.height)&&(n<h[0]||n>h[1]))continue;s=r;break}s=r}return s?s.__layout||(s.__layout=i(s,!1)):new a.flow}function i(t,e){if("function"==typeof t)return new t;if(e!==!1&&t instanceof Array)return t;var i=new(a[t&&t.type]||a.flow);return i.deserialize(l,t),i}function n(t,e,i,n,a){var h,l,f;if((h=t.__sublayouts)&&(h===!0&&(h=t.__sublayouts=s(t.sublayouts())),r(h,i),i=h),l=t.__location){for(var c=i.length-1;c>=0;c--)f=i[c],l.prototype=f.__storage||f.__defaults,f.__location_values=new l(e,f,c);l.prototype=null}else for(var c=i.length-1;c>=0;c--)f=i[c],f.__location_values=null;n||a?o(t,e,i,n,a):t.arrange(e,i)}function s(t){var e=t.length;e||(t=[t],e=1);for(var i,n,s,r=flyingon.SerializeReader,o=new Array(t.length),a=0,h=0;s=t[--e];)(i=o[e]=new flyingon.Sublayout).deserialize(r,s),(n=i.scale())?((i.fixed=s=0|n)&&(a+=s),(i.weight=s=n-s)&&(h+=s)):(i.fixed=0,h+=i.weight=1);return o.fixed=a,o.weight=h,o}function r(t,e){var i=e.length-t.fixed,n=t.weight,s=0;i<0&&(i=0);for(var r=0,o=t.length;r<o;r++){var a,h=t[r],l=h.fixed,f=h.weight;f&&(a=i*f/n|0,n-=f,l+=a,i-=a),h.__children=e.slice(s,s+=l)}}function o(t,e,i,n,s){var r,o;n&&e.hscroll&&((e.arrangeHeight-=flyingon.hscroll_height)<0&&(e.arrangeHeight=0),r=!0),s&&e.vscroll&&((e.arrangeWidth-=flyingon.vscroll_width)<0&&(e.arrangeWidth=0),o=!0),t.arrange(e,i,!r&&n,!o&&s),(r=r&&e.arrangeRight<=e.arrangeLeft+e.arrangeWidth)&&(e.arrangeHeight+=flyingon.hscroll_height),(o=o&&e.arrangeBottom<=e.arrangeTop+e.arrangeHeight)&&(e.arrangeWidth+=flyingon.vscroll_width),(r||o)&&t.arrange(e,i)}var a=flyingon.create(null),h=flyingon.create(null),l=new flyingon.SerializeReader;flyingon.Layout.extend=function(t,e){t&&e&&(e=flyingon.defineClass(flyingon.Layout,e),h[t]=[a[t]=e,null])},flyingon.layout=function(t,e){return t&&e&&"function"!=typeof e?void(h[t]=[e,null]):flyingon.load.key("layout",t,e)},flyingon.arrange=function(t,e,i,s,r){var o,a=2&t.__auto_size;t.arrangeLeft=t.paddingLeft,t.arrangeTop=t.paddingTop,o=t.borderLeft+t.borderRight+t.paddingLeft+t.paddingRight,o=t.offsetWidth-o,t.arrangeWidth=o>0?o:0,a?o=0:(o=t.borderTop+t.borderBottom+t.paddingTop+t.paddingBottom,o=t.offsetHeight-o,o<0&&(o=0)),t.arrangeHeight=o,(o=t.arrangeArea)&&(o.call(t),a&&(t.arrangeHeight=0)),t.arrangeRight=t.arrangeLeft,t.arrangeBottom=t.arrangeTop,e&&e.length>0?(n(o=flyingon.getLayout(t),t,e,i,s,r),i&&(t.__hscroll=t.arrangeRight>t.arrangeLeft+t.arrangeWidth),s&&(t.__vscroll=t.arrangeBottom>t.arrangeTop+t.arrangeHeight),t.arrangeRight+=t.paddingRight,t.arrangeBottom+=t.paddingBottom):t.__hscroll=t.__vscroll=!1},flyingon.getLayout=function(i){var n,s=i.__layout;return s||"function"!=typeof(n=i.layout)||(s=i.__layout=t(n.call(i))),s instanceof Array&&(s=e(s,i.offsetWidth,i.offsetHeight)),s}}(),flyingon.Layout.extend("fill",function(t){this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=0,f=e.length;l<f;l++)s=e[l],s.measure(a,h,a,h,3),s.locate(r,o,a,h)}}),flyingon.Layout.extend("line",function(t){this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=r+a,f=flyingon.pixel(this.spacingX(),a),c=0,u=e.length;c<u;c++){if(s=e[c],s.measure(a,h,l-r||-1,h,2),s.locate(r,o,0,h,t),i&&t.arrangeRight>l)return this.rearrange(t,e,1,!1);r=t.arrangeX+f}}}),flyingon.Layout.extend("vertical-line",function(t){this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=o+h,f=flyingon.pixel(this.spacingY(),h),c=0,u=e.length;c<u;c++){if(s=e[c],s.measure(a,h,a,l-h||-1,1),s.locate(r,o,a,0,t),n&&t.arrangeBottom>l)return this.rearrange(t,e,!1,1);o=t.arrangeY+f}}}),flyingon.Layout.extend("flow",function(t){this.defineProperty("lineHeight","0",{dataType:"integer",check:function(t){return t>0?t:0}}),this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=r+a,f=o+h,c=flyingon.pixel,u=c(this.spacingX(),a),d=c(this.spacingY(),h),_=c(this.lineHeight(),h),p=r,g=0,v=e.length;g<v;g++){if((s=e[g]).measure(a,h,l-r||-1,_||-1),r>p&&r+s.offsetWidth+s.marginRight>l&&(r=p,o=(_?o+_:t.arrangeBottom)+d),s.locate(r,o,0,_,t),n&&t.arrangeBottom>f)return this.rearrange(t,e,!1,1);r=t.arrangeX+u}}}),flyingon.Layout.extend("vertical-flow",function(t){this.defineProperty("lineWidth","0",{dataType:"integer",check:function(t){return t>0?t:0}}),this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=r+a,f=o+h,c=flyingon.pixel,u=c(this.spacingX(),a),d=c(this.spacingY(),h),_=c(this.lineWidth(),a),p=o,g=0,v=e.length;g<v;g++){if((s=e[g]).measure(a,h,_||-1,f-o||-1),o>p&&o+s.offsetHeight+s.marginBottom>f&&(r=(_?r+_:t.arrangeRight)+u,o=p),s.locate(r,o,_,0,t),i&&t.arrangeRight>l)return this.rearrange(t,e,1,!1);o=t.arrangeY+d}}}),flyingon.Layout.extend("dock",function(t){this.arrange=function(t,e,i,n){for(var s,r,o=t.arrangeLeft,a=t.arrangeTop,h=t.arrangeWidth,l=t.arrangeHeight,f=t.arrangeRight=o+h,c=t.arrangeBottom=a+l,u=h,d=l,_=flyingon.pixel,p=_(this.spacingX(),h),g=_(this.spacingY(),l),v=0,y=e.length;v<y;v++)switch(r=e[v],r.locationValue("dock")){case"left":r.measure(u,d,h,l,2),r.locate(o,a,0,l),o=r.offsetLeft+r.offsetWidth+r.marginRight+p,(h=f-o)<0&&(h=0);break;case"top":r.measure(u,d,h,l,1),r.locate(o,a,h,0),a=r.offsetTop+r.offsetHeight+r.marginBottom+g,(l=c-a)<0&&(l=0);break;case"right":r.measure(u,d,h,l,2),f-=r.offsetWidth-r.marginLeft-r.marginRight,r.locate(f,a,0,l),(h=(f-=p)-o)<0&&(h=0);break;case"bottom":r.measure(u,d,h,l,1),c-=r.offsetHeight-r.marginTop-r.marginBottom,r.locate(o,c,h,0),(l=(c-=g)-a)<0&&(l=0);break;default:(s||(s=[])).push(r);continue}if(s)for(var v=0,y=s.length;v<y;v++)r.measure(u,d,h,l,3),r.locate(o,a,h,l)}}),flyingon.Layout.extend("cascade",function(t){this.arrange=function(t,e,i,n){for(var s,r=t.arrangeLeft,o=t.arrangeTop,a=t.arrangeWidth,h=t.arrangeHeight,l=0,f=e.length;l<f;l++)s=e[l],s.measure(a,h),s.locate(r,o,a,h,t);(i||n)&&this.rearrange(t,e,i,n)},this.controlAt=function(t,e,i){return-1}}),flyingon.Layout.extend("absolute",function(t){this.arrange=function(t,e,i,n){for(var s,r,o,a,h=t.arrangeLeft,l=t.arrangeTop,f=t.arrangeWidth,c=t.arrangeHeight,u=h+f,d=l+c,_=flyingon.pixel,p=0,g=e.length;p<g;p++)s=e[p],r=s.__location_values||s.__storage||s.__defaults,o=h+_(r.left,f),a=l+_(r.top,c),s.measure(f,c,u-h,d-l),s.locate(o,a,0,0,t)},this.controlAt=function(t,e,i){return-1}}),flyingon.Layout.extend("uniform",function(t){this.defineProperty("size",20),this.arrange=function(t,e,i,n){for(var s,r,o=t.arrangeLeft,a=t.arrangeTop,h=t.arrangeWidth,l=t.arrangeHeight,f=e.length,c=this.size(),u=f-1,d=h-c*f,_=0;_<f;_++)(s=e[_]).measure(h,l,c,l,3),s.locate(o,a,0,l,t),r=d/u|0,o+=s.offsetWidth+r,d-=r,u--},this.controlAt=function(t,e,i){for(var n,s,r=0,o=t.length;r<o;r++)if((n=t[r])&&e>=(s=n.offsetLeft)&&e<=s+n.offsetWidth)return t[r];return null}}),flyingon.Layout.extend("table",function(t){function e(t,e,n,s,r,o,a,h){for(var l,f,c,u=s.width,d=0,_=s.length;d<_;d++)if((l=s[d])&&!l.disabled)if(c=l.group){if(o=i(t,e,n,c,r,o,a,h+l.start),o<0)return-1}else{if(!(f=r[o++]))return-1;f.measure(e,n,u,c=l.size,3),f.locate(a,h+l.start,u,c,t)}return o}function i(t,i,n,s,r,o,a,h){for(var l,f,c,u=s.height,d=0,_=s.length;d<_;d++)if((l=s[d])&&!l.disabled)if(c=l.group){if(o=e(t,i,n,c,r,o,a+l.start,h),o<0)return-1}else{if(!(f=r[o++]))return-1;f.measure(i,n,c=l.size,u,3),f.locate(a+l.start,h,c,u,t)}return o}function n(t){var e,i=r[t];return i?i.clone():(i=new l,(e=s(t||(t="")).match(a))&&i.parse(e,0),r[t]=i)}function s(t){function e(t,e,n){var s=[];do s.push(e);while(--n>0);return i=!0,s.join(" ")}var i,n=o;do i=!1,t=t.replace(n,e);while(i);return t}var r=flyingon.create(null),o=/L([^L\^]+)\^(\d+)/g,a=/[*%.\w]+|[\[\]{}()!]/g;this.defineProperty("vertical",!1),this.defineProperty("data","*[* * *] *[* * *] *[* * *]",{set:function(){this.__data=null}}),this.defineProperty("auto",0),this.arrange=function(t,s,r,o){var a=this.__data||(this.__data=n(this.data())),h=this.vertical(),l=t.arrangeWidth,f=t.arrangeHeight,c=flyingon.pixel,u=c(this.spacingX(),l),d=c(this.spacingY(),f);a.measure(l,f,u,d,h,this.auto(),s),(h?i:e)(t,l,f,a,s,0,t.arrangeLeft,t.arrangeTop),(r||o)&&this.rearrange(t,s,r,o)};var h=Object.extend(function(){this.value=0,this.unit="",this.disabled=!1,this.group=null,this.start=0,this.size=0,this.clone=function(){var t,e=new h;return e.value=this.value,e.unit=this.unit,e.size=this.size,e.disabled=this.disabled,(t=this.group)&&(e.group=t.clone()),e}},!1),l=Object.extend(function(){function t(t,e){for(var i,n=this.length,s=t;s<e;s++)if(i=this[s]){switch(i.unit){case"*":this.weight+=i.value;break;case"%":this.persent.push(i.value);break;default:this.fixed+=i.value}this[n++]=i.clone()}this.length=n}function e(e,i){var n,s,r;if(e===!1)(e=this.__auto)&&([].splice.call(this,e.length),this.fixed=e.fixed,this.weight=e.weight,(r=e.persent)&&this.persent.splice(r));else if(e>0&&(i-=this.count())>0&&((n=(s=this.length)-e)<0&&(n=0),(e=this.count(n))>0)){this.__auto={length:s,fixed:this.fixed,weight:this.weight,persent:(r=this.persent)&&r.length},e=Math.ceil(i/e);for(var o=0;o<e;o++)t.call(this,n,s);return this.length}}var i=flyingon.pixel,n=parseFloat;this.length=0,this.fixed=0,this.weight=0,this.persent=null,this.parameters=null,this.start=0,this.size=0,this.parse=function(t,e){for(var s,r,o,a=this.length;s=t[e++];)switch(s){case"[":case"{":r||(r=this[a++]=new h,r.value=100,r.weight=100,this.width+=100),e=(r.group=new l).parse(t,e);break;case"]":case"}":return this.length=a,e;case"(":for(;")"!==(s=t[e++]);)s.indexOf("%")<0&&(s=i(s)),(this.parameters||(this.parameters=[])).push(s);break;case"!":r&&(r.disabled=!0);break;default:if(r=this[a++]=new h,"*"===s)r.value=100,r.unit="*",this.weight+=100;else if((o=n(s))===o){switch(r.unit=s.replace(o,"")){case"*":this.weight+=o;break;case"%":(this.percent||(this.persent=[])).push(this.value);break;default:this.fixed+=o=r.size=i(s)}r.value=o}}return this.length=a,e},this.count=function(t){var e,i=0;for(t|=0;e=this[t++];)e.disabled||((e=e.group)?i+=e.count():i++);return i},this.measure=function(t,i,n,s,r,o,a){var h=[t,i,n,s,r,o,0];o>0?h[6]=e.call(this,o,a.length):this.__auto&&e.call(this,!1),this.__keys!==(h=h.join(","))&&(this.compute(t,i,n,s,r),this.__keys=h)},this.compute=function(t,e,n,s,r){var o,a,h,l,f=this.parameters,c=this.weight,u=0,d=this.length;if(this.width=t,this.height=e,f&&((l=f[0])&&(n=l>0?l:i(l,n)),(l=f[1])&&(s=l>0?l:i(l,s))),(r=!r)?(a=e,h=s):(a=t,h=n),a>0&&(f=this.persent)){f=f.slice(0),l=0;for(var _=f.length-1;_>=0;_--)l+=f[_]=a*f[_]/100+.5|0;(a-=l)<0&&(a=0),f.index=0}a>0&&(a-=this.fixed+h*(d-1))<0&&(a=0);for(var _=0;_<d;_++)if(o=this[_]){switch(o.unit){case"*":a>0?(l=o.value,a-=o.size=l*a/c|0,c-=l):o.size=0;break;case"%":o.size=f[f.index++]||0}o.start=u,u+=o.size+h,(l=o.group)&&(r?l.compute(t,o.size,n,s,r):l.compute(o.size,e,n,s,r))}},this.clone=function(){var t,e=new this.Class,i=this.length;if(e.length=i,e.fixed=this.fixed,e.weight=this.weight,e.parsent=(t=this.persent)&&t.slice(0),e.parameters=this.parameters,(t=this.length)>0)for(var n=0;n<t;n++)e[n]=this[n].clone();return e}},!1)}),function(t){function e(t){var e,n,s=this.Class.__widget_template,r=this.Class.__widget_options,o=s.analyse(),a=r.creating,h=r.created;if(s=s.ast,o){o=g(n=o,""),e=r.defaults,"function"==typeof e&&(e=e.call(this,o.prototype));for(name in n)n[name]&&i(this,name,e&&e[name]||null);(n=r.extend)&&n.call(this,o.prototype),this.init=function(){var t,i=this.vmodel=new o(null,e);(t=a)&&t.call(this,i),j(this,i,s),(t=h)&&t.call(this,i)},this.dispose=function(){var e=this.vmodel;return e&&(e.$dispose(),this.vmodel=null),t.dispose.apply(this,arguments),this}}else(n=r.extend)&&n.call(this,{}),this.init=function(){var t;(t=a)&&t.call(this,{}),this.deserialize(V,s),(t=h)&&t.call(this,{})}}function i(t,e,i){var s=e,r=e;e.indexOf("-")>0?s=e.replace(/-(\w)/g,n):r=e.replace(/([A-Z])/g,"-$1").toLowerCase(),t[r]=t.defineProperty(s,i||null,{set:function(t){this.vmodel.$set(e,t)}})}function n(t,e){return e.toUpperCase()}function s(e,i){if(!i)throw e+" options must input a object!";var n=i.template;if(!n)throw e+" options template not allow empty!";return"string"==typeof n&&"#"===n.charAt(0)&&(n=(n=t.dom_id(n))&&n.innerHTML||""),new t.view.Template(n)}function r(t,e){if("function"==typeof t)e=t,t="*";else if("function"!=typeof e)throw"watch must input a function!";return(this.__watches||(this.__watches=[])).push(t||"*",e),this}function o(t,e,i,n){var s,r,o,a,h=t;do if(s=h.__watches)for(o=0;a=s[o++];)"*"===a||"*"===e||a===e?s[o++].call(h,r||(r={target:t,name:e,newValue:i,oldValue:n})):o++;while(h=h.__parent)}function a(t,e,i,n){var s;switch(n[1]){case 0:return n[3]&&(e=h(t,e,i,n)),(s=M)&&d(e,n[2],s),e[n[2]];case 1:return i&&(i=i[n[2]])?(e=i.__loop_vm,!n[0]&&(s=M)&&_(e,i,s),e[i.__loop_index]):c(t,n[2]);case 2:return i?(i=i[n[2]],(s=M)&&_(i.__loop_vm,i,s),i.__loop_index):u(t,n[2]);case 3:return l(t,e,i,n)}}function h(t,e,i,n){var s=n[3],r=s[0],o=1;for(e=1===r[1]?i&&(i=i[r[2]])?i.__loop_vm[i.__loop_index]:c(t,r[2]):(e.__top||e)[r[2]];r=s[o++];)e=e[r[2]];return e}function l(t,e,i,n,s){var r,o=n[4],h=[],l=0;if(e=e.__top||e,o=n[4])for(;r=o[l++];)h.push(a(t,e,i,r));return h.push(t),s&&h.push(s),e[n[2]].apply(e,h)}function f(t,e){return function(i){l(this,t,null,e,i)}}function c(t,e){var i;do if((i=t.__loop_vm)&&i.__item_name===e)return i[t.__loop_index];while(t=t.parent)}function u(t,e){var i;do if((i=t.__loop_vm)&&i.__index_name===e)return t.__loop_index;while(t=t.parent);return-1}function d(t,e,i){var n=t.__depends||(t.__depends=q(null));K.apply(n[e]||(n[e]=[]),i)}function _(t,e,i){var n=n=t.__depends||(t.__depends=q(null)),s=e.__uniqueId||(e.__uniqueId=Y.id++);K.apply(n[s]||(n[s]=[]),i)}function p(t,e,i){for(var n,s=0;n=i[s++];)n.set(i[s++],a(n,t,e,i[s++]))}function g(e,i){function n(t,e){var i,n;if(this.__top=(this.__parent=t)?t.__top:this,e){if("object"==typeof e){i=this.__keys1;for(var s in i)(n=i[s])?this[s]=new n(this,e[s]):this[s]=e[s]}else if(t)throw'"'+this.$name+'" must input a object!'}else{i=this.__keys2;for(var s in i)this[s]=new i[s](this);e=null}this.$data=e}var s=n.prototype,o=s.__keys1=q(null),a=s.__keys2=q(null);s.$name=i,s.$watch=r,s.$get=v,s.$set=y,s.$replace=m,s.$update=b,s.$dispose=w,i||(s.eventBubble="__up_vm",s.$on=t.on,s.$once=t.once,s.$off=t.off,s.$trigger=t.trigger);for(var i in e){var h=e[i];if(!(h[1]>0))switch(h[0]){case 1:o[i]=a[i]=g(h[4],h[1]);break;case 2:o[i]=a[i]=x(h);break;default:o[i]=0}}return n}function v(t){var e;return(e=M)&&d(this,t,e),this[t]}function y(t,e){var i=this.__keys1[t];return i?(i=this[t])&&(i.$replace(e),o(this,t,e,i)):0===i&&(i=this[t])!==e&&(this[t]=e,o(this,t,e,i),(i=this.__depends)&&(i=i[t])&&p(this,null,i)),this}function m(t,e){var i=this.__keys1,n=this.$data;this.$data=t=t&&"object"==typeof t?t:null;for(var s in i)i[s]?this[s].$replace(t&&t[s],!1):(t||n)&&(this[s]=t&&t[s]);e!==!1&&this.$update()}function b(){var t=this.__depends;if(t)for(var e in t)p(this,null,t[e]);if(t||this.__top.__created){t=this.__keys2;for(var e in t)this[e].$update()}}function w(){var t=this.__keys1;for(var e in t)t[e]?this[e].$dispose():this[e]=null;this.__top=this.__parent=this.__depends=this.__watches=this.$data=null}function x(t){function e(t,e){var i=this.__item_fn,n=e&&e.length;if(this.__top=(this.__parent=t).__top,n>0)if(i){this.length=n;for(var s=0;s<n;s++)this[s]=new i(this,e[s])}else K.apply(this,e)}var i=e.prototype=q(F);return i.__item_name=t.item,i.__index_name=t.index,i.$name=t[2],i.$watch=r,i.$get=k,i.$set=C,i.$replace=P,i.$update=T,i.$dispose=R,1===t[0]||(t=t[4])&&1===t[0]?i.__item_fn=g(t[4],t[2]):t&&2===t[0]&&(i.__item_fn=x(t[4])),e}function k(t){var e;return(e=M)&&_(this,this.__controls[t],e),this[t]}function C(t,e){var i;return t>=0?t<this.length&&(i=this[t],i&&i.$replace?i.$replace(e):i!==e&&(this[t]=e,(i=this.__depends)&&(t=this.__controls[t])&&(t=t.__uniqueId)&&(i=i[t])&&p(this,null,i))):"length"===t&&this.splice(e),this}function P(t,e){var i,n=this.length,s=0|(t&&t.length);if(s<=0)return n>0&&this.splice(0),this;if(n>s&&(this.splice(s),n=s),n>0){if(this.__item_fn)for(var r=0;r<n;r++)this[r].$replace(t[r]);else i=G.call(t,0,n),i.unshift(0,n),J.apply(this,i);e!==!1&&this.$update()}return n<s&&this.push.apply(this,G.call(t,n)),this}function T(t){var e=this.__depends;if(e)for(var i in e)p(this,null,e[i]);if(t!==!1&&this.__item_fn&&this.__controls)for(var n=0,s=this.length;n<s;n++)this[n].$update()}function R(){if(this.__item_fn)for(var t=this.length-1;t>=0;t--)this[t].$dispose();return this.__top=this.__parent=this.__depends=this.__watches=this.__controls=this.__template=this.__tag=this.__container=null,this}function L(t,e,i){for(var n=t.__item_fn,s=i,r=e.length;s<r;s++)e[s]=new n(t,e[s])}function B(t,e){var i,n,s=t.__controls;s&&(i=s[e],s.splice(e,1),i&&(n=t.__depends)&&delete n[i.__uniqueId],(n=t.__container)&&n.splice(e,1)),t.__item_fn&&t[e].$dispose()}function H(t,e,i){var n,s=t.__controls,r=t.__depends,o=i.length;if(s){if(r)for(var a=0;a<o;a++)(n=s[e+a])&&delete r[n.__uniqueId];s.splice(e,o),(n=t.__container)&&n.splice(e,o)}if(t.__item_fn)for(var a=0;a<o;a++)i[a].$dispose()}function N(t,e,i){for(var n,s=t.__controls,r=e,o=s.length;r<o;r++)(n=s[r])&&(n.__loop_index+=i);t.__index_name&&t.__depends&&t.$update(!1)}function O(t,e){var i,n=t.__container;if(n){for(var s=e.length-1;s>=0;s--)(n[s]=i=e[s]).__loop_index=s;t.__depends&&t.$update(!1),n.renderer.set(n,"__view_order"),n.invalidate()}}function j(t,e,i){var n,s=q(null);e.__created=!0,t.tagName=i.Class,S(t,e,s,i),(n=i.children)&&W(t,e,s,n,E)}function A(t,e,i,n,s){var r,o;return o=i.Class,r=new(s||n[o]||$),r.tagName=o,(o=r.vm)&&(o.__up_vm=t.__top),S(r,t,e,i),(o=i.children)&&W(r,t,e,o,n),r}function S(t,e,i,n){var s,r,o=M=U;o[0]=t;for(var l in n)switch(l){case"Class":case"children":case"#loop":break;case"#model":(r=t[l])&&(s=n[l],r.call(t,s[3]?h(t,e,i,s):e,s[2]));break;default:switch(s=n[l],l.charAt(0)){case":":o[1]=l=l.substring(1),o[2]=s,t.set(l,a(t,e,i,s));break;case"@":t.on(l.substring(1),f(e,s));break;case"#":(r=t[l])&&(o[1]=l,o[2]=s,r.call(t,a(t,e,i,s)));break;default:s&&"string"==typeof s&&"{"===s.charAt(0)&&(r=s.match(/^\{\{(\w+)\}\}$/))?t.addBind(l,r[1]):t.set(l,s)}}M=null}function W(t,e,i,n,s){for(var r,o=[],a=0,h=n.length;a<h;a++)(r=n[a])&&r["#loop"]?o.push.apply(o,z(t,e,i,r,s)):o.push(A(e,i,r,s));o[0]&&t.push.apply(t,o)}function z(t,e,i,n,s){var r,o=[],a=n["#loop"],l=a[2];return e=a[3]?h(t,e,i,a)[l]:(r=i&&i[l])?r.__loop_vm[r.__loop_index]:e[l],e.__template=n,e.__container=t,e.__controls=o,e.__tag=t.lastChild,(r=e.length)>0&&D(o,e,0,r,i,s),o}function D(t,e,i,n,s,r){var o,a,h=e.__top,l=e.__template,f=l.Class,c=r[f]||$,u=l["#loop"],d=u.item,_=u.index;if(d||_){for(;i<n;)o=new c,o.tagName=f,(a=o.vm)&&(a.__up_vm=h),o.__loop_vm=e,o.__loop_index=i++,d&&(s[d]=o),_&&(s[_]=o),S(o,h,s,l),t.push(o),(a=l.children)&&W(o,h,s,a,r);d&&(s[d]=null),_&&(s[_]=null)}else for(;i++<n;)t.push(o=A(h,s,l,r,c))}function I(t,e,i){for(var n,s,r=[],o=t.__container,a=t.__controls,h=o,l={};h;)(s=h.__item_vm)&&((n=s.item)&&(l[n]=h),(n=s.index)&&(l[n]=h)),h=h.parent;D(r,t,e,i,l,E),s=(s=a[0])?o.indexOf(s):(s=t.__tag)?o.indexOf(s)+1:0,r.unshift(e,0),a.splice.apply(a,r),r[0]+=s,o.splice.apply(o,r)}var M,E=t.components,$=t.HtmlElement,V=new t.SerializeReader,Y=t.__uniqueId,q=t.create,X=Array.prototype,F=q(X),G=X.slice,K=X.push,J=X.splice,U=[null,null,null];t.view=function(t){var e,i,n,r=s("view",t),o=t.defaults;return r.parse(),(i=r.analyse())&&(i=new(g(i,""))(null,o)),r=r.ast,e=t.control||new(E[r.Class]||$),(n=t.creating)&&n.call(e,i||{}),i?j(e,e.vmodel=i,r):e.deserialize(V,r),(n=t.created)&&n.call(e,i||{}),(n=t.host)&&e.mountTo(n),e},t.widget=function(t,i){"string"!=typeof t&&(i=t,t="");var n=s("widget",i),r=E[n.parse().Class]||$;return r=r.extend(e),r.__widget_options=i,r.__widget_template=n,t?r.register(t,i.force):r.init(),r},F.push=function(t){var e=this.length,i=arguments.length;return i>0&&(this.__item_fn&&L(this,arguments,0),K.apply(this,arguments),this.__controls&&I(this,e,e+=i)),e},F.pop=function(){var t=this.length;if(t>0)return B(this,t-1),X.pop.call(this)},F.unshift=function(t){var e=arguments.length;return e>0&&(this.__item_fn&&L(this,arguments,0),X.unshift.apply(this,arguments),this.__controls&&I(this,0,e),e<this.length&&N(this,e,e)),this.length},F.shift=function(){var t;if(this.length>0)return B(this,0),t=X.shift.call(this),this.length>1&&N(this,0,-1),t},F.splice=function(t,e){var i,n=this.length,s=arguments.length;return(t|=0)<0&&(t+=n)<0?t=0:t>n&&(t=n),s>2&&this.__item_fn&&L(this,arguments,2),i=J.apply(this,arguments),i.length>0&&H(this,t,i),(s-=2)>0&&this.__controls&&I(this,t,t+=s),t<this.length&&(s-=i.length)&&N(this,t,s),i},F.sort=function(t){var e=X.sort,i=this.length;if(i>1){var n,s=this.__controls;if(this.__item_fn)if(s){for(var r=i-1;r>=0;r--)this[r].__control=s[r];e.call(this,t);for(var r=i-1;r>=0;r--)n=this[r],s[r]=n.__control,n.__control=null;O(this,s)}else e.call(this,t);else e.call(this,t),s&&this.$update()}},F.reverse=function(){if(this.length>1){var t=this.__controls,e=X.reverse;this.__item_fn?t?(e.call(this),t.reverse(),O(this,t)):e.call(this):(e.call(this),t&&this.$update())}}}(flyingon),flyingon.view.Template=Object.extend(function(){function t(t,i){for(var n,s,r,o,a,h=/[^\w-]/,l=/[^\w-:#@]/,f=[],c=0;o=t[c++];)switch(o){case"<":if(n)throw e(o,s);if(o=t[c++],"/"===o){if(!s||t[c]!==s.Class||">"!==t[c+1].charAt(0))throw'"'+o+t[c]+t[c+1]+'" not a valid close tag!';c++,f.pop(),s=f[f.length-1];break}if(o.match(h))throw'"'+o+'" not a valid node name!';a={Class:o},s?(s.children||(s.children=[])).push(a):i.push(a),f.push(s=a),n=!0;break;case"/":if(n&&">"===t[c++]){n=!1,r&&(s[r]=!0,r=null),f.pop(),s=f[f.length-1];break}throw e(o,s);case">":n&&(n=!1,r&&(s[r]=!0,r=null));break;case"=":if(n&&r){switch(o=t[c++]){case"<":case">":case"/":case"=":throw e(o,s)}a=o.charAt(0),a='"'===a||"'"===a?o.substring(1,o.length-1):o,s[r]=a,r=null;break}throw e(o,s);default:if(n)if(r&&(s[r]=!0),n=o.charAt(0),s&&">"===n)r=null,n=!1,(o=o.substring(1)).indexOf("&")>=0&&(o=flyingon.html_decode(o)),s.text=o;else{if(o.match(l))throw'"<'+s.Class+"..."+o+'" not a valid attribute name!';r=o}}return i}function e(t,e){return'"'+(e?"<"+e[0]+"...":"")+t+'" has syntax error!'}function i(t,e){var s,l;(s=e.Class)&&(s=h[s])&&(l=e.children)&&l[0]&&a(s,e,l);for(var f in e){switch(f){case"Class":case"children":case"#loop":l=null;break;default:l=e[f]}if(l)switch(f.charAt(0)){case"#":case":":e[f]=l.indexOf("(")>0?o(t,l):r(t,l,0,0);break;case"@":e[f]=o(t,l)}}if(e=e.children)for(l=0;s=e[l++];)(s["#loop"]?n:i)(t,s)}function n(t,e){var n,o,a,h,l=e["#loop"].match(/[\w.-]+/g);l&&(n=l[0])?(n=r(t,n,2,0),(o=l[1])&&(s(t,o),h=n[4]=t[n.item=o]=[0,1,o,null,null,0],h.loop=n,(a=l[2])&&(s(t,a),t[n.index=a]=n[5]=[0,2,a,null,null,0])),i(t,e),o&&(t[o]=0,h[0]||h[5]||(n.item=n[4]=null),a&&(t[a][5]||(n[5]=n.index=null),t[a]=0))):i(t,e),e["#loop"]=n}function s(t,e){if(e.indexOf(".")>=0)throw'loop "'+e+'" can not include "."!';if(t[e])throw'loop "'+e+'" has be used!'}function r(t,e,i,n){for(var s,r=e.match(/[\w-]+/g),o=null,a=0,h=r.length-1;a<h;a++){if(s=t[e=r[a]])switch(s[0]){case 1:t=s[4];break;case 0:s[0]=1,t=s[4]||(s[4]={})}else{if(0===s)throw'"'+e+'" is out of scope range!';s=t[e]=[1,0,e,o?o.slice(0):null,t={}]}o?o.push(s):o=[s]}if(s=t[e=r.pop()]){if(i){if(s[0])throw'"'+e+'" has be used!';s[0]=i}else s[1]&&s[5]++;return s}if(0===s)throw'"'+e+'" is out of scope range!';return t[e]=[i,n,e,o,null]}function o(t,e){var i,n,s,o,a=e.match(/[\w-.]+/g);if((e=a[0]).indexOf(".")>=0)throw'function "'+e+'" can not include "."!';if((n=t[e])&&2!==n[1])throw'function name "'+e+'" has be used!';if(n=t[e]=[0,3,a[0],null,null],a[1]){for(i=[],s=1;e=a[s++];)(o=t[e])?o[5]++:o=r(t,e,0,0),i.push(o);n[4]=i}return n}function a(t,e,i){for(var n=t[0],s=t[1]||n,r="string"==typeof n,o=0,a=i.length;o<a;o++)(r?i[o].Class===n:n.test(i[o].Class))||(i[o]={Class:s,children:[i[o]]})}var h=flyingon.view.rule=flyingon.create(null);this.init=function(t){"string"==typeof t?this.template=t:this.ast=t},this.parse=function(e){var i,n=this.ast;if(!n&&(i=this.template)){if(i=i.replace(/<!--[\s\S]*?-->/g,"").replace(/>\s+<\s*\//g,"></"),i=i.match(/[<=\/]|[\w-:#@]+|\>[^<>]+(?=\<\s*\/)|[>\/]|"[^"]*"|'[^']*'/g),n=t(i,[]),!e&&n instanceof Array){if(n[1])throw"template can only one root node!";n=n[0]}if(!n)throw"template can not be empty!";if(n["#loop"])throw'template root nood can not use "#loop"!';this.ast=n}return n},this.analyse=function(){var t,e=this.vm;if(void 0===e&&(t=this.ast||this.parse())){i(e={},t);for(t in e)return this.vm=e;return this.vm=null}return e},h.table=[/tbody|thead|tfoot/,"tbody"],h.thead=h.tbody=h.tfoot=["tr"],h.tr=[/td|th/,"td"],h.ol=h.ul=["li"],h.dl=["dt"],h.dt=["dd"],h.select=["option"]},!1),function(t,e){function i(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new l(e))}function n(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new f(e))}function s(t,e){var i,n,s=this.view,r=s.getBoundingClientRect(),o=0,a="";return"x"!==t&&(i=e.clientY-r.top,i>=0&&i<=4?(o=1,a="s"):(n=this.offsetHeight,i>=n-4&&i<=n&&(o=2,a="n"))),"y"!==t&&(i=e.clientX-r.left,i>=0&&i<=4?(o|=4,a+="e"):(n=this.offsetWidth,i>=n-4&&i<=n&&(o|=8,a+="w"))),a?a+="-resize":(t=this.__style)&&(a=t.cursor),s.style.cursor=a||"",o}function r(t){var e=t.side;1===(1&e)?this.height(t.height-t.distanceY):2===(2&e)&&this.height(t.height+t.distanceY),4===(4&e)?this.width(t.width-t.distanceX):8===(8&e)&&this.width(t.width+t.distanceX)}function o(t){if(this.trigger("move-start")!==!1){var i,n=this.view,s=n.cloneNode(!0),r=n.style,o=n.getBoundingClientRect(),a={dom:s,left:o.left,top:o.top},h=this;for(r.borderStyle="dashed",r.borderColor="red",r=s.style,r.opacity=.2,r.left=o.left+"px",r.top=o.top+"px",e.body.appendChild(s);i=h.parent;)h=i;return o=h.view.getBoundingClientRect(),a.host=h,a.offsetX=t.clientX-o.left,a.offsetY=t.clientY-o.top,a}}function a(t,e){var i=t.dom.style,n=t.distanceX,s=t.distanceY,r=t.host.findDropTarget(t.offsetX+n,t.offsetY+s),o=r[0],a=r[1];a?this!==a&&o.splice(o.indexOf(a),0,a):this.parent!==o,i.left=t.left+n+"px",i.top=t.top+s+"px",this.trigger("move")}function h(t,e){var i,n=t.dom,s=n.style,r=this.view.style;(i=n.parentNode)&&i.removeChild(n),r.borderStyle=s.borderStyle,r.borderColor=s.borderColor,this.trigger("move-end")}var l=t.MouseEvent,f=t.KeyEvent,c=t.dom_on,u=null,d=0,_=null;t.findControl=function(e){for(var i;e;){if(i=e.flyingon_id)return t.__uniqueId[i];e=e.parentNode}},c(e,"mousedown",function(e){var i,n,s=t.findControl(e.target);s&&!s.disabled()&&s.trigger(u=new l(e))!==!1&&((n=d)?d={side:n,width:s.offsetWidth,height:s.offsetHeight}:(i=s.parent)&&(n=s.movable)&&n.call(s)&&(n=_=(s.__move_start||o).call(s,e)))}),c(e,"mousemove",function(e){var i,n,o=u;if(o&&(i=o.target)){var h=e.clientX-o.clientX,f=e.clientY-o.clientY;(n=d)?(n.distanceX=h,n.distanceY=f,r.call(i,n)):(n=_)?(n.distanceX=h,n.distanceY=f,(i.__do_move||a).call(i,n,e)):(e=new l(e),e.mousedown=o,e.distanceX=h,e.distanceY=f,i.trigger(e))}else(i=t.findControl(e.target))&&!i.disabled()&&i.trigger(new l(e))!==!1&&(n=i.resizable)&&"none"!==n.call(i)&&(d=(i.__check_resize||s).call(i,n,e))}),c(e,"mouseup",function(e){var i,n,s=u;s&&(i=s.target)?((n=d)?d=0:(n=_)&&((i.__move_end||h).call(i,n,e),_=null),e=new l(e),e.mousedown=s,e.distanceX=e.clientX-s.clientX,e.distanceY=e.clientY-s.clientY,i.trigger(e),u=null):(i=t.findControl(e.target))&&!i.disabled()&&i.trigger(new l(e))}),c(e,"click",i),c(e,"dblclick",i),c(e,"mouseover",i),c(e,"mouseout",i),c(e,"keydown",n),c(e,"keypress",n),c(e,"keyup",n),t.__dom_scroll=function(e){var i=t.findControl(this);if(i&&!i.disabled())if(i.trigger("scroll")!==!1)i.__do_scroll(i.scrollLeft=this.scrollLeft,i.scrollTop=this.scrollTop);else try{this.onscroll=null,this.scrollTop=i.scrollTop,this.scrollLeft=i.scrollLeft}finally{this.onscroll=scroll}},c(e,e.mozHidden?"DOMMouseScroll":"mousewheel",function(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger("mousewheel","original_event",e,"wheelDelta",e.wheelDelta||40*-e.detail||-120)})}(flyingon,document);