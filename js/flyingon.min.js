/*
* flyingon javascript library v0.0.1.0
* https://github.com/freeoasoft/flyingon
*
* Copyright 2014, yaozhengyang
* licensed under the LGPL Version 3 licenses
*/
"use strict";var flyingon;!function(t){"function"==typeof require&&"object"==typeof module&&module?t(module.exports=flyingon={}):"function"==typeof define&&define.amd?(flyingon={},define(function(e,i,n){t(n.exports=flyingon)})):t(flyingon=window.flyingon||(window.flyingon={}))}(function(t){function e(){}t.version="1.0.1",t.create=Object.create||function(t){return t?(e.prototype=t,new e):{}},t.extend=function i(t,e,n){var r,s=arguments.length-1;for(t=t||{},arguments[s]===!0&&(n=!0,s--);s>0&&(r=arguments[s--]);)if(n)for(var o in r){var a=r[o];a&&"object"==typeof a?t[o]=i(t[o],a,!0):t[o]=a}else for(var o in r)t[o]=r[o];return t},t.each=function(e,i,n){if(e){"string"==typeof e&&(e=e.match(/\w+/g));for(var r=0,s=e.length;r<s;r++)i.call(n||t,e[r],r)}},t.encode=function n(t){if(!t)return"";var e,i,r=[],s=encodeURIComponent;for(var o in t)if(e=t[o],o=s(o),null!==e)switch(typeof e){case"undefined":r.push(o,"=&");break;case"boolean":case"number":r.push(o,"=",e,"&");break;case"string":case"function":r.push(o,"=",s(e),"&");break;default:if(e instanceof Array)for(var a=0,l=e.length;a<l;a++)void 0===(i=e[a])?r.push(o,"=&"):r.push(o,"=",s(i),"&");else r.push(o,"=",n(e),"&")}else r.push(o,"=null","&");return r.pop(),r.join("")},t.raise=function(t,e){throw"["+t+"]"+e}}),function(t){function e(e){var i,n,r,s=R;if(n=s[e])return n;if(i=e.match(/\w+/g)){n=B[B.length-1]||s;for(var o=0,a=i.length;o<a;o++)(r=n[e=i[o]])?n=r:(r=(r=n.moduleName)?r+"."+e:e,n=s[r]=n[e]=H(null),n.moduleName=r);return n}t.raise("flyingon","error.module_name")}function i(e,i){try{B.push(S=e),i.call(e,e,t)}finally{t.endModule()}}function n(t){return t&&(this instanceof t||(t=t.xtype)&&this[t])}function r(){return"[object "+this.xtype+"]"}function s(e,i,n){var r;/^[a-z]\w*$/.test(e)||t.raise("flyingon","error.property_name",e),n?n.name=e:n={name:e},"function"==typeof i?(n.fn=i,n.defaultValue=i=null):n.defaultValue=i,(this.__defaults||(this.__defaults=H(null)))[e]=i,(this.__properties||(this.__properties=H(null)))[e]=n,(r=n.dataType)||(r=n.dataType=typeof i),this[e]=n.fn||o.call(this,e,r,n.check,n.set),(r=this.__selector_extend)&&((r.prototype||r)[e]=a(e))}function o(e,i,n,r){return function(s,o){var a,l=this.__storage,h=e;if(l&&void 0!==(a=l[h])||(a=this.__defaults[h]),void 0===s)return a;switch(i){case"boolean":s=!!s;break;case"integer":s=0|s;break;case"number":s=+s||0;break;case"string":s=""+s;break;case"date":s?s instanceof Date||(s=new Date(s)):s=null}return(n?s=n.call(this,s):s)===a?this:this.__watch_list&&t.__do_watch(this,h,s,o)===!1?this:((l||(this.__storage=H(null)))[h]=s,r&&r.call(this,s,o),o!==!1&&(a=this.__bind_keys)&&(h=a[h])&&this.pushBack(h,s),this)}}function a(t){return function(e){var i,n,r=0,s=t;if(void 0===e)for(;i=this[r++];)if(n=i[s])return n.call(i);for(;i=this[r++];)(n=i[s])&&n.apply(i,arguments);return this}}function l(t){var e=this.__storage;return t?e&&void 0!==(e=e[t])?e:this.__defaults[t]:e||(this.__storage=H(null))}function h(t){var e=this.__storage;return e&&void 0!==(e=e[t])?e:this.__defaults[t]}function f(t,e,i){var n=this[t];return"function"==typeof n?n.call(this,e,i):(this.__storage||(this.__storage=H(null)))[t]=e,this}function u(t,e){var i;if(t)for(var n in t)"function"==typeof(i=this[n])?i.call(this,t[n],e):(this.__storage||(this.__storage=H(null)))[n]=t[n];return this}function c(t,e){var i=this.__storage||(this.__storage=H(null));if(t){e=e||"xtype";for(var n in t)n!==e&&(i[n]=t[n])}return this}function d(e,i){var n=this.__defaults;return void 0===i?n[e]:(n[e]=i,n=this.__properties,(n[e]=t.extend({},n[e])).defaultValue=i,this)}function g(t,e){var i,n=this.__properties,r=[];"function"==typeof t&&(e=t),t=t===!1?this.base.__properties:null;for(var s in n)!(i=n[s])||t&&t[s]===i||e&&!e(i)||r.push(i);return r}function _(t,e){var i;e||(e=t,t=null),"function"==typeof e&&((i=this.__watch_list)?i.push(t,e):this.__watch_list=[t,e])}function p(t,e){var i,n;if(e||(e=t,t=null),e&&(i=this.__watch_list)){for(n=i.length-1;n>=0;)i[n--]===e&&i[n--]===t&&i.splice(n-2,2);i.length||delete this.__watch_list}}function y(t,e,i){if(t&&"function"==typeof e){var n=this.__events||(this.__events=H(null));i&&i>0&&(e.tag=i),(n[t]||(n[t]=[])).push(e)}return this}function v(t,e,i){function n(){e.apply(r,arguments),r.off(t,n)}var r=this;return this.on(t,n,i)}function m(t){var e=this.__events;return(e=e&&e[t])&&e.unshift(w),this}function b(t){var e=this.__events;return(e=e&&e[t])&&e[0]===w&&e.shift(),this}function w(t){t.cancelBubble=!0}function x(t,e){var i,n=this.__events;if(n)if(!e&&t>0)for(var t in n){i=n[t];for(var r=i.length-1;r>=0;r--)i[r].tag===t&&i.splice(r,1);i.length||(i[t]=null)}else if(t)if(e){if(i=n[t]){for(var r=i.length-1;r>=0;r--)i[r]===e&&i.splice(r,1);i.length||(n[t]=null)}}else n[t]&&(n[t]=null);else{for(var t in n)this.off(t);this.__events=null}return this}function C(e){var i,n,r,s,o,a=e.type||(e=new t.Event(e)).type,l=1;for(e.target=this;i=arguments[l++];)e[i]=arguments[l++];i=n=t;do{if((r=n.__events)&&(r=r[a])&&(s=r.length)){l=0;do if((o=r[l++])&&!o.disabled&&(o.call(n,e)===!1&&(e.defaultPrevented=!0),e.cancelBubble))return!e.defaultPrevented;while(l<s)}if(i!==n)n=(o=n.eventBubble)&&n[o];else{if(i===this)break;n=this}}while(n);return!e.defaultPrevented}function k(){var t=new this.Class,e=this.__storage;if(e){t.__storage=H(null);for(var i in e)t[i](stroage[i],!1)}return t}function P(){return this.__events&&this.off(),this}function T(t,e){for(var i in e)switch(i){case"__defaults":case"__properties":j(t[i]||(t[i]=H(null)),e[i]);break;case"constructor":case"Class":case"base":break;default:t[i]=e[i]}}function L(t){return t&&(A[this.aliasName=t]=this)||this}var S,H=t.create,j=t.extend,A=t.components||(t.components=H(null)),W=1,R=H(null),B=[];t.moduleName="flyingon",R.flyingon=t,t.use=function(i){switch(typeof i){case"string":return e(i);case"object":return i||t}return t},t.defineModule=function(n,r){var s,o;switch(typeof n){case"string":s=e(n);break;case"function":s=t,r=n;break;case"object":s=n||t;default:s=t}return"function"==typeof r?(o=t.load)&&(o=o.callback)&&o(i,[s,r])||i(s,r):B.push(S=s),s},t.endModule=function(){var e=B;return e.pop(),S=e[e.length-1]||t},t.mixin=function(t,e){var i;if(e&&t)for(var n=1,r=arguments.length;n<r;n++)(i=arguments[n])&&T(t,i.prototype||i)},t.fragment=function(t,e){var i=H(null);return e&&(i.defineProperty=s),t.call(i),t=function(t){T(t,i)},t.prototype=i,i[t.xtype="anonymous-type-"+W++]=!0,t},t.__do_watch=function(t,e,i,n,r){for(var s,o=t.__watch_list,a=0,l=o.length;a<l;a++)null!=(s=o[a++])?s===e&&o[a].call(t,i,n,r):o[a].call(t,e,i,n,r)},t.defineClass=function(e,i,o,a){var w,T,j,R,B,q;if("string"!=typeof e?(a=o,o=i,i=e,e=null):/^[A-Z]\w*$/.test(e)||t.raise("flyingon","error.class_name"),"function"!=typeof o?"function"==typeof i?(a=o,o=i,i=Object):t.raise("flyingon","error.class_fn"):i&&"function"==typeof i||(i=Object),j=H(T=i.prototype||Object.prototype),j.base=T,q=!T.__flyingon_class,null==a&&(a=q),(a||T.__defaults)&&(j.__defaults=H(T.__defaults||null),j.__properties=H(T.__properties||null),q&&(j.defineProperty=s,j.storage=l,j.get=h,j.set=f,j.sets=u,j.assign=c,j.defaultValue=d,j.properties=g,j.watch=_,j.unwatch=p)),q&&(j.__flyingon_class=!0,j.on=y,j.once=v,j.suspend=m,j.resume=b,j.off=x,j.trigger=C,j.clone=k,j.is=n,j.toString=r,j.dispose=P),R=S||t,B=e?R.moduleName+"-"+e:"anonymous-type-"+W++,j[B]=!0,q=T.constructor,o.call(j,T,j),(w=j.constructor)&&w!==q?j.__constructor_base=w:w=T.__constructor_base?function(){this.__constructor_base.apply(this,arguments)}:function(){},j.Class=j.constructor=w,(q=j.statics)&&q!==T.statics)for(var M in q)w[M]=q[M];return e&&(w.typeName=e,R[e]=A[B]=w),w.xtype=B,w.prototype=j,w.module=R,w.superclass=i,w.alias=L,(q=j.__class_init)&&q.call(j,w,T,j),w},t.on=y,t.off=x,t.once=v,t.suspend=m,t.resume=b,t.trigger=C}(flyingon),flyingon.Event=flyingon.defineClass(function(){this.constructor=function(t){this.type=t},this.type=null,this.target=null,this.cancelBubble=!1,this.defaultPrevented=!1,this.stopPropagation=function(){this.cancelBubble=!0,arguments[0]!==!1&&this.original_event&&this.original_event.stopPropagation()},this.preventDefault=function(){this.defaultPrevented=!0,arguments[0]!==!1&&this.original_event&&this.original_event.preventDefault()},this.stopImmediatePropagation=function(){this.cancelBubble=this.defaultPrevented=!0,arguments[0]!==!1&&this.original_event&&this.original_event.stopImmediatePropagation()}},!1),flyingon.Async=flyingon.defineClass(function(){function t(t,e,n,r){if(n||(n=e,e=!1),n){var s=t.__list||(t.__list=[]);s.push([e,n,r,0]),t.__state&&i(t)}return t}function e(t,e,n,r){t.__list;return t.__state=e,t.__value=n,t.__error=r,i(t),t}function i(t){var e,n,r=t.__list,s=0;if(r){for(;e=r[s++];){if(!e[0]&&(s>1||e[3]))return;if(!e[3]){if("function"==typeof(n=e[1]))try{switch(e[2]){case 1:n=1===t.__state&&n.call(t,t.__value);break;case 2:n=2===t.__state&&n.call(t,t.__error);break;case 3:n=n.call(t,t.__value,t.__error)}}catch(o){t.__state=2,t.__error=o,r.splice(0,s),s=0;continue}n&&n["flyingon.Async"]&&!n.__state?(e[3]=1,(n.__back_list||(n.__back_list=[])).push(r,e,t)):r.splice(--s,1)}}if(r.length>0)return;s=0}if(r=t.__back_list){for(;e=r[s++];)e.splice(e.indexOf(r[s++]),1),e=r[s++],t.__error&&t.bubble&&(e.__state=2,e.__error=t.__error),i(e);r.length=0,t.__back_list=null}}this.sleep=function(e,i,n){if(i!==!1||n!==!1){var r=function(t){var i=new flyingon.Async;return setTimeout(function(){i.resolve(t),i=null},0|e),i};return i=i!==!1?1:0,n!==!1&&(i+=2),t(this,!1,r,i)}return this},this.done=function(e,i){return t(this,e,i,1)},this.fail=function(e,i){return t(this,e,i,2)},this.complete=function(e,i){return t(this,e,i,3)},this.resolve=function(t){return e(this,1,t)},this.reject=function(t,i){return this.bubble=i,e(this,2,void 0,t)},this.progress=function(t){return"function"==typeof t&&(this.__progress||(this.__progress=[])).push(t),this},this.notify=function(t){var e=this.__progress;if(e)for(var i=0,n=e.length;i<n;i++)e[i].call(this,t);return this}}),flyingon.delay=function(t,e){var i=new flyingon.Async;return setTimeout(function(){"function"==typeof e?(e.call(i),e=null):i.resolve(),i=null},0|t),i},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]===t)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){for(var e=this.length-1;e>=0;e--)if(this[e]===t)return e;return-1}),Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if(arguments.length>1){var i=[].slice.call(arguments,1),n=i.push;return function(){var r=i.slice(0);return arguments.length>0&&n.apply(r,arguments),e.apply(t||this,r)}}return function(){return e.apply(t||this,arguments)}}),"undefined"!=typeof JSON||function(){function t(t,n){if(n)switch(typeof n){case"string":t.push('"',n.replace(/"/g,'\\"'),'"');break;case"object":(n instanceof Array?i:e)(t,n);break;case"function":t.push("null");break;default:t.push(n)}else t.push(""!==n?""+n:'""')}function e(t,n){var r,s,o;t.push("{");for(var a in n){if(r=n[a])switch(s=typeof r){case"string":r=r.replace(/"/g,'\\"');break;case"function":r=void 0}else""===r&&(r='""');void 0!==r&&(o?t.push(","):o=!0,t.push('"',a.replace(/"/g,'\\"'),'":'),"object"!==s?t.push(r):(r instanceof Array?i:e)(t,r))}t.push("}")}function i(e,i){e.push("[");for(var n=0,r=i.length;n<r;n++)n>0&&e.push(","),t(e,i[n]);e.push("]")}window.JSON={parse:function(t){return"string"==typeof t?(/[a-zA-Z_$]/.test(t.replace(/"(?:\\"|[^"])*?"|null|true|false|\d+[Ee][-+]?\d+/g,""))&&flyingon.raise("flyingon","error.json_parse"),new Function("return "+t)()):t},stringify:function(e){if(e){var i=[];return t(i,e),i.join("")}if(void 0!==e)return""!==e?""+e:'""'}}}(),flyingon.__serialize_fragment=flyingon.fragment(function(){var t=flyingon.create;this.deserialize_type=!0,this.serialize=function(t){var e;(e=this.Class)&&(e=e.aliasName||e.xtype)&&t.writeProperty("type",e),(e=this.__storage)&&t.writeProperties(e,this.__bind_keys)},this.deserialize=function(e,i){var n,r,s=this.addBind;for(var o in i)n=i[o],s&&"string"==typeof n&&(r=n.match(/^\{\{(\w+)\}\}$/))?s.call(this,o,r[1]):(r=this["deserialize_"+o])?r!==!0&&r.call(this,e,n):(r=this[o])&&"function"==typeof r?r.call(this,n,!1):(this.__storage||(this.__storage=t(null)))[o]=n}}),flyingon.SerializeReader=flyingon.defineClass(function(){function t(t,e){var i=this.callback;if((this.all||(this.all={}))[e]=t,i&&(i=i[e])){for(var n=0,r=i.length;n<r;n++)i[n](t);i[e]=t=null}}var e=flyingon.components,i=window.Array;this.deserialize=function(t){return t&&("string"==typeof t&&(t=JSON.parse(t)),"object"==typeof t&&(t=t instanceof i?this.readArray(t):this.readObject(t),this.all=this.callback=null)),t},this.read=function(t){return t&&"object"==typeof t?t instanceof i?this.readArray(t):this.readObject(t):t},this.readArray=function(t){if(t){for(var e=[],i=0,n=t.length;i<n;i++)e.push(this.read(t[i]));return e}return null},this.readObject=function(i,n){if(i){var r,s;return n?(r=new n).deserialize?(r.deserialize(this,i),(s=i.id)&&t.call(this,r,s)):this.readProperties(r,i):(n=i.type)&&(n=e[n])?((r=new n).deserialize(this,i),(s=i.id)&&t.call(this,r,s)):this.readProperties(r={},i),r}return null},this.readProperties=function(t,e){for(var i in e)t[i]=this.read(e[i])},this.readReference=function(t,e){var i,n=this.all;n&&(i=n[t])?e(i):(i=this.callback)?(i[t]||(i[t]=[])).push(e):(this.callback={})[t]=[e]},this.__class_init=function(t){var e=t.instance=new t;t.deserialize=function(t){return e.deserialize(t)}}},!1),flyingon.SerializeWriter=flyingon.defineClass(function(){var t=window.Array;this.serialize=function(e){if(e&&"object"==typeof e){var i=this.data=[];return e instanceof t?this.writeArray(e):this.writeObject(e),i.pop(),i.join("")}return""+e},this.write=function(e){if(null!=e)switch(typeof e){case"boolean":this.data.push(!!e,",");break;case"number":this.data.push(+e||0,",");break;case"string":this.data.push('"',e.replace(/"/g,'\\"'),'"',",");break;case"function":this.data.push('"',(""+e).replace(/"/g,'\\"'),'"',",");break;default:e instanceof t?this.writeArray(e):this.writeObject(e)}else this.data.push(null,",")},this.writeArray=function(t){var e,i=this.data;if(null!=t)if((e=t.length)>0){i.push("[");for(var n=0;n<e;n++)this.write(t[n]);i.pop(),i.push("]",",")}else i.push("[]",",");else i.push(null,",")},this.writeObject=function(t){var e=this.data;null!=t?(e.push("{"),t.serialize?t.serialize(this):this.writeProperties(t),e.push(","===e.pop()?"}":"{}",",")):e.push(null,",")},this.writeProperties=function(t,e){if(t){var i,n=this.data;for(var r in t)e&&(i=e[r])?("function"==typeof i&&(i=i.text),n.push('"',r,'":"{{',i.replace(/"/g,'\\"'),'}}"',",")):(n.push('"',r,'":'),this.write(t[r]))}},this.writeProperty=function(t,e){t&&(this.data.push('"',t,'":'),this.write(e))},this.writeReference=function(t,e){if(t&&e){var i=e.id;i&&"function"==typeof i&&(i=i()),this.data.push('"',t,'":',i||"__auto_id_"+i++)}},this.__class_init=function(t){var e=t.instance=new t;t.serialize=function(t){return e.serialize(t)}}},!1),flyingon.RowCollection=flyingon.defineClass(function(){function t(t,e){var n;t.push("{");for(var r in e)n?t.push(","):n=!0,t.push('"',r,'":'),i(t,e[r]);t.push("}")}function e(t,e){t.push("[");for(var n=0,r=e.length;n<r;n++)n>0&&t.push(","),i(t,e[n]);t.push("]")}function i(i,n){if(null==n)return void i.push("null");switch(typeof n){case"string":i.push('"',n.replace(/"/g,'\\"'),'"');break;case"object":n instanceof Array?e(i,n):t(i,n);break;default:i.push(n)}}function n(i,n,r,s,o){var a,l;i.push("{");for(var h in n)if(a=n[h],l=r[h],a!==l||s&&s.test(h)){if(null==a){i.push('"',h,'":null',",");continue}switch(typeof a){case"string":i.push('"',h,'":"',a.replace(/"/g,'\\"'),'"',",");break;case"object":o&&(l=o[h])?(l=l.toJSON(!0),l.length>2&&i.push('"',h,'":',l,",")):(i.push('"',h,'":'),a instanceof Array?e(i,a):t(i,a),i.push(","));break;default:i.push('"',h,'":',a,",")}}i.push(","===i.pop()?"}":"{}")}this.length=0,this.at=function(t){return this[t]||null},this.find=function(t){for(var e,i=new flyingon.RowCollection,n=0,r=this.length,s=0;s<r;s++)!(e=this[s])||t&&!t(e)||(i[n++]=e);return i.length=n,i},this.findAll=function(t){for(var e,i=arguments[1]||new flyingon.RowCollection,n=0,r=this.length;n<r;n++)!(e=this[n])||t&&!t(e)||(i[i.length++]=e),e.length>0&&e.findAll(t,i);return i},this.toJSON=function(e,i){var r,s,o,a,l=["["];e&&i&&("string"==typeof i&&(i=i.match(/\w+/g)),i=i&&i.length>0?new RegExp("^("+i.join("|")+")$","i"):null);for(var h=0,f=this.length;h<f;h++)(r=this[h])&&(s=r.data)&&(o?l.push(","):o=!0,e&&(a=r.originalData)?n(l,s,a,i,this.tables):t(l,s));return l.push("]"),l.join("")}},!1),flyingon.__dataset_fragment=flyingon.fragment(function(){var t=[].splice;flyingon.extend(this,flyingon.RowCollection.prototype),this.load=function(t,e){var i=this.dataset;return(i||this).__load_data(i?this:null,t,e),this},this.loadTreeList=function(t,e,i){var n=this.dataset;return(n||this).__load_data(n?this:null,t,e,i||"children"),this},this.append=function(t){return this.insert(-1,t)},this.insert=function(e,i){if(i&&i["flyingon.DataRow"]){var n,r=this.dataset;r?n=this:r=this,((e|=0)<0||e>this.length)&&(e=this.length),r.trigger("row-adding","parent",n,"row",i,"index",e)!==!1&&(t.call(this,e,0,i),i.dataset=r,i.state="added",n&&(i.parent=n),r.__changed_rows.push(i),r.trigger("row-added","parent",n,"row",i,"index",e))}return this},this.removeAt=function(e){var i,n=this[e],r=this.dataset;return r?i=this:r=this,n&&r.trigger("row-removing","parent",i,"row",n)!==!1&&(t.call(this,e,1),r.trigger("row-removed","parent",i,"row",n),"unchanged"!==n.state&&n.rejectChange(),n.dataset=n.parent=null,n.uniqueId===r.__current_id&&(n=this[e]||this[--e])&&r.currentRow(n)),this},this.clear=function(){var e,i=this.dataset,n=this.length;if(n>0){for(var r=0;r<n;r++)(e=this[r])&&("unchanged"!==e.state&&e.rejectChange(),e.dataset=e.parent=null);t.call(this,0,n),(i||this).trigger("clear","parent",i?this:null)}return this},this.removeProperty=function(t){if(t)for(var e,i,n=this.length-1;n>=0;n--)(e=this[n])&&(i=e.data)&&(delete i[t],(i=e.originalData)&&delete i[t],e.length>0&&e.removeProperty(t));return this}}),flyingon.DataRow=flyingon.defineClass(flyingon.RowCollection,function(){var t=new flyingon.Event,e=[].splice;this.dataset=null,this.parent=null,this.id=null,this.uniqueId=0,this.data=null,this.originalData=null,this.state="unchanged",this.isCurrent=function(){return this.uniqueId===this.dataset.__current_id},this.index=function(){var t,e=this.parent||this.dataset;if(e&&(t=e.length)>0)for(var i=0;i<t;i++)if(e[i]===this)return i;return-1},this.get=function(t){var e;if(e=t&&this.data)return e[t]},this.originalValue=function(t){var e;if(t&&(e=this.originalData||this.data))return e[t]},this.set=function(e,i,n){var r,s;if(e&&void 0!==i&&(r=this.data)&&i!==(s=r[e])){var o,a,l,h=this.dataset;if(n!==!1){if(o=t,o.type="value-changing",o.row=this,o.name=e,o.value=i,o.oldValue=s,o&&h.trigger(o)===!1)return this;(l=o.value)!==i&&void 0!==l&&(i=l)}if("unchanged"===this.state){l={};for(a in r)l[a]=r[a];this.originalData=r,this.data=r=l,this.state="changed",h.__changed_rows.push(this)}r[e]=i,o&&(o.type="value-changed",h.trigger(o)),h.dispatch("change",this,e)}return this},this.rollback=function(t){var e=t&&this.originalData;e&&(this.data[t]=e[t])},this.remove=function(){var t=this.parent||this.dataset;return t&&t.removeAt(this.index()),this},this.acceptChange=function(){var t=this.dataset;if(t&&"unchanged"!==this.state)for(var e=t.__changed_rows,i=e.length-1;i>=0;i--)if(e[i]===this)return this.originalData=null,this.state="unchanged",e.splice(i,1),this;return this},this.rejectChange=function(){var t=this.dataset;if(t&&"unchanged"!==this.state)for(var i,n=t.__changed_rows,r=n.length-1;r>=0;r--)if(n[r]===this)return(i=this.originalData)?(this.data=i,this.originalData=null,this.state="unchanged"):e.call(this.parent||t,this.index(),1),n.splice(r,1),this;return this},flyingon.__dataset_fragment(this),this.level=function(){for(var t=0,e=this;e=e.parent;)t++;return t},this.count=function(){var t=this.length,e=t;if(t>0)for(var i=0;i<t;i++){var n=this[i];n.length>0&&(e+=n.count())}return e}}),flyingon.DataSet=flyingon.defineClass(flyingon.RowCollection,function(){function t(e,i,n,r,s,o,a){for(var l,h,f=i||e,u=f.rowType||e.rowType,c=e.__keys1,d=e.__keys2,g=f.length,_=n.length,p=0;p<_;p++)h=new u,h.dataset=e,i&&(h.parent=i),h.data=l=n[p]||{},c[h.uniqueId=a++]=h,r&&(d[h.id=l[r]]=h),s||(f[g++]=h,o&&(l=l[o])&&l.length>0&&(a=t(e,h,l,r,null,o,a)));if(s)for(var p=0;p<_;p++)l=n[p],h=d[l[r]],(i=d[l[s]])?(h.parent=i,i[i.length++]=h):e[g++]=h;return f.length=g,a}this.constructor=function(){this.__new_id=1,this.__keys1=flyingon.create(null),this.__keys2=flyingon.create(null),this.__changed_rows=[]},this.rowType=flyingon.DataRow,flyingon.__serialize_fragment(this),flyingon.__dataset_fragment(this),this.loadTreeFromList=function(t,e,i){return this.__load_data(null,t,e||"id",i||"parentId")},this.__load_data=function(e,i,n,r,s){return i&&i.length>0&&(this.__new_id=t(this,e,i,n,r,s,this.__new_id++),this.trigger("load","parent",e)),this},this.createRow=function(t,e){var i=new this.rowType;return i.dataset=this,i.data=t=t||{},this.__keys1[i.uniqueId=this.__new_id++]=i,e&&(this.__keys2[i.id=t[e]]=i),this.trigger("row-create","row",i),i},this.currentRow=function(t){var e=this.__keys1,i=this.__current_id,n=i&&e[i]||null;if(void 0===t)return n;if(n!==t){if(this.trigger("current-changing","value",t,"oldValue",n)===!1)return this.__current_id=i,this;this.__current_id=t&&t.uniqueId,this.trigger("current-changed","value",t,"oldValue",n),this.dispatch("move",t)}return this},this.first=function(){var t;return(t=this.at(0))&&this.currentRow(t),this},this.previous=function(){var t=this.currentRow(),e=t&&t.index()-1||0;return(t=this.at(e))&&this.currentRow(t),this},this.next=function(){var t=this.currentRow(),e=t&&t.index()+1||0;return(t=this.at(e))&&this.currentRow(t),this},this.last=function(){var t;return(t=this.at(this.length-1))&&this.currentRow(t),this},this.moveTo=function(t){var e;return(e=this.at(t))&&this.currentRow(e),this},this.id=function(t){return this.__keys2(t)||null},this.uniqueId=function(t){return this.__keys1[t]||null},this.getChanges=function(t){var e=new flyingon.RowCollection,i=this.__changed_rows,n=i.length;if(n>0)if(t&&"string"==typeof t){for(var r,s=0,o=0;o<n;o++)(r=i[o])&&t.indexOf(r.state)>=0&&(e[s++]=r);e.length=s}else i.push.apply(e,i);return e},this.acceptChanges=function(){var t,e=this.__changed_rows,i=e.length;if(i>0){for(var n=0;n<i;n++)(t=e[n])&&(t.originalData=null,t.state="unchanged");e.length=0}return this},this.rejectChanges=function(){var t,e,i=this.__changed_rows,n=i.length;if(n>0){for(var r=n-1;r>=0;r--)(t=i[r])&&((e=t.originalData)?(t.data=e,t.originalData=null,t.state="unchanged"):(i.splice.call(t.parent||this,t.index(),1),t.dataset=t.parent=null));i.length=0,this.dispatch("bind")}return this},this.subscribe=function(t,e){if(t&&t.ondatareceive){var i,n=this.__action_list;n?(i=n.indexOf(t),e?i>=0&&n.splice(i,1):i<0&&n.push(t)):e||(this.__action_list=[]).push(t)}return this},this.dispatch=function(t,e,i){var n,r,s,o;if(t&&(n=this.__action_list))for(var a=0,l=n.length;a<l;a++)(r=n[a]).subscribeCurrent&&(o||void 0===o&&(o=!!e&&e.uniqueId!==this.__current_id))||r.ondatareceive(this,s||(s={type:t,row:e||this.currentRow(),name:i||null}));return this},this.bind=function(){var t;return!this.__current_id&&(t=this[0])&&(this.__current_id=t&&t.uniqueId),this.dispatch("bind"),this},this.expression=function(t,e,i){var n;return t&&"string"==typeof t&&("function"==typeof e?("function"!=typeof i&&(i=null),n=this.__expression_keys||(this.__expression_keys=flyingon.create(null)),n[t]=[e,i]):(n=this.__expression_keys)&&delete n[t]),this},this.getBindingValue=function(t,e){var i=this.__expression_keys;return i&&(i=i[t])?i[0].call(this,e.row):(i=e.row.data)&&i[t]},this.setBindingValue=function(t,e,i){var n=this.__expression_keys;return n&&(n=n[t])?(n=n[1])&&n.call(this,e,i||this.currentRow()):(i||this.currentRow()).set(t,e),this}},!0),flyingon.__bindable_fragment=flyingon.fragment(function(){this.defineProperty("dataset",null,{fn:function(t){var e=this.__dataset||null;return void 0===t?e:e===t?this:this.__watch_list&&flyingon.__do_watch(this,name,t,bind)===!1?this:(this.__dataset=t,e&&e.subscribe(this,!0),t&&t.subscribe(this),this)}}),this.addBind=function(t,e){return t&&e&&((this.__bind_keys||(this.__bind_keys={}))[t]=e),this},this.removeBind=function(t){var e=this.__bind_keys;return e&&delete e[t],this},this.subscribeCurrent=!0,this.ondatareceive=function(t,e){var i,n;if(e&&(i=this.__bind_keys)){n=e.name;for(var r in i)n&&i[r]!==n||this[r](t.getBindingValue(i[r],e),!1)}return this},this.pushBack=function(t,e){var i,n=this;do if(i=n.__dataset)return i.setBindingValue(t,e),this;while(n=n.parent);return this}},!0),function(){function t(t,n){for(var r,s,o,a=flyingon.Selector_node,l=" ";o=t[n++];)switch(o){case"#":case".":s=new a(l,o,t[n++],s),l="";break;case"*":s=new a(l,"*","*",s),l="";break;case" ":case"\t":l||(l=" ");break;case">":case"+":case"~":l=o;break;case",":s&&(r=r||new flyingon.Selector_nodes,r[r.length++]=s.top),s=null,l=" ";break;case"[":s&&!l||(s=new a(l,"*","*",s),l=""),n=e(s,t,n);break;case":":s&&!l||(s=new a(l,"*","*",s),l=""),o=new flyingon.Selector_pseudo(s,t[n++]),"("===t[n]&&(n=i(o,t,++n));break;default:s=new a(l,"",o.replace(/-/g,"."),s),l=""}return r?(s&&(r[r.length++]=s.top),r):s&&s.top||s}function e(t,e,i){for(var n,r,s;r=e[i++];)switch(r){case"]":return i;case"*":case"^":case"$":case"~":case"|":n&&(n.relation=r);break;case"=":n&&(n.relation+="=");break;case" ":case"\t":break;default:if(n){switch(r){case"undefined":r=void 0;break;case"null":r=null;break;case"true":r=!0;break;case"false":r=!1;break;default:r='"'===(s=r.charAt(0))||"'"===s?r.substring(1,r.length-1):+r}n.value=r}else n=new flyingon.Selector_property(t,r)}return i}function i(t,e,i){for(var n,r=i,s=1;s&&(n=e[i++]);)switch(n){case"(":s++;break;case")":s--}switch(n=e.slice(r,i-1).join(""),t.name){case"eq":case"gt":case"lt":n|=0}return t.value=n,i}var n=flyingon.create(null);flyingon.__parse_selector=function(e,i){return e&&"string"==typeof e?i!==!1&&(i=n[e])?i:(i=e.match(/"[^"]*"|'[^']*'|[\w-]+|[*.#\[\]:(), \t>+~=|^$]/g),n[e]=t(i,0)):null}}(),flyingon.Selector_node=flyingon.defineClass(function(){function t(t){var e,i,n=[],r=[],s=0,o=0;do n[o++]=t,e=t.nextSibling,(i=t.firstChild)?(t=i,e&&(r[s++]=e)):t=e||r[--s];while(t);return n}function e(t){return t}function i(t){for(var e in t){var i=t[e];for(var n in i)i[n]=null;t[e]=null}}var n,r,s;this.constructor=function(t,e,i,n){this.find=this[this.relation=t],this.filter=this[this.type=e],this.name=i,n?(t?n.next=this:n[n.length++]=this,this.top=n.top||n):this.top=this},this.relation="",this.type="",this.name="",this.length=0,this.next=null,this.select=function(t){var e,i;if(t=this.find(t),t[0]){for(e=0;i=this[e++];)t=i.filter(t);t[0]&&(i=this.next)&&(t=i.select(t))}return t},this.check=function(t){for(var e,i=0;e=this[i++];)if(!(t=e.filter(t,[])).length)return t;return(e=this.next)?e.find(t):t},this[""]=function(t,e){var i=this.__type||(this.__type=flyingon.components[this.name]);if(i){for(var n,r=[],s=0,o=0;n=t[s++];)n instanceof i&&(r[o++]=n);return r}return t},this["*"]=function(t,e){return t},this["."]=function(t,e){var i=this.name;if(i){for(var n,r,s=[],o=0,a=0;n=t[o++];)(r=n.__class_list)&&r[i]&&(s[a++]=n);return s}return t},this["#"]=function(t,e){var i=this.name;if(i){for(var n,r,s=[],o=0,a=0;n=t[o++];)(r=n.__storage)&&r.id===i&&(s[a++]=n);return s}return t},this[" "]=function(e){var i,n,r,o=s,a=0;for(o=o?(r=o["*"])||(o["*"]={}):(s=flyingon.__type_query_cache={})["*"]={},e.length>1&&(e=remove_child(e));n=e[a++];)r=n.__uniqueId||n.uniqueId(),r=o[r]||(o[r]=(r=n.firstChild)?t(r):[]),r.length>0&&(i?r.push.apply(i,r):i=r);return i&&i[0]?this.filter(i,1):i||[]},this[">"]=function(t){for(var e,i,n,r=0;i=t[r++];)i.firstChild&&(n=i.children(),e?n.push.apply(e,n):e=n);return e&&e[0]&&this.filter(e,2)||[]},this["+"]=function(t){for(var e,i=[],n=0,r=0;e=t[n++];)(e=e.nextSibling)&&(i[r++]=e);return i[0]?this.filter(i):i},this["~"]=function(t){var i,n=[],r=0,s=0;for(t.length>1&&(t=e(t));i=t[r++];)for(;i=i.nextSibling;)n[s++]=i;return n[0]?this.filter(n):n},flyingon.__clear_id_query=function(t){var e,i,r=n;if(r&&(i=r[t])){for(e in i)i[e]=null;delete r[e];for(e in r)return;n=flyingon.__id_query_cache=null}},flyingon.__clear_class_query=function(t){var e,n,s,o=r;if(o&&t){if("string"==typeof t)(n=o[t])&&(i(n),delete o[t]);else if(t instanceof Array)for(s=0;e=t[s++];)(n=o[e])&&(i(n),delete o[e]);else for(e in t)(n=o[e])&&(i(n),delete o[e]);for(e in o)return;r=flyingon.__clear_class_query=null}},flyingon.__clear_type_query=function(t){var e=s;for(var n in e)i(e[n]),e[n]=null;s=flyingon.__type_query_cache=null}},!1),flyingon.Selector_nodes=flyingon.defineClass(function(){this.type=",",this.length=0,this.select=function(t,e){var i,n,r,s=1;if(n=this[0])for(e=n.select(t,e);n=this[s++];){i=n.select(t,[]);for(var o=0,a=i.length;o<a;o++)(n=i[o])&&(r=-n.__uniqueId)&&!e[r]&&(e[r]=!0,e.push(n))}return e}},!1),flyingon.Selector_property=flyingon.defineClass(function(){this.constructor=function(t,e){this.name=e,t[t.length++]=this},this.type="[]",this.name="",this.relation="",this.value="",this.filter=function(t){var e,i=this.name;if(i&&(e=this[this.relation])){var n=[];return e.call(this,t,i,n),n}return t},this[""]=function(t,e,i){for(var n,r=0,s=0;n=t[r++];)void 0!==n[e]&&(i[s++]=n)},this["="]=function(t,e,i){for(var n,r,s=this.value,o=0,a=0;n=t[o++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),r===s&&(i[a++]=n))},this["*="]=function(t,e,i){for(var n,r,s=this.value,o=0,a=0;n=t[o++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),r=""+r,r.indexOf(s)>=0&&(i[a++]=n))},this["^="]=function(t,e,i){for(var n,r,s=this.value,o=0,a=0;n=t[o++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),r=""+r,0===r.indexOf(s)&&(i[a++]=n))},this["$="]=function(t,e,i){for(var n,r,s=this.value,o=s.length,a=0,l=0;n=t[a++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),r=""+r,r.lastIndexOf(s)===r.length-o&&(i[l++]=n))},this["~="]=function(t,e,i){for(var n,r,s=this.regex||(this.regex=new RegExp("(?:^|s+)"+this.value+"(?:s+|$)")),o=0,a=0;n=t[o++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),s.text(r)&&(i[a++]=n))},this["|="]=function(t,e,i){for(var n,r,s=this.regex||(this.regex=new RegExp("\b"+this.value+"\b")),o=0,a=0;n=t[o++];)void 0!==(r=n[e])&&("function"==typeof r&&(r=r.call(n)),s.text(r)&&(i[a++]=n))}},!1),flyingon.Selector_pseudo=flyingon.defineClass(function(){this.constructor=function(t,e){this.name=e,t[t.length++]=this},this.type=":",this.name="",this.value=0,this.filter=function(t){var e,i=this.name;if(i&&(e=this[i])){var n=[];return e.call(this,t,n),n}return t},this.active=function(t,e){},this.disabled=function(t,e){for(var i,n,r=0,s=0;i=t[r++];)(n=i.__storage)&&void 0===(n=n.disabled)&&(n=i.__defaults)&&(n=n.disabled),n&&(e[s++]=i)},this.enabled=function(t,e){for(var i,n,r=0,s=0;i=t[r++];)(n=i.__storage)&&void 0===(n=n.disabled)&&(n=i.__defaults)&&(n=n.disabled),n||(e[s++]=i)},this.checked=function(t,e){for(var i,n,r=0,s=0;i=t[r++];)(n=i.__storage)&&void 0===(n=n.checked)&&(n=i.__defaults)&&(n=n.checked),n&&(e[s++]=i)},this.has=function(t,e){var i=this.value;return i&&(i=flyingon.__parse_selector(i)),t},this.not=function(t,e){},this.empty=function(t,e){for(var i,n=0,r=0;i=t[n++];)i.firstChild||(e[r++]=i)},this.only=function(t,e){for(var i,n=0,r=0;i=t[n++];)i.previousSibling||i.nextSibling||(e[r++]=i)},this.first=function(t,e){for(var i,n=0,r=0;i=t[n++];)i.previousSibling||(e[r++]=i)},this.last=function(t,e){for(var i,n=0,r=0;i=t[n++];)i.nextSibling||(e[r++]=i)},this.odd=function(t,e){for(var i,n=(this.value,0),r=0;i=t[n++];)1&i.index()||(e[r++]=i)},this.even=function(t,e){for(var i,n=(this.value,0),r=0;i=t[n++];)1&i.index()&&(e[r++]=i)},this.eq=function(t,e){for(var i,n=this.value,r=0,s=0;i=t[r++];)i.index()===n&&(e[s++]=i)},this.gt=function(t,e){for(var i,n=this.value,r=0,s=0;i=t[r++];)i.index()>n&&(e[s++]=i)},this.lt=function(t,e){for(var i,n=this.value,r=0,s=0;i=t[r++];)i.index()<n&&(e[s++]=i)}},!1),flyingon.Query=flyingon.defineClass(function(){var t=flyingon.__parse_selector;this.constructor=function(e,i){var n;i&&(n=t(e))&&(n=n.select(i))&&n[0]&&n.push.apply(this,n)},this.find=function(t){var e=new this.Class(t,this);return e.previous=this,e},this.children=function(t,e,i){},this.end=function(){return this.previous||this},this.on=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.on(t,e);return this},this.once=function(t,e){if(t&&e)for(var i,n=0;i=this[n++];)i.once(t,e);return this},this.off=function(t,e){for(var i,n=0;i=this[n++];)i.off(t,e);return this},this.trigger=function(t){if(t)for(var e,i=0;e=this[i++];)e.trigger.apply(e,arguments);return this},this.hasClass=function(t){var e;return!(!t||!(e=this[0]))&&e.hasClass(t)},this.addClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.addClassName(t);return this},this.removeClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.removeClass(t);return this},this.toggleClass=function(t){if(t)for(var e,i=0;e=this[i++];)e.toggleClass(t);return this}},!1),function(t){function e(t){return a[t]={cache:!0,text:t,left:t|=0,top:t,right:t,bottom:t,width:t<<=1,height:t}}function i(e,i,n){var r={text:e},s=t.pixel;switch(i.length){case 1:r.left=r.top=r.right=r.bottom=s(i[0],n);break;case 2:r.left=r.right=s(i[1],n),r.top=r.bottom=s(i[0],n);break;case 3:r.left=r.right=s(i[1],n),r.top=s(i[0],n),r.bottom=s(i[2],n);break;default:r.left=s(i[3],n),r.top=s(i[0],n),r.right=s(i[1],n),r.bottom=s(i[2],n)}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}var n=t.create(null),r=t.create(null),s=/[a-zA-z]+|%/,o=/[+-]?[\w%.]+/g,a=t.create(null),l=parseFloat;n.em=n.rem=12,n.ex=6,n.pc=16,n.px=1,n.pt=4/3,n.mm=(n.cm=96/2.54)/10,n["in"]=96,(t.pixel_unit=function(t,e){if(void 0===e)return n[t];if(n[t]!==e){n[t]=e;var i=r;for(var s in i)s.indexOf(t)>0&&(i[s]=void 0)}}).unit=n,(t.pixel=function(t,e){if(t>=0)return t>>0;var i=r[t];if(void 0!==i)return i!==!0?i:l(t)*e/100+.5|0;if(i=t.match(s)){if("%"===(i=i[0]))return r[t]=!0,l(t)*e/100+.5|0;i=i.toLowerCase()}return r[t]=l(t)*(n[i]||1)+.5|0}).cache=r,(t.pixel_sides=function(t,n){var r=a[t];if(r){if(r.cache)return r}else if(t>=0)return e(t);return t&&(r=t.match(o))?(a[t]=r,t.indexOf("%")<0?(r=i(t,r),r.cache=!0,r):i(t,r,n)):e("")}).cache=a}(flyingon),flyingon.defineClass("Control",function(){function t(t,e){for(var i,n=t.__class_keys={},r=0;i=e[r++];)n[i]=!0;flyingon.__class_query_cache&&flyingon.__clear_class_query(e),t.className(e.join(" "))}function e(t,e,i){var n=[];for(var r in e)e[r]&&n.push(r);flyingon.__class_query_cache&&flyingon.__clear_class_query(i),t.className(n.join(" "))}function i(t,e,i){i=i||{},i.group="location",i.query=!0,i.set=function(){this.__update_dirty<2&&this.invalidate()},r.defineProperty(t,e,i)}function n(t,e){var i=t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()});r.defineProperty(i,"",{group:"appearance",dom:e===!1?1:2,set:function(t){this.renderer.set(this,i,t)}})}var r=this,s=flyingon.__uniqueId_controls=flyingon.create(null),o=flyingon.pixel,a=flyingon.pixel_sides,l=1;this.defaultClassName="fn-control",this.__selector_extend=flyingon.Query,this.eventBubble="parent",this.defaultWidth=100,this.defaultHeight=25,this.scrollLeft=0,this.scrollTop=0,this.renderer=null,this.__uniqueId=0,this.uniqueId=function(){return this.__uniqueId||(s[l]=this,this.__uniqueId=l++)},this.parent=null,this.previousSibling=null,this.nextSibling=null,this.index=function(){if(this.parent){for(var t=this,e=0;t=t.previousSibling;)e++;return e}return-1},this.remove=function(t){var e=this.parent;e&&e.removeChild(this,t)},flyingon.__bindable_fragment(this),this.defineProperty("id","",{set:function(t,e){var i;(i=flyingon.__id_query_cache)&&(e&&i[e]&&flyingon.__clear_id_query(e),t&&i[t]&&flyingon.__clear_id_query(t)),this.renderer.set(this,"id",t)}}),this.defineProperty("className","",{set:function(t){this.renderer.set(this,"className",t)}}),this.hasClass=function(t){var e;return t&&(e=this.__class_keys)&&e[t]||!1},this.addClass=function(e){var i,n,r;if(e&&(i=e.match(/\w+/g)))if(n=this.__class_keys){for(r=i.length;r--;)n[e=i[r]]?i.splice(r,1):n[e]=!0;i.length>0&&(flyingon.__class_query_cache&&flyingon.__clear_class_query(i),this.className(this.__storage.className+" "+i.join(" ")))}else t(this,i);return this},this.removeClass=function(t){var i,n,r;if(t&&(i=t.match(/\w+/g))&&(n=this.__class_keys)){for(r=i.length;r--;)n[t=i[r]]?n[t]=!1:i.splice(r,1);i.length>0&&e(this,n,i)}return this},this.toggleClass=function(i){var n,r,s;if(i&&(n=i.match(/\w+/g)))if(r=this.__class_keys){for(s=n.length;s--;)r[i=n[s]]=!r[i];e(this,r,n)}else t(this,n);return this},flyingon.locationProperty=i,i("visible",!0,{set:function(t){this.renderer.set(this,"visible",t),this.__update_dirty<2&&this.invalidate()}}),i("alignX","left"),i("alignY","top"),i("left",""),i("top",""),i("width","default"),i("height","default"),i("minWidth",""),i("maxWidth",""),i("minHeight",""),i("maxHeight",""),i("margin",""),this.defineProperty("border","",{group:"layout",set:function(t){this.boxModel&&(this.boxModel.border=a(t)),this.renderer.set(this,"border",t),this.__update_dirty<2&&this.invalidate(!0)}}),this.defineProperty("padding","",{group:"layout",dom:1,set:function(t){this.boxModel&&(this.boxModel.padding=a(t)),this.renderer.set(this,"padding",t),this.__update_dirty<2&&this.invalidate(!0)}}),this.defineProperty("overflowX","auto",{group:"layout",dom:1,set:function(t){this.renderer.set(this,"overflowX",t),this.__update_dirty<2&&this.invalidate(!0)}}),this.defineProperty("overflowY","auto",{group:"layout",dom:1,set:function(t){this.renderer.set(this,"overflowY",t),this.__update_dirty<2&&this.invalidate(!0)}}),this.locationValue=function(t){var e,i=this.__location_values;return i&&void 0!==(e=i[t])?e:(i=this.__storage)&&void 0!==(e=i[t])?e:this.__defaults[t]};var h=["margin",0,"border",0,"padding",0,"minWidth",1,"maxWidth",1,"minHeight",2,"maxHeight",2,"width",3,"height",3],f=a(0),u=o.cache,c=a.cache;this.__init_boxModel=function(t,e){for(var i,n,r,s=this.boxModel||(this.boxModel={}),l=this.__defaults,d=this.__storage,g=s.location=this.__location_values,_=0,p=h;i=p[_++];)n=p[_++],g&&void 0!==(r=g[i])||d&&void 0!==(r=d[i])||(r=l[i]),r&&"0"!==r?r<=0?r=n?0:f:r>0?(r|=0,n||(r=c[r]||a(r,t))):n<3&&(r=n?u[r]||o(r,1===n?t:e):c[r]||a(r,t)):r=n?0:f,s[i]=r;return s.alignX=g&&g.alignX||d&&d.alignX||l.alignX,s.alignY=g&&g.alignY||d&&d.alignY||l.alignY,s},this.measure=function(t,e,i,n,r){var s=this.__init_boxModel(t,e),a=s.minWidth,l=s.maxWidth,h=s.minHeight,f=s.maxHeight,u=s.width,c=s.height,d=0;switch(u){case"default":u=!!(1&r)||this.defaultWidth;break;case"fill":u=!0;break;case"auto":"auto"===c?u=!!(1&r)||this.defaultWidth:(d=1,u=i||this.defaultWidth);break;default:u=u>=0?u:o(u,t)}switch(u===!0&&(u=(i>=0?i:t)-s.margin.width)<0&&(u=0),c){case"default":c=!!(2&r)||this.defaultHeight;break;case"fill":c=!0;break;case"auto":d=2,c=n||this.defaultHeight;break;default:c=c>=0?c:o(c,e)}return this.__auto_size=d,c===!0&&(c=(n>=0?n:e)-s.margin.height)<0&&(c=0),u<a?u=a:l>0&&u>l&&(u=l),c<h?c=h:f>0&&c>f&&(c=f),s.offsetWidth=u,s.offsetHeight=c,this.onmeasure(s,d)!==!1&&(s.offsetWidth!==u&&((u=s.offsetWidth)<a?s.offsetWidth=u=a:l>0&&u>l&&(s.offsetWidth=u=l)),s.offsetHeight!==c&&((c=s.offsetHeight)<h?s.offsetHeight=c=h:f>0&&c>f&&(s.offsetHeight=c=f))),this.__update_dirty<2&&this.__size_tag!==(c<<16)+u&&(this.__update_dirty=2),s},this.onmeasure=function(t,e){return!1},this.locate=function(t,e,i,n,r){var s,o=this.boxModel,a=o.margin,l=o.offsetWidth,h=o.offsetHeight;if(i>0&&(s=i-l))switch(o.alignX){case"center":t+=s>>1;break;case"right":t+=s;break;default:t+=a.left}else t+=a.left;if(n>0&&(s=n-h))switch(o.alignY){case"middle":e+=s>>1;break;case"bottom":e+=s;break;default:e+=a.top}else e+=a.top;o.offsetLeft=t,o.offsetTop=e,this.onlocate(o)!==!1&&(t=o.offsetLeft,e=o.offsetTop),this.__location_dirty=(s=this.__location_tag)&&s!==(e<<16)+t,r&&(r.arrangeX=t+=l+a.right,r.arrangeY=e+=h+a.bottom,t>r.arrangeRight&&(r.arrangeRight=t),e>r.arrangeBottom&&(r.arrangeBottom=e))},this.onlocate=function(t){return!1},n("z-index",!1),n("border-style",!1),n("border-color",!1),n("border-radius"),n("direction",!1),n("text-align",!1),n("vertical-align",!1),n("visibility",!1),n("opacity"),n("cursor",!1),n("background-color",!1),n("background-image",!1),n("background-repeat",!1),n("background-position",!1),n("color",!1),n("font-style",!1),n("font-variant",!1),n("font-weight",!1),n("font-size",!1),n("line-height",!1),n("font-family",!1),n("word-spacing",!1),n("letter-spacing",!1),n("text-indent",!1),n("text-decoration",!1),n("text-overflow",!1),this.defineProperty("tabIndex",-1,{set:function(t){this.renderer.set(this,"tabIndex",t)}}),this.defineProperty("disabled",!1,{set:function(t){this.renderer.set(this,"disabled",t)}}),this.defineProperty("readonly",!1,{set:function(t){this.renderer.set(this,"readonly",t)}}),this.defineProperty("resizable","none"),this.defineProperty("movable",!1),this.defineProperty("droppable",!1),this.defineProperty("tag",null),this.canFocus=function(){return this.tabIndex>=0},this.focus=function(){this.renderer.focus(this)},this.blur=function(){this.renderer.blur(this)},this.__update_dirty=2,this.invalidate=function(t){var e;return this.__update_dirty=2,(e=this.parent)?e.__update_dirty||t&&!this.__auto_size||e.invalidate(!0):this.__top_control&&flyingon.__delay_update(this),this},this.update=function(){return this.view&&this.__update_dirty&&this.renderer.update(this),this},this.refresh=function(){this.view&&this.renderer.update(this)},this.__do_scroll=function(t,e){},this.__do_change=function(t){this.trigger("change","value",t)!==!1&&this.text(t)},flyingon.__serialize_fragment(this);var d=this.clone;this.clone=function(){var t,e=d.call(this);return e.__dataset=this.__dataset,(t=this.__class_list)&&(e.__class_list=flyingon.extend({},t)),e},this.dispose=function(t){var e,i=this.__storage;return this.view&&this.renderer.dispose(this),(e=this.__dataset)&&e.subscribe(this,!0),this.__events&&this.off(),i&&((e=i.id)&&flyingon.__id_query_cache&&flyingon.__clear_id_query(i.id),(e=this.__class_list)&&flyingon.__class_query_cache&&flyingon.__clear_class_query(e,!0)),(e=this.__uniqueId)&&delete s[e],this.parent=this.previousSibling=this.nextSibling=null,this},this.__class_init=function(t,e){var i=t.xtype;i&&(i=i.toLowerCase(),(e=e.defaultClassName)&&(i=e+" "+i),this.defaultClassName=i)}}).alias("control"),flyingon.defineClass("Label",flyingon.Control,function(t){this.defineProperty("text","",{set:function(t){this.view&&this.renderer.set(this,"text",t)}}),this.defineProperty("html",!1)}).alias("label"),flyingon.defineClass("Button",flyingon.Control,function(t){this.defineProperty("text","",{set:function(t){this.view&&this.renderer.set(this,"text",t)}}),this.defineProperty("html",!1)}).alias("button"),flyingon.defineClass("LinkButton",flyingon.Control,function(t){this.defineProperty("text","",{set:function(t){this.view&&this.renderer.set(this,"text",t)}}),this.defineProperty("href","javascript:void 0",{set:function(t){this.view&&this.renderer.set(this,"href",t)}})}).alias("linkbutton"),flyingon.defineClass("TextBox",flyingon.Control,function(t){this.defaultValue("border",1),this.defaultValue("padding","0 2"),this.defaultValue("borderStyle","solid"),this.defineProperty("text","",{set:function(t){this.view&&this.renderer.set(this,"text",t)}})}).alias("textbox"),flyingon.defineClass("Panel",flyingon.Control,function(t){this.childControlType=flyingon.Control,this.defaultWidth=400,this.defaultHeight=300,this.firstChild=null,this.lastChild=null,this.defaultValue("droppable",!0),this.defineProperty("layout",null,{group:"locate",query:!0,set:function(t){this.__layout=null,(this.scrollLeft||this.scrollTop)&&this.renderer.__reset_scroll(this),this.invalidate()}}),this.defineProperty("fullRender",!1),this.children=function(){return this.__children||this.__init_children()},this.at=function(t){var e=this.__children||this.__init_children();return(t|=0)<0&&(t+=e.length),e[t]},this.__init_children=function(){for(var t=this.__children=[],e=this.firstChild;e;)t.push(e),e=e.nextSibling;return t},this.appendControls=function(t){var e,i,n=0;if(i=t&&t[n++]){for(this.__children=null,(e=this.lastChild)?(e.nextSibling=i,i.previousSibling=e):this.firstChild=i,e=i;i=t[n++];)i.previousSibling=e,e.nextSibling=i,e=i;this.lastChild=e}return this},this.appendChild=function(t){return this.insertBefore(t,null)},this.insertAt=function(t,e){return this.insertBefore(t,this.at(e))},this.insertBefore=function(t,e){var i=this.childControlType;if(!(t instanceof i))throw"control is not type of "+i.xtype;return(i=t.parent)&&i.removeChild(t,!1),t.parent=this,e&&e.parent!==this&&(e=null),flyingon.__type_query_cache&&flyingon.__clear_type_query(this),this.__children=null,e?((i=e.previousSibling)?(i.nextSibling=t,t.previousSibling=i):this.firstChild=t,e.previousSibling=t,t.nextSibling=e):(i=this.lastChild)?(this.lastChild=i.nextSibling=t,t.previousSibling=i):this.firstChild=this.lastChild=t,this.view&&t.view&&this.renderer.insertBefore(this,t),this.__update_dirty<2&&this.invalidate(!0),this},this.removeChild=function(t,e){var i,n;return t&&t.parent===this&&(flyingon.__type_query_cache&&flyingon.__clear_type_query(this),this.view&&t.view&&this.renderer.removeChild(this,t),t.parent=null,i=t.previousSibling||null,n=t.nextSibling||null,i?i.nextSibling=n:this.firstChild=n,n?n.previousSibling=i:this.lastChild=i,this.__children=null,e!==!1&&t.dispose(),this.__update_dirty<2&&this.invalidate(!0)),this},this.removeAt=function(t,e){var i=this.at(t);return i?this.removeChild(i,e):this},this.clear=function(t){var e=this.firstChild;if(e){t=t!==!1,flyingon.__type_query_cache&&flyingon.__clear_type_query(this),this.view&&e.view&&this.renderer.clear(this);do t?e.dispose():e.parent=e.previousSibling=e.nextSibling=null;while(e=e.nextSibling);this.firstChild=this.lastChild=null,this.__children=null,this.__update_dirty<2&&this.invalidate(!0)}return this},this.onmeasure=function(t,e){return!(!e||this.__visible_area===!1)&&(this.arrange(),void(1===e?t.offsetWidth=t.arrangeRight+t.border.width:t.offsetHeight=t.arrangeBottom+t.border.height))},this.__arrange_dirty=!0,this.arrange=function(){var t,e,i,n,r,s;if(t=this.boxModel){if(e=this.__auto_size)t.hscroll=t.vscroll=!1;else{switch(this.overflowX()){case"scroll":t.hscroll=!0;break;case"auto":r=!0;break;default:t.hscroll=!1}switch(this.overflowY()){case"scroll":t.vscroll=!0;break;case"auto":s=!0;break;default:t.vscroll=!1}}if(e=e||this.fullRender(),i=[],n=this.firstChild)do(n.__visible_area=n.visible())?i.push(n):n.boxModel=null;while(n=n.nextSibling);flyingon.arrange(this,i,r,s),e?this.__visible_list=i:this.__compute_visible(this.scrollLeft,this.scrollTop)}return this.__arrange_dirty=!1,this},this.__compute_visible=function(t,e){var i,n=this.__visible_list,r=this.boxModel,s=t+r.offsetWidth,o=e+r.offsetHeight,a=this.firstChild;for(n?n.length=0:n=this.__visible_list=[];a;)(a.__visible_area=(r=a.boxModel)&&(i=r.offsetLeft)<s&&i+r.offsetWidth>t&&(i=r.offsetTop)<o&&i+r.offsetHeight>e)&&n.push(a),a=a.nextSibling;return n},this.find=function(t){return new flyingon.Query(t,[this])},this.__do_scroll=function(t,e){this.__compute_visible(t,e),this.renderer.scroll(this,t,e)},this.findDropTarget=function(t,e){var i=this.controlAt(t,e);return i?[this,i]:[this,null]},this.controlAt=function(t,e){if(!this.firstChild)return this;var i,n=flyingon.getLayout(this);return(i=this.boxModel)&&(i=i.border)&&(t+=this.scrollLeft-i.left,e+=this.scrollTop-i.top),(i=n.__sublayouts)?(i=n.controlAt(i,t,e))?i.controlAt(t,e):null:n.controlAt(this.__children||this.__init_children(),t,e)},this.ondatareceive=function(e,i){var n=this.firstChild;for(t.ondatareceive.call(e,i);n;)n.__dataset||n.ondatareceive(e,i),n=n.nextSibling;return this},this.invalidate=function(t){var e,i;if(this.__update_dirty=2,this.__arrange_dirty=!0,e=this.parent){if(i=t&&!this.__auto_size?1:2,e.__update_dirty===i)return this;for(e.__update_dirty=i,i=e;e=i.parent;)e.__update_dirty||(e.__update_dirty=1),i=e}else i=this;return i.__top_control&&flyingon.__delay_update(i),this},this.update=function(){if(this.view)switch(this.__update_dirty){case 2:this.renderer.update(this);break;case 1:this.__update_children(),this.__update_dirty=0}return this},this.__update_children=function(){for(var t=this.firstChild;t;)t.__update_dirty&&t.update(),t=t.nextSibling},this.serialize=function(e){return t.serialize.call(this,e),this.firstChild&&e.writeProperty("children",this.children()),this},this.deserialize_children=function(t,e){var i,n,r;if(e=this.__children=t.readArray(e),e&&(n=e[0])){for(r=1,this.firstChild=i=n;n=e[r++];)n.previousSibling=i,i=i.nextSibling=n;this.lastChild=i}else this.firstChild=this.lastChild=null},this.dispose=function(){var e=this.firstChild;if(e){this.view&&this.renderer.clear(this);do e.dispose(!0);while(e=e.nextSibling);this.firstChild=this.lastChild=this.__children=null}return t.dispose.call(this)}}).alias("panel"),flyingon.defineClass("Tab",flyingon.Control,function(t){}).alias("tab"),flyingon.defineClass("TabPanel",flyingon.Panel,function(t){}).alias("tabpanel"),flyingon.defineClass("Tree",flyingon.Control,function(t){}).alias("tree"),flyingon.defineClass("Widget",flyingon.Panel,function(t){}).alias("widget"),flyingon.defineClass("Window",flyingon.Panel,function(t){}).alias("window"),flyingon.MessageBox=flyingon.defineClass(flyingon.Control,function(t){this.__top_control=!0,this.defaultValue("border",1),this.defaultValue("padding",2),this.defaultValue("minWidth",100),this.defaultValue("movable",!0),this.defineProperty("header",!0),this.defineProperty("title",""),this.defineProperty("icon",""),this.defineProperty("closable",!0),this.defineProperty("type",""),this.defineProperty("text",""),this.defineProperty("buttons",""),this.show=function(){return this.renderer.show(this),this},this.close=function(t){return this.view&&this.renderer.close(this),this.trigger("closed","button",t),this.dispose(),this}}),flyingon.showMessage=function(t){var e,i=new flyingon.MessageBox;if(t)if("string"==typeof t)i.text(t);else for(var n in t)"closed"===n?i.on("closed",t[n]):"function"==typeof(e=i[n])&&e.call(i,t[n]);return i.show(),i},flyingon.defineClass("PopupLayer",flyingon.Panel,function(){this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("width","auto"),this.defaultValue("height","auto"),this.defineProperty("closeLeave",!1),this.defineProperty("closeAway",!1),this.defineProperty("direction","bottom"),this.defineProperty("align","left"),this.defineProperty("reverse",!0),this.defineProperty("autoDispose",!0),this.show=function(t,e){return this.renderer.show(this,t,e,this.direction(),this.align(),this.reverse()),this.shown=!0,this},this.showAt=function(t,e){return this.renderer.showAt(this,t,e),this.shown=!0,this},this.close=function(t){return t=t||"ok",this.trigger("closing","closeType",t)!==!1&&(this.view&&this.renderer.close(this),this.trigger("closed","closeType",t),this.shown=!1,this.autoDispose()&&this.dispose(),this)}}).alias("popuplayer"),flyingon.defineClass("Dialog",flyingon.Panel,function(t){this.__top_control=!0,this.shown=!1,this.defaultValue("border",1),this.defaultValue("padding",2),this.defaultValue("movable",!0),this.defineProperty("headerHeight",0,{set:function(t){this.renderer.set(this,"headerHeight",t)}}),this.defineProperty("icon","",{set:function(t){this.renderer.set(this,"icon",t)}}),this.defineProperty("title","",{set:function(t){this.renderer.set(this,"title",t)}}),this.defineProperty("closable",!0,{set:function(t){this.renderer.set(this,"closable",t)}}),this.defineProperty("autoDispose",!0),this.onmeasure=function(t,e){return!(!e||this.__visible_area===!1)&&(this.arrange(),void(1===e?t.offsetWidth=t.arrangeRight+t.border.width:t.offsetHeight=this.headerHeight()+t.arrangeBottom+t.border.height))},this.show=function(t,e){return this.renderer.show(this,t,e),this},this.showDialog=function(t,e){return this.renderer.show(this,t,e,!0),this},this.close=function(t){return t||(t="ok"),this.trigger("closing","closeType",t)!==!1&&(this.view&&this.renderer.close(this),this.trigger("closed","closeType",t),this.shown=!1,this.autoDispose()&&this.dispose()),this}}).alias("dialog"),function(t){function e(e){return{template:e,init:function(){return t.create(this.viewModel||init_prototype.call(this))},create:function(){}}}t.window=function(i){var n,r=new t.Window,s=e(i.template),o=r.viewModel=s.init(),a=o.__storage=t.create(null);if(n=i.properties)for(var l in n)r.set(l,n[key]);if(n=i.defaults)for(var l in n)a[l]=n[l];return(n=i.init)&&n.call(r,o),r.appendControls(s.create()),(n=i.created)&&n.call(r,o),r},t.widget=function(i,n){if(!i||!n)throw"widget name or options not allow empty!";return t.defineClass(t.Widget,function(){var t,i=e(n.template),r=n.controller;if(this.constructor=function(){this.vm=i.init()},t=n.properties)for(var s in t)this.defaultValue(s,t[key]);this.init=function(){this.appendControls(i.create(this)),r&&r.call(this,this.vm)},n=t=null}).register(i)}}(flyingon),flyingon.Sublayout=flyingon.defineClass(flyingon.Control,function(t){this.defineProperty("scale",0,{check:function(t){return t>0?t:0}}),this.defineProperty("layout",null,{set:function(){this.__layout=null}}),this.defaultWidth=this.defaultHeight=200,this.onmeasure=function(t,e){return flyingon.arrange(this,this.__children,!1,!1,!0),!!e&&void(1===e?t.offsetWidth=t.arrangeRight+t.border.width:t.offsetHeight=t.arrangeBottom+t.border.height)},this.onlocate=function(t){var e=this.__children,i=t.offsetLeft,n=t.offsetTop;if(e&&(i||n))for(var r=e.length-1;r>=0;r--)(t=e[r].boxModel)&&(t.offsetLeft+=i,t.offsetTop+=n);return!1},this.controlAt=function(t,e){var i=this.__layout;return i?i.controlAt(this.__children,t,e):null},this.update=function(){}}),flyingon.Layout=flyingon.defineClass(function(){function t(t){if(t){if("string"!=typeof t)return i(t);if(t=h[t])return t[1]||(t[1]=i(t[0]))}return new l.flow}function e(t,e,n){for(var r,s,o,a,h=0,f=t.length;h<f;h++)if(s=t[h]){if(o=s.condition){if((a=o.width)&&(e<a[0]||e>a[1]))continue;if((a=o.height)&&(n<a[0]||n>a[1]))continue;r=s;break}r=s}return r?r.__layout||(r.__layout=i(r,!1)):new l.flow}function i(t,e){if(e!==!1&&t instanceof Array)return t;var i=new(l[t&&t.type]||l.flow);return i.deserialize(flyingon.SerializeReader.instance,t),i}function n(t,e,i,n,a){var l,h,f,u,c=t.__sublayouts;if(c)c===!0&&(c=t.__sublayouts=r(t.sublayouts())),s(c,i),i=c;else if(c=t.__location)if(c===!0&&(c=t.location(),t.__location=c),"function"==typeof c){f=c,c=f.values,l=e.clientWidth,h=e.clientHeight;for(var d=i.length-1;d>=0;d--)u=f(i[d],d,l,h),i[d].__location_values=u>=0?c[u]:u}else for(var d=i.length-1;d>=0;d--)i[d].__location_values=c;else for(var d=i.length-1;d>=0;d--)i[d].__location_values=null;n||a?o(t,e,i,n,a):t.arrange(e,i)}function r(t){var e=t.length;e||(t=[t],e=1);for(var i,n,r,s=flyingon.SerializeReader,o=new Array(t.length),a=0,l=0;r=t[--e];)(i=o[e]=new flyingon.Sublayout).deserialize(s,r),(n=i.scale())?((i.fixed=r=0|n)&&(a+=r),(i.weight=r=n-r)&&(l+=r)):(i.fixed=0,l+=i.weight=1);return o.fixed=a,o.weight=l,o}function s(t,e){var i=e.length-t.fixed,n=t.weight,r=0;i<0&&(i=0);for(var s=0,o=t.length;s<o;s++){var a,l=t[s],h=l.fixed,f=l.weight;f&&(a=i*f/n|0,n-=f,h+=a,i-=a),l.__children=e.slice(r,r+=h)}}function o(t,e,i,n,r){var s,o;n&&e.hscroll&&((e.clientHeight-=flyingon.hscroll_height)<0&&(e.clientHeight=0),s=!0),r&&e.vscroll&&((e.clientWidth-=flyingon.vscroll_width)<0&&(e.clientWidth=0),o=!0),t.arrange(e,i,!s&&n,!o&&r),(s=s&&e.arrangeRight<=e.arrangeLeft+e.clientWidth)&&(e.clientHeight+=flyingon.hscroll_height),(o=o&&e.arrangeBottom<=e.arrangeTop+e.clientHeight)&&(e.clientWidth+=flyingon.vscroll_width),(s||o)&&t.arrange(e,i)}function a(t,e){var i=t.clientWidth,n=t.arrangeRight;i<n&&(i=n);for(var r=0,s=e.length;r<s;r++)(n=e[r].boxModel)&&(n.offsetLeft=i-n.offsetLeft-n.offsetWidth)}var l=flyingon.create(null),h=flyingon.create(null);this.type=null,this.defineProperty("condition",null),this.defineProperty("spacingX","2"),this.defineProperty("spacingY","2"),this.defineProperty("rtl",!1),this.defineProperty("location",null,{set:function(t){this.__location=!!t}}),this.defineProperty("sublayouts",null,{set:function(t){this.__sublayouts=!!t}}),flyingon.layout=function(t,e){return t&&e&&"function"!=typeof e?void(h[t]=[e,null]):flyingon.load.key("layout",t,e)},flyingon.arrange=function(t,e,i,r,s){var o,l,h=t.boxModel,f=h.border,u=h.padding;h.arrangeLeft=u.left,h.arrangeTop=u.top,h.clientWidth=(l=h.offsetWidth-f.width-u.width)>0?l:0,h.clientHeight=(l=h.offsetHeight-f.height-u.height)>0?l:0,(l=t.arrangeArea)&&l.call(t,h),h.arrangeRight=h.arrangeLeft,h.arrangeBottom=h.arrangeTop,e&&e.length>0?(n(o=flyingon.getLayout(t),h,e,i,r,s),i&&(h.hscroll=h.arrangeRight>h.arrangeLeft+h.clientWidth),r&&(h.vscroll=h.arrangeBottom>h.arrangeTop+h.clientHeight),h.arrangeRight+=u.right,h.arrangeBottom+=u.bottom,s||!flyingon.rtl&&!o.rtl()||a(h,e)):h.hscroll=h.vscroll=!1},flyingon.getLayout=function(i){var n,r=i.__layout;return r||"function"!=typeof(n=i.layout)||(r=i.__layout=t(n.call(i))),r instanceof Array&&(n=i.boxModel,r=e(r,n.offsetWidth,n.offsetHeight)),r},this.arrange=function(t,e,i,n){},this.rearrange=function(t,e,i,n){var r=!1;if(i&&(1===i||t.arrangeRight>t.arrangeLeft+t.clientWidth)&&((t.clientHeight-=flyingon.hscroll_height)<0&&(t.clientHeight=0),i=!1,r=!0),n&&(1===n||t.arrangeBottom>t.arrangeTop+t.clientHeight)&&((t.clientWidth-=flyingon.vscroll_width)<0&&(t.clientWidth=0),n=!1,r=!0),r)return t.arrangeRight=t.arrangeLeft,t.arrangeBottom=t.arrangeTop,this.arrange(t,e,i,n),!0},this.controlAt=function(t,e,i){for(var n,r,s=0,o=t.length;s<o;s++)if((n=t[s].boxModel)&&e>=(r=n.offsetLeft)&&e<=r+n.offsetWidth&&i>=(r=n.offsetTop)&&i<=r+n.offsetHeight)return t[s];return null},flyingon.__serialize_fragment(this),this.deserialize_type=!0,this.__class_init=function(t,e){if(e.__class_init){var i=this.type;if(!i)throw flyingon.errortext("flyingon","layout type").replace("{0}",t.xtype);l[i]=t,h[i]=[null,new t]}}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="line",this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.clientWidth,l=t.clientHeight,h=s+a,f=flyingon.pixel(this.spacingX(),a),u=0,c=e.length;u<c;u++){if(r=e[u],r.measure(a,l,h-s||-1,l,2),r.locate(s,o,0,l,t),i&&t.arrangeRight>h)return this.rearrange(t,e,1,!1);s=t.arrangeX+f}}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="vertical-line",this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.clientWidth,l=t.clientHeight,h=o+l,f=flyingon.pixel(this.spacingY(),l),u=0,c=e.length;u<c;u++){if(r=e[u],r.measure(a,l,a,h-l||-1,1),r.locate(s,o,a,0,t),n&&t.arrangeBottom>h)return this.rearrange(t,e,!1,1);o=t.arrangeY+f}}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="flow",this.defineProperty("lineHeight",0,{dataType:"integer",check:function(t){return t>0?t:0}}),flyingon.locationProperty("newline",!1),this.arrange=function(t,e,i,n){for(var r,s,o=t.arrangeLeft,a=t.arrangeTop,l=t.clientWidth,h=t.clientHeight,f=o+l,u=a+h,c=flyingon.pixel,d=c(this.spacingX(),l),g=c(this.spacingY(),h),_=c(this.lineHeight(),h),p=o,y=0,v=e.length;y<v;y++){if(s=(r=e[y]).measure(l,h,f-o||-1,_||-1),o>p&&(o+s.offsetWidth+s.margin.right>f||r.locationValue("newline"))&&(o=p,a=(_?a+_:t.arrangeBottom)+g),r.locate(o,a,0,_,t),n&&t.arrangeBottom>u)return this.rearrange(t,e,!1,1);o=t.arrangeX+d}}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="vertical-flow",this.defineProperty("lineWidth",0,{dataType:"integer",check:function(t){return t>0?t:0}}),this.arrange=function(t,e,i,n){for(var r,s,o=t.arrangeLeft,a=t.arrangeTop,l=t.clientWidth,h=t.clientHeight,f=o+l,u=a+h,c=flyingon.pixel,d=c(this.spacingX(),l),g=c(this.spacingY(),h),_=c(this.lineWidth(),l),p=a,y=0,v=e.length;y<v;y++){if(s=(r=e[y]).measure(l,h,_||-1,u-a||-1),a>p&&(a+s.offsetHeight+s.margin.bottom>u||r.locationValue("newline"))&&(o=(_?o+_:t.arrangeRight)+d,a=p),r.locate(o,a,_,0,t),i&&t.arrangeRight>f)return this.rearrange(t,e,1,!1);a=t.arrangeY+g}}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="dock",flyingon.locationProperty("dock","left"),this.arrange=function(t,e,i,n){for(var r,s,o,a=t.arrangeLeft,l=t.arrangeTop,h=t.clientWidth,f=t.clientHeight,u=a+h,c=l+f,d=h,g=f,_=flyingon.pixel,p=_(this.spacingX(),h),y=_(this.spacingY(),f),v=0,m=e.length;v<m;v++)switch(s=e[v],s.locationValue("dock")){case"left":s.measure(d,g,h,f,2),s.locate(a,l,0,f,t),(h=u-(a=t.arrangeX+p))<0&&(h=0);break;case"top":s.measure(d,g,h,f,1),s.locate(a,l,h,0,t),(f=c-(l=t.arrangeY+y))<0&&(f=0);break;case"right":o=s.measure(d,g,h,f,2),u-=o.offsetWidth-o.margin.width,s.locate(u,l,0,f,t),(h=(u-=p)-a)<0&&(h=0);break;case"bottom":o=s.measure(d,g,h,f,1),c-=o.offsetHeight-o.margin.height,s.locate(a,c,h,0,t),(f=(c-=y)-l)<0&&(f=0);break;default:(r||(r=[])).push(s);continue}if(r)for(var v=0,m=r.length;v<m;v++)s.measure(d,g,h,f,3),s.locate(a,l,h,f,t);(i||n)&&this.rearrange(t,e,i,n)}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="cascade",this.arrange=function(t,e,i,n){for(var r,s=t.arrangeLeft,o=t.arrangeTop,a=t.clientWidth,l=t.clientHeight,h=0,f=e.length;h<f;h++)r=e[h],r.measure(a,l),r.locate(s,o,a,l,t);(i||n)&&this.rearrange(t,e,i,n)},this.controlAt=function(t,e,i){return-1}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="absolute",this.arrange=function(t,e,i,n){for(var r,s,o,a=t.arrangeLeft,l=t.arrangeTop,h=t.clientWidth,f=t.clientHeight,u=a+h,c=l+f,d=flyingon.pixel,g=0,_=e.length;g<_;g++)r=e[g],s=a+d(r.locationValue("left"),h),o=l+d(r.locationValue("top"),f),r.measure(h,f,u-a,c-l),r.locate(s,o,0,0,t)},this.controlAt=function(t,e,i){return-1}}),flyingon.defineClass(flyingon.Layout,function(t){this.type="uniform",this.defineProperty("size",20),this.arrange=function(t,e,i,n){for(var r,s,o,a=t.arrangeLeft,l=t.arrangeTop,h=t.clientWidth,f=t.clientHeight,u=e.length,c=this.size(),d=u-1,g=h-c*u,_=0;_<u;_++)s=(r=e[_]).measure(h,f,c,f,3),r.locate(a,l,0,f,t),o=g/d|0,a+=s.offsetWidth+o,g-=o,d--},this.controlAt=function(t,e,i){for(var n,r,s=0,o=t.length;s<o;s++)if((n=t[s].boxModel)&&e>=(r=n.offsetLeft)&&e<=r+n.offsetWidth)return t[s];return null}}),function(t){function e(t){function e(t,e,n){var r=[];do r.push(e);while(--n>0);return i=!0,r.join(" ")}var i,r=n;do i=!1,t=t.replace(r,e);while(i);return t}var i=flyingon.create(null),n=/L([^L\^]+)\^(\d+)/g,r=/[*%.\w]+|[\[\]{}()!]/g;t.parse=function(t){var n,s=i[t];return s?s.clone():(s=new o,(n=e(t||(t="")).match(r))&&s.parse(n,0),i[t]=s)};var s=t.Cell=flyingon.defineClass(function(){this.value=0,this.unit="",this.disabled=!1,this.group=null,this.start=0,this.size=0,this.clone=function(){var t,e=new s;return e.value=this.value,e.unit=this.unit,e.size=this.size,e.disabled=this.disabled,(t=this.group)&&(e.group=t.clone()),e}},!1),o=t.Group=flyingon.defineClass(function(){function t(t,e){for(var i,n=this.length,r=t;r<e;r++)if(i=this[r]){switch(i.unit){case"*":this.weight+=i.value;break;case"%":this.persent.push(i.value);break;default:this.fixed+=i.value}this[n++]=i.clone()}this.length=n}function e(e,i){var n,r,s;if(e===!1)(e=this.__auto)&&([].splice.call(this,e.length),this.fixed=e.fixed,this.weight=e.weight,(s=e.persent)&&this.persent.splice(s));else if(e>0&&(i-=this.count())>0&&((n=(r=this.length)-e)<0&&(n=0),(e=this.count(n))>0)){this.__auto={length:r,fixed:this.fixed,weight:this.weight,persent:(s=this.persent)&&s.length},e=Math.ceil(i/e);for(var o=0;o<e;o++)t.call(this,n,r);return this.length}}var i=flyingon.pixel,n=parseFloat;this.length=0,this.fixed=0,this.weight=0,this.persent=null,this.parameters=null,this.start=0,this.size=0,this.parse=function(t,e){for(var r,a,l,h=this.length;r=t[e++];)switch(r){case"[":case"{":a||(a=this[h++]=new s,a.value=100,a.weight=100,this.width+=100),e=(a.group=new o).parse(t,e);break;case"]":case"}":return this.length=h,e;case"(":for(;")"!==(r=t[e++]);)r.indexOf("%")<0&&(r=i(r)),(this.parameters||(this.parameters=[])).push(r);break;case"!":a&&(a.disabled=!0);break;default:if(a=this[h++]=new s,"*"===r)a.value=100,a.unit="*",this.weight+=100;else if((l=n(r))===l){switch(a.unit=r.replace(l,"")){case"*":this.weight+=l;break;case"%":(this.percent||(this.persent=[])).push(this.value);break;default:this.fixed+=l=a.size=i(r)}a.value=l}}return this.length=h,e},this.count=function(t){var e,i=0;for(t|=0;e=this[t++];)e.disabled||((e=e.group)?i+=e.count():i++);return i},this.measure=function(t,i,n,r,s,o,a){var l=[t,i,n,r,s,o,0];o>0?l[6]=e.call(this,o,a.length):this.__auto&&e.call(this,!1),this.__keys!==(l=l.join(","))&&(this.compute(t,i,n,r,s),this.__keys=l)},this.compute=function(t,e,n,r,s){var o,a,l,h,f=this.parameters,u=this.weight,c=0,d=this.length;if(this.width=t,this.height=e,f&&((h=f[0])&&(n=h>0?h:i(h,n)),(h=f[1])&&(r=h>0?h:i(h,r))),(s=!s)?(a=e,l=r):(a=t,l=n),a>0&&(f=this.persent)){f=f.slice(0),h=0;for(var g=f.length-1;g>=0;g--)h+=f[g]=a*f[g]/100+.5|0;(a-=h)<0&&(a=0),f.index=0}a>0&&(a-=this.fixed+l*(d-1))<0&&(a=0);for(var g=0;g<d;g++)if(o=this[g]){switch(o.unit){case"*":a>0?(h=o.value,a-=o.size=h*a/u|0,u-=h):o.size=0;break;case"%":o.size=f[f.index++]||0}o.start=c,c+=o.size+l,(h=o.group)&&(s?h.compute(t,o.size,n,r,s):h.compute(o.size,e,n,r,s))}},this.clone=function(){var t,e=new this.Class,i=this.length;if(e.length=i,e.fixed=this.fixed,e.weight=this.weight,e.parsent=(t=this.persent)&&t.slice(0),e.parameters=this.parameters,(t=this.length)>0)for(var n=0;n<t;n++)e[n]=this[n].clone();return e}},!1)}(flyingon.Layout),flyingon.defineClass(flyingon.Layout,function(t){function e(t,e,n,r,s,o,a,l){for(var h,f,u,c=r.width,d=0,g=r.length;d<g;d++)if((h=r[d])&&!h.disabled)if(u=h.group){if(o=i(t,e,n,u,s,o,a,l+h.start),o<0)return-1}else{if(!(f=s[o++]))return-1;f.measure(e,n,c,u=h.size,3),f.locate(a,l+h.start,c,u,t)}return o}function i(t,i,n,r,s,o,a,l){for(var h,f,u,c=r.height,d=0,g=r.length;d<g;d++)if((h=r[d])&&!h.disabled)if(u=h.group){if(o=e(t,i,n,u,s,o,a+h.start,l),o<0)return-1}else{if(!(f=s[o++]))return-1;f.measure(i,n,u=h.size,c,3),f.locate(a+h.start,l,u,c,t)}return o}var n=flyingon.Layout.parse;this.type="table",this.defineProperty("vertical",!1),this.defineProperty("data","*[* * *] *[* * *] *[* * *]",{set:function(){this.__data=null}}),this.defineProperty("auto",0),this.arrange=function(t,r,s,o){var a=this.__data||(this.__data=n(this.data())),l=this.vertical(),h=t.clientWidth,f=t.clientHeight,u=flyingon.pixel,c=u(this.spacingX(),h),d=u(this.spacingY(),f);a.measure(h,f,c,d,l,this.auto(),r),(l?i:e)(t,h,f,a,r,0,t.arrangeLeft,t.arrangeTop),(s||o)&&this.rearrange(t,r,s,o)}}),flyingon.globalEval=function(t){window.execScript?window.execScript(t):window.eval(t)},flyingon.absoluteUrl=function(){var t,e=document.createElement("a"),i=location.href.replace(/[?#][\s\S]*/,"");return e.href="",e.href||(e=document.createElement("div"),t=/"/g),function(n,r){return n?t?(e.innerHTML='<a href="'+n.replace(t,"%22")+'"></a>',n=e.firstChild.href):(e.href=n,n=e.href):n=i,r?n.substring(0,n.lastIndexOf("/")+1):n}}(),document.head||(document.head=document.getElementsByTagName("head")[0]),flyingon.script=-[1]&&9!==document.documentMode?function(t,e){var i=document.createElement("script");return i.onload=i.onerror=function(){e&&(e.call(this),e=null),i=i.onload=i.onerror=null},i.async=!1,i.src=t,document.head.appendChild(i),i}:function(){function t(){for(var t,n;(t=e[0])&&"loaded"===t.readyState;)e.shift(),t.onreadystatechange=null,i.insertBefore(t,i.lastChild||null),(n=e.shift())&&n.call(t)}var e=[],i=document.head;return function(i,n){var r=document.createElement("script");return e.push(r,n),r.onreadystatechange=t,r.src=i,r}}(),flyingon.link=function(t,e,i){var n=document.createElement("link");return n.href=t,n.type=e||"text/css",n.rel=i||"stylesheet",document.head.appendChild(n),n},flyingon.style=function(t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.head.appendChild(e),e},function(t,e){function i(t){var e,i=this.__events;if(i=i&&i[t.type]){t.target||(t.target=t.srcElement,t.preventDefault=r,t.stopPropagation=s,t.stopImmediatePropagation=o);for(var n=0,a=i.length;n<a&&(!(e=i[n])||e.disabled||(e.call(this,t)===!1&&t.returnValue!==!1&&t.preventDefault(),!t.cancelBubble));n++);}}function n(e){function n(e){i.call(n.dom,e||t.event)}return n.dom=e,e=null,n}function r(){this.returnValue=!1,this.__preventDefault&&this.__preventDefault()}function s(){this.cancelBubble=!0,this.__stopPropagation&&this.__stopPropagation()}function o(){this.cancelBubble=!0,this.returnValue=!1,this.__stopImmediatePropagation&&this.__stopImmediatePropagation()}function a(t){t.stopPropagation()}var l=t.Event&&Event.prototype,h="addEventListener";t[h]?l&&!l.__stopPropagation&&(l.__preventDefault=l.preventDefault,l.__stopPropagation=l.stopPropagation,l.__stopImmediatePropagation=l.stopImmediatePropagation,l.preventDefault=r,l.stopPropagation=s,l.stopImmediatePropagation=o):h=!1,e.dom_once=function(t,i,n){function r(){n.apply(this,arguments),e.dom_off(t,i,r)}e.dom_on(t,i,r)},e.dom_on=function(t,e,r,s){if(t&&e&&r){var o,a=t.__events;if(a){if(o=a[e])return o.push(r),this}else a=t.__events={};a[e]=[r],h?t[h](e,i,s):t.attachEvent("on"+e,a.trigger||(a.trigger=n(t)))}},e.dom_suspend=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i.unshift(a)},e.dom_resume=function(t,e){var i=t&&t.__events;(i=i&&i[e])&&i[0]===a&&i.shift()},e.dom_off=function(t,e,n){var r,s=t&&t.__events;if(r=s&&s[e]){if(n){for(var o=r.length-1;o>=0;o--)r[o]===n&&r.splice(o,1);if(r.length>0)return}h?t.removeEventListener(e,i):t.detachEvent("on"+e,s.trigger),delete s[e];for(e in s)return;(n=s.trigger)&&(s.trigger=n.dom=null),t.__events=void 0}}}(window,flyingon),function(t,e){function i(t,e){return e.toUpperCase()}function n(t){var e=t.replace(h,i),n=t;return e in r||(e=l+e.charAt(0).toUpperCase()+e.substring(1),e in r?n="-"+l+"-"+t:e=n=""),a[t]={name:e,css:n}}var r,s,o=t.documentElement,a=e.create(null),l="ms",h=/^-(\w+)-/;if(s=window.getComputedStyle){r=s(o);for(var f=r.length-1;f>=0;f--)if(s=r[f].match(h)){l=s[1];break}}r=o.style,h=/\-(\w)/g,e.css_name=function(t){return(a[t]||n(t)).name},e.css_value=function(t,e,i){var r,s=a[e]||n(e);(r=s.set)?r(i,t):(r=s.name)&&(t.style[r]=i)},e.css_text=function(t,e){return t=(a[t]||n(t)).css,t?t+":"+e+";":""},e.css_fixed=function(t,e,r){t&&e&&!n(t).name&&(a[t]={name:r||t.replace(h,i),css:t,set:e})},e.css_fixed("user-select",function(){function e(){return!1}return function(i,n){n&&((n===t.body?t:n).onselectstart="none"===i?e:null)}}())}(document,flyingon),flyingon.ready=function(){function t(){if(i){flyingon.dom_off(document,"DOMContentLoaded",t),flyingon.dom_off(window,"load",t);for(var e=0;e<i.length;e++)i[e++].call(i[e]);i=null,n&&clearTimeout(n)}}function e(){"complete"===document.readyState?t():(i||(i=[],flyingon.dom_on(document,"DOMContentLoaded",t),flyingon.dom_on(window,"load",t)),n=setTimeout(e,0))}var i,n;return e(),function(t,e){"function"==typeof t&&(i?i.push(t,e):t.call(e))}}(),flyingon.dom_test=function(){var t,e=document.createElement("div");return e.id="flyingon-dom-test",e.style.cssText="position:absolute;overflow:hidden;margin:0;border:0;padding:0;left:-10px;top:0;width:0;height:0;",document.body?document.body.appendChild(e):(t=[],flyingon.ready(function(){var i,n=0;for(t=null,document.body.appendChild(e);i=this[n++];)i.call(this[n++],e)},t)),function(i,n){t?t.push(i,n):i.call(n,e)}}(),flyingon.dom_html=document.head.insertAdjacentHTML?function(){function t(t,i,n,r){i.insertAdjacentHTML?i.insertAdjacentHTML(n,r):(i=e||(e=document.createElement("div")),i.innerHTML=r,(i=i.firstChild)&&(i.parentNode.removeChild(i),t.appendChild(i)))}var e;return function(e,i,n){e&&i&&(n?t(e,n,"beforebegin",i):(n=e.lastChild)?t(e,n,"afterend",i):e.innerHTML=i)}}():function(t,e,i){var n;i?(n=document.createRange(),n.setStartBefore(i),t.insertBefore(n.createContextualFragment(e),i)):(i=t.lastChild)?(n=document.createRange(),n.setStartAfter(i),t.appendChild(n.createContextualFragment(e))):t.innerHTML=e},flyingon.dom_drag=function(t,e,i,n,r,s,o){function a(e){i&&(e.dom=u,i.call(t,e)),flyingon.dom_suspend(u,"click",!0),flyingon.css_value(document.body,"user-select","none"),u.setCapture&&u.setCapture(),a=null}function l(e){var i=e.clientX-y,r=e.clientY-v;(!a||(i<-2||i>2||r<-2||r>2)&&a(e))&&(n&&(e.dom=u,e.distanceX=i,e.distanceY=r,n.call(t,e),i=e.distanceX,r=e.distanceY),m=i,b=r,s!==!0&&("x"!==s&&(c.left=_+i+"px"),"y"!==s&&(c.top=p+r+"px")),e.stopImmediatePropagation())}function h(e){g(document,"mousemove",l),g(document,"mouseup",h),a||(flyingon.css_value(document.body,"user-select",""),u.setCapture&&u.releaseCapture(),setTimeout(f,0),r&&(e.dom=u,e.distanceX=m,e.distanceY=b,r.call(t,e)))}function f(){flyingon.dom_resume(u,"click",!0)}var u=e.dom||e.target,c=u.style,d=flyingon.dom_on,g=flyingon.dom_off,_=u.offsetLeft,p=u.offsetTop,y=e.clientX,v=e.clientY,m=0,b=0;o===!1&&a(e),d(document,"mousemove",l),d(document,"mouseup",h),e.stopImmediatePropagation()},flyingon.dom_align=function(t,e,i,n,r){var s=t.offsetWidth,o=t.offsetHeight,a=t.style,l=document.body.scrollLeft,h=document.body.scrollTop,f=l+e.left,u=h+e.top,c=l+e.right,d=h+e.bottom;if(r!==!1)switch(t=document.documentElement,l=window.innerWidth||t.offsetWidth||0,h=window.innerHeight||t.offsetHeight||0,i){case"left":f<s&&l-c>=s&&(i="right");break;case"top":u<o&&h-d>=o&&(i="bottom");break;case"right":f>=s&&l<c+s&&(i="left");break;default:u>=o&&h<d+o&&(i="top")}if("left"===i||"right"===i)switch(l="left"===i?f-s:c,n){case"middle":h=u+(d-u-o>>1);break;case"bottom":h=d-o;break;default:h=u}else{switch(n){case"center":l=f-(c-f-s>>1);break;case"right":l=c-s;break;default:l=f}h="top"===i?u-o:d}return a.left=l+"px",a.top=h+"px",{left:l,top:h}},flyingon.dom_overlay=function(){var t=[],e=document.createElement("div");return e.className="flyingon-overlay",function(i,n){if(i){var r;if(n===!1){if(t[t.length-1]===i){for(i.flyingon_overlay=!1,t.pop();i=t[t.length-1];){if(e.style.zIndex=i.style.zIndex,r=i.parentNode)return void r.insertBefore(e,i);i.flyingon_overlay=!1,t.pop()}(r=e.parentNode)&&r.removeChild(e)}}else(r=i.parentNode)&&(e.style.zIndex=i.style.zIndex,r.insertBefore(e,i),i.flyingon_overlay=!0,t.push(i))}}}(),flyingon.html_encode=function(){var t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};return function(e){if(e){var i=t;return e.replace(/([&<>'"])/g,function(t,e){return i[e]})}return""}}(),flyingon.MouseEvent=flyingon.defineClass(flyingon.Event,function(){this.constructor=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,(this.which=t.which)||(this.which=1&t.button?1:2&t.button?3:2),this.clientX=t.clientX,this.clientY=t.clientY}}),flyingon.KeyEvent=flyingon.defineClass(flyingon.Event,function(){this.constructor=function(t){this.original_event=t,this.type=t.type,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.which=t.which||t.charCode||t.keyCode}}),flyingon.Renderer=flyingon.defineClass(function(){var t=null,e="position:absolute;margin:0;overflow:hidden;";this.__text_name="textContent"in document.head?"textContent":"innerText",this.__no_padding=!0,this.bind=function(t){for(var e,i=arguments.length-1;i>=0;i--)(e=arguments[i])&&((e.prototype||e).renderer=this)},this.bind(flyingon.Control),this.sync_properties=function(t){for(var e,i=(t.prototype||t).properties(!1),n=0,r=i.length;n<r;n++)(e=i[n])&&e.dom&&(this[e.name]=e.dom)},this.sync_properties(flyingon.Control),this.id=function(t,e,i){e.setAttribute("id",i)},this.className=function(t,e,i){e.className=i?t.defaultClassName+" "+i:t.defaultClassName},this.border=function(t,e,i){e.style.borderWidth=i>0?i+"px":i},this.padding=function(t,e,i){e.style.padding=i>0?i+"px":i},this.text=function(t,e,i){e[this.__text_name]=i},this.html=function(t,e,i){e.innerHTML=i&&flyingon.html_encode(i)||""},this.disabled=function(t,e,i){i?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled")},this.readonly=function(t,e,i){i?e.setAttribute("readonly","readonly"):e.removeAttribute("readonly")},this.focus=function(t){t.view.focus()},this.blur=function(t){t.view.blur()},this.checkBoxModel=function(t){var e=t.style,i=flyingon.pixel;return e.width=e.height="100px",e.padding="2px",e.overflow="scroll",(this.__no_border=100!==t.offsetWidth)?(e.padding="",e=t.currentStyle||window.getComputedStyle(t),this.__border_width=i(e.borderLeftWidth)+i(e.borderRightWidth),this.__border_height=i(e.borderTopWidth)+i(e.borderBottomWidth),this.__padding_width=i(e.paddingLeft)+i(e.paddingRight),this.__padding_height=i(e.paddingTop)+i(e.paddingBottom),void 0):(this.__border_width=this.__border_height=this.__padding_width=this.__padding_height=0,!0)},flyingon.dom_test(function(t){var i=flyingon.css_text("box-sizing","border-box");t.innerHTML='<div class="flyingon-control" style="'+e+i+'"><div>',this.checkBoxModel(t.children[0])&&i&&(e+=i)},this),this.locate=function(t){var e,i=t.__locate_style={},n=t.boxModel,r=n.offsetWidth,s=n.offsetHeight;return r>0&&s>0?(t.__size_tag=(s<<16)+r,this.__no_border&&((e=n.border)&&e.text?(r-=e.width,s-=e.height):(r-=this.__border_width,s-=this.__border_height),this.__no_padding&&((e=n.padding)&&e.text?(r-=e.width,s-=e.height):(r-=this.__padding_width,s-=this.__padding_height))),i.width=r+"px",i.height=s+"px",i.left=(r=n.offsetLeft)+"px",i.top=(s=n.offsetTop)+"px",t.__location_tag=(s<<16)+r,i.display="block"):i.display="none",i},this.cssText=function(t){var i=[e],n=this.locate(t,!0);for(var r in n)i.push(r,":",n[r],";");return i.join("")},this.render=function(t,e){e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),'"></div>')},this.createView=function(t,e){var i,n;if(e=e||document.body,this.render(t,n=[]),(i=e.lastChild)?(flyingon.dom_html(e,n.join("")),i=e.lastChild):(e.innerHTML=n.join(""),i=e.firstChild),i)return this.initView(t,t.view=i),i},this.initView=function(t,e){var i;e.flyingon_id=t.uniqueId(),(i=t.__view_patch)&&(t.__view_patch=null,this.applyPatch(t,e,i)),t.__update_dirty=0},this.update=function(t){var e,i=t.view,n=i.style,r=t.__locate_style,s=this.locate(t);for(var o in s)e=s[o],r&&e===r[o]||(n[o]=e);(e=t.__view_patch)&&(t.__view_patch=null,this.applyPatch(t,i,e)),t.__update_dirty=0},this.applyPatch=function(t,e,i){var n,r,s=e.style;for(var o in i)switch(r=i[o],n=this[o]){case 1:s[o]=r;break;case 2:flyingon.css_value(e,o,r);break;default:"function"==typeof n&&n.call(this,t,e,r)}},this.set=function(e,i,n){var r=e.__view_patch;r?r[i]=n:((e.__view_patch={})[i]=n,e.view&&((r=t)?r.push(e):(r=t=[e],setTimeout(flyingon.__update_patch,0))))},flyingon.__update_patch=function(){var e,i,n,r=t;if(r){for(var s=0,o=r.length;s<o;s++)(e=r[s])&&(n=e.__view_patch)&&(i=e.view)&&(e.__view_patch=null,e.renderer.applyPatch(e,e.view,n));r.length=0,t=null}},this.dispose=function(t){t.view=null}},!1),flyingon.defineClass(flyingon.Renderer,function(t){this.bind(flyingon.Label),this.render=function(t,e){e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),';">',flyingon.html_encode(t.text()),"</div>")},this.text=function(t,e,i){t.html()?e.innerHTML=flyingon.html_encode(i):e[this.__text_name]=i}}),flyingon.defineClass(flyingon.Renderer,function(t){this.bind(flyingon.Button),this.render=function(t,e){e.push('<button class="',t.defaultClassName,'" style="',this.cssText(t),';">',flyingon.html_encode(t.text()),"</button>")},this.text=function(t,e,i){t.html()?e.innerHTML=flyingon.html_encode(i):e[this.__text_name]=i}}),flyingon.defineClass(flyingon.Renderer,function(t){this.bind(flyingon.LinkButton),this.render=function(t,e){var i=flyingon.html_encode;e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),';">','<a href="',i(t.href()),'">',i(t.text()),"</a>","</div>")},this.text=function(t,e,i){e.innerHTML=flyingon.html_encode(i)},this.href=function(t,e,i){e.href=i}}),flyingon.defineClass(flyingon.Renderer,function(t){function e(t){var e=this.view;this.view=null,this.text(t.original_event.target.value),this.view=e}this.bind(flyingon.TextBox),this.render=function(t,e){e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),'border-width:1px;border-style:solid;">','<input type="text" class="flyingon-textbox-text" value="',flyingon.html_encode(t.text()),'" />',"</div>")},this.text=function(t,e,i){e.firstChild.value=i},this.initView=function(i,n){t.initView.call(this,i,n),i.on("change",e)}}),flyingon.PanelRenderer=flyingon.defineClass(flyingon.Renderer,function(t){function e(t){this.view.firstChild.scrollTop-=100*t.wheelDelta/120,t.stopPropagation()}function i(t){console.log(t.which)}function n(t,e){for(var i,n=0;i=t[n++];)i.renderer.render(i,e)}function r(t,e){var i,n=0;if(0===e[0])for(n++,i=t.lastChild;i;)t.removeChild(i),i=t.lastChild;for(;i=e[n++];)i.parentNode===t&&t.removeChild(i)}function s(t,e){for(var i,n,r=t.view_body,s=0;i=e[s++];)i.parent===t&&(n=i.view)&&r.insertBefore(n,l(i.nextSibling))}function o(t,e,i){for(var n,r=e;r&&(r.view?n&&(a(t,n,r.view),n=null):(n||(n=[])).push(r),r!==i);)r=r.nextSibling;n&&a(t,n,l(i.nextSibling))}function a(t,e,i){var r,s=i?i.previousSibling:t.lastChild;n(e,r=[]),flyingon.dom_html(t,r.join(""),i),i=s&&s.nextSibling||t.firstChild;for(var o=0,a=e.length;o<a;o++)(r=e[o]).renderer.initView(r,r.view=i),i=i.nextSibling;e.length=0}function l(t){for(var e;t;){if(e=t.view)return e;t=t.nextSibling}return null}function h(t){var e=t.boxModel,i=e.offsetLeft,n=e.offsetTop,r=t.view.style,s=t.__locate_style;t.__location_tag=(n<<16)+i,r.left=s.left=i+"px",r.top=s.top=n+"px"}this.__no_padding=!1,this.bind(flyingon.Panel),this.padding=0,this.insertBefore=function(t,e){(t.__view_insert||(t.__view_insert=[])).push(e)},this.removeChild=function(t,e){(t.__view_remove||(t.__view_remove=[])).push(e.view)},this.clear=function(t){var e=this.__view_remove;e?(e.length=0,e.push(0)):this.__view_remove=[0]},this.initView=function(n,r){t.initView.call(this,n,r),n.on("mousewheel",e),n.on("keypress",i),this.__init_children(n,r.lastChild,r.firstChild)},this.__init_children=function(t,e,i){for(var n=t.firstChild,r=(t.view_body=e).firstChild.nextSibling;n&&r;)n.renderer.initView(n,n.view=r),n=n.nextSibling,r=r.nextSibling;(t.view_scroll=i).onscroll=flyingon.__dom_scroll},this.render=function(t,e){t.__arrange_dirty&&t.arrange(),e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),'">'),this.renderBody(t,e),e.push("</div>")},this.renderBody=function(t,e){var i='<div style="position:relative;overflow:hidden;margin:0;border:0;padding:0;width:1px;height:1px;visibility:hidden;margin-left:',r=t.boxModel,s=r.hscroll?r.arrangeRight-1:-1,o=r.vscroll?r.arrangeBottom-1:-1;e.push('<div style="position:absolute;left:0;top:0;right:0;bottom:0;width:auto;height:auto;overflow:auto;">',i,s,"px;margin-top:",o,'px;"></div>',"</div>",'<div class="flyingon-body" style="position:relative;overflow:hidden;margin:0;border:0;padding:0;left:0;top:0;width:100%;height:100%;">',i,s,"px;margin-top:",o,'px;"></div>'),(r=t.__visible_list)&&r[0]&&n(r,e),e.push("</div>")},this.locate=function(e,i){var n=t.locate.call(this,e),r=e.boxModel,s=e.__auto_size,o=2&s||!r.vscroll?0:flyingon.vscroll_width+"px",a=1&s||!r.hscroll?0:flyingon.hscroll_height+"px";return i?(n[flyingon.rtl?"padding-left":"padding-right"]=o,n["padding-bottom"]=a):(n[flyingon.rtl?"paddingLeft":"paddingRight"]=o,n.paddingBottom=a),n},this.update=function(e){var i,n,a;if((a=e.__view_remove)&&(e.__view_remove=null,r(e.view_body,a)),(a=e.__view_insert)&&(e.__view_insert=null,s(e,a)),e.__arrange_dirty&&(e.arrange(),this.__update_scroll(e)),(i=e.__visible_list)&&(n=i[a=0]))do if(!n.view){o(e.view_body,n,i[i.length-1]);break}while(n=i[a++]);for(t.update.call(this,e),n=e.firstChild;n;)n.view&&(n.__update_dirty?n.renderer.update(n):n.__location_dirty&&(n.__location_dirty=!1,h(n))),n=n.nextSibling},this.__update_scroll=function(t){var e,i=t.view_scroll.firstChild.style,n=t.view_body.firstChild.style,r=t.boxModel;r.__hscroll_length!==(e=r.hscroll?r.arrangeRight-1+"px":"-1px")&&(r.__hscroll_length=i.marginLeft=n.marginLeft=e),r.__vscroll_length!==(e=r.vscroll?r.arrangeBottom-1+"px":"-1px")&&(r.__vscroll_length=i.marginTop=n.marginTop=e)},this.scroll=function(t,e,i){var n=t.view_body;this.update(t),n.scrollLeft=e,n.scrollTop=i},this.dispose=function(t){var e,i=t.view;i&&((e=t.view_scroll)&&(t.view_scroll=e.onscroll=null),t.view=t.view_body=null)}}),flyingon.defineClass(flyingon.Renderer,function(t){function e(t){if(1===t.which&&this.movable())switch(n(t)){case"header":case"close":this.renderer.movable(this,t)}}function i(t){"close"===n(t)&&this.close("none")}function n(t){var e,i=t.original_event.target;do if(e=i.getAttribute("tag"))return e;while(i=i.parentNode)}this.bind(flyingon.MessageBox),this.render=function(t,e){var i;e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),'" tag="dialog">','<div class="flyingon-messagebox-header" tag="header">','<span class="flyingon-messagebox-icon" ',(i=t.icon())?'class="'+i:'style="dispaly:none;','"></span>','<span class="flyingon-messagebox-title">',t.title(),"</span>",'<span class="flyingon-messagebox-close"',t.closable()?"":' style="display:none;"',' tag="close"></span>',"</div>",'<div class="flyingon-messagebox-body">','<span class="flyingon-messagebox-type" ',(i=t.type())?'class="'+i:'style="display:none;','"></span>','<span class="flyingon-messagebox-text">',t.text(),"</span>","</div>","</div>")},this.show=function(t){var e,i,n=document.body,r=t.view;r?n.appendChild(r):r=this.createView(t,n),flyingon.dom_overlay(r),e=t.boxModel.offsetWidth,e=n.clientWidth-e>>1,i=t.boxModel.offsetHeight,i=((window.innerHeight||document.documentElement.clientHeight)-i>>1)-n.clientLeft,t.measure(0,0),t.locate(0|e,0|i),t.update()},this.initView=function(n,r){t.initView.call(this,n,r),n.on("mousedown",e),n.on("click",i)},this.movable=function(t,e){e=e.original_event,e.dom=t.view,flyingon.dom_drag(t,e),e.dom=null},this.close=function(t){var e,i=t.view;flyingon.dom_overlay(i,!1),(e=i.parentNode)&&e.removeChild(i)}}),flyingon.defineClass(flyingon.PanelRenderer,function(t){function e(t){var e,i;if((e=r)&&(i=e.__closeAway)){var n=e.__view_rect,s=t.clientX,o=t.clientY;n?(n.left-s>i.x1||s-n.right>i.x2||n.top-o>i.y1||o-n.bottom>i.y2)&&e.close("auto"):(e.__view_rect=n=e.view.getBoundingClientRect(),e.__closeAway={x1:(i=n.left-s)>0?i+4:4,x2:(i=s-n.right)>0?i+4:4,y1:(i=n.top-o)>0?i+4:4,y2:(i=o-n.bottom)>0?i+4:4})}}function i(t){var e=r;if(e&&e.view===this){var i=this.getBoundingClientRect(),n=t.clientX,s=t.clientY;(n>=i.right||s>=i.bottom||n<=i.left||s<=i.top)&&e.close("auto")}}var n=[],r=null,s=flyingon.dom_on,o=flyingon.dom_off;this.bind(flyingon.PopupLayer),s(document,"mousedown",function(t){var e;if(e=r){for(var i=e.view,n=e.__view_reference,s=t.target;s;){if(s===i||s===n)return;s=s.parentNode}e.trigger("autoclosing","dom",t.target)!==!1&&e.close("auto")}}),s(document,"keydown",function(t){var e;(e=r)&&27===t.which&&e.close("cancel")}),this.show=function(t,e,i,n,r,s){var o,a=(t.__view_reference=e.view||e).getBoundingClientRect();i&&(a={top:a.top-(0|i[0]),right:a.right+(0|i[1]),bottom:a.bottom+(0|i[2]),left:a.left-(0|i[3])}),this.showAt(t,0,0),a=flyingon.dom_align(t.view,a,n,r,s),o=t.boxModel,o.offsetLeft=a.left,o.offsetTop=a.top},this.showAt=function(t,o,a){var l;t.trigger("open"),t.measure(0,0),t.locate(0|o,0|a),(l=t.view)?document.body.appendChild(l):this.createView(t,document.body),n.push(r=t),(t.__closeAway=t.closeAway())&&!e.count++&&(e.count=1,s(document,"mousemove",e)),(t.__closeLeave=t.closeLeave())&&s(l,"mouseout",i)},this.close=function(t){var s,a=t.view;t.__view_reference=null,t.__closeAway&&(t.__closeAway=t.__view_rect=null,--e.count||o(document,"mousemove",e)),t.__closeLeave&&o(a,"mouseout",i),n.pop(),r=n[n.length-1],(s=a.parentNode)&&s.removeChild(a)}}),flyingon.defineClass(flyingon.PanelRenderer,function(t){function e(t){if(1===t.which&&this.movable())switch(n(t)){case"header":case"close":this.renderer.movable(this,t)}}function i(t){switch(n(t)){case"close":this.close();break;case"header":}}function n(t){var e,i=t.original_event.target;do if(e=i.getAttribute("tag"))return e;while(i=i.parentNode)}this.bind(flyingon.Dialog),flyingon.dom_test(function(t){t.innerHTML='<div class="flyingon-dialog-header"></div>',flyingon.Dialog.prototype.defaultValue("headerHeight",t.children[0].offsetHeight)}),this.initView=function(n,r){t.base.initView.call(this,n,r),r=r.lastChild,this.__init_children(n,r.lastChild,r.firstChild),n.on("mousedown",e),n.on("click",i)},this.render=function(t,e,i){t.__arrange_dirty&&t.arrange(),e.push('<div class="',t.defaultClassName,'" style="',this.cssText(t),'" tag="dialog">','<div class="flyingon-Dialog-header" tag="header">','<span class="flyingon-Dialog-icon" style="display:none;"></span>','<span class="flyingon-Dialog-title"></span>','<span class="flyingon-Dialog-close" tag="close"></span>',"</div>",'<div class="flyingon-Dialog-body" tag="body">'),this.renderBody(t,e),e.push("</div></div>")},this.headerHeight=function(t,e,i){var n=e.children[0].style;n.display=i?"":"none",n.height=n.lineHeight=t.view_body.style.top=i+"px"},this.icon=function(t,e,i){var n=e.children[0].children[0];n.className="flyingon-Dialog-icon "+i,n.style.display=i?"":"none"},this.title=function(t,e,i){e.children[0].children[1][this.__text_name]=i},this.closable=function(t,e,i){e.children[0].children[2].style.display=i?"":"none"},this.show=function(t,e,i,n){var r,s=document.body;t.trigger("open"),t.measure(0,0),null==e&&(e=t.boxModel.offsetWidth,e=s.clientWidth-e>>1),null==i&&(i=t.boxModel.offsetHeight,i=((window.innerHeight||document.documentElement.clientHeight)-i>>1)-s.clientLeft),t.locate(0|e,0|i),(r=t.view)?s.appendChild(r):r=this.createView(t,s),flyingon.dom_overlay(r),t.shown=!0},this.movable=function(t,e){e=e.original_event,e.dom=t.view,flyingon.dom_drag(t,e),e.dom=null},this.close=function(t){var e,i=t.view;(e=i.parentNode)&&e.removeChild(i),i.flyingon_overlay&&flyingon.dom_overlay(i,!1)}}),flyingon.dom_test(function(t){var e=flyingon.pixel_unit.unit;t.innerHTML='<div style="position:absolute;left:-10000in;"></div><div style="position:absolute;overflow:scroll;left:-10000em;top:-10000ex;width:100px;height:100px;"><div style="width:200px;height:200px;"></div></div>',e.px=1,e.pt=(e.pc=(e["in"]=-t.children[0].offsetLeft/1e4)/6)/12,e.mm=(e.cm=e["in"]/2.54)/10,t=t.children[1],e.em=e.rem=-t.offsetLeft/1e4,e.ex=-t.offsetTop/1e4,flyingon.vscroll_width=t.offsetWidth-t.clientWidth,flyingon.hscroll_height=t.offsetHeight-t.clientHeight}),function(t,e){function i(){for(var t,e,i=b,n=0;t=i[n++];)t.__delay_update=!1,t.__update_dirty>1&&(e=t.view)&&(e=e.parentNode)&&(t.measure(e.clientWidth,e.clientHeight),t.locate(0,0)),t.update();i.length=0,(n=c)&&(clearTimeout(n),c=0)}function n(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new d(e))}function r(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger(new g(e))}function s(t,e){var i,n,r=this.boxModel,s=this.view,o=s.getBoundingClientRect(),a=0,l="";return"x"!==t&&(i=e.clientY-o.top,i>=0&&i<=4?(a=1,l="s"):(n=r.offsetHeight,i>=n-4&&i<=n&&(a=2,l="n"))),"y"!==t&&(i=e.clientX-o.left,i>=0&&i<=4?(a|=4,l+="e"):(n=r.offsetWidth,i>=n-4&&i<=n&&(a|=8,l+="w"))),s.style.cursor=l?l+"-resize":this.cursor(),a}function o(t){var e=t.side;1===(1&e)?this.height(t.height-t.distanceY):2===(2&e)&&this.height(t.height+t.distanceY),4===(4&e)?this.width(t.width-t.distanceX):8===(8&e)&&this.width(t.width+t.distanceX)}function a(t){if(this.trigger("move-start")!==!1){var i,n=this.view,r=n.cloneNode(!0),s=n.style,o=n.getBoundingClientRect(),a={dom:r,left:o.left,top:o.top},l=this;for(s.borderStyle="dashed",s.borderColor="red",s=r.style,s.opacity=.2,s.left=o.left+"px",s.top=o.top+"px",e.body.appendChild(r);i=l.parent;)l=i;return o=l.view.getBoundingClientRect(),a.host=l,a.offsetX=t.clientX-o.left,a.offsetY=t.clientY-o.top,a}}function l(t,e){var i=t.dom.style,n=t.distanceX,r=t.distanceY,s=t.host.findDropTarget(t.offsetX+n,t.offsetY+r),o=s[0],a=s[1];a?this!==a&&o.insertBefore(this,a):this.parent!==o,i.left=t.left+n+"px",i.top=t.top+r+"px",this.trigger("move")}function h(t,e){var i,n=t.dom,r=n.style,s=this.view.style;(i=n.parentNode)&&i.removeChild(n),s.borderStyle=r.borderStyle,s.borderColor=r.borderColor,this.trigger("move-end")}function f(e){if(f.disabled)return!0;var i=t.findControl(e.target);if(i&&!i.disabled()&&i.canFocus()&&i.trigger("focus")!==!1)i.focus(),t.activeControl=i;else if(i=t.activeControl)try{f.disabled=!0,i.renderer.focus(i)}finally{f.disabled=!1}}function u(e){var i=t.findControl(e.target);i&&i===t.activeControl&&i.trigger("blur")!==!1&&(i.blur(),t.activeControl=null)}var c,d=t.MouseEvent,g=t.KeyEvent,_=t.dom_on,p=null,y=0,v=null,m=null,b=[];t.__delay_update=function(t){var e=b;t&&!t.__delay_update&&(t.__delay_update=!0,e.push(t),c||(c=setTimeout(i,0)))},t.showControl=function(i,n){i&&!i.__top_control&&t.ready(function(){var t=n;this.__top_control=!0,"string"==typeof t&&(t=e.getElementById(t)),t=t||e.body,this.measure(t.clientWidth,t.clientHeight),this.locate(0,0),this.view||(this.renderer.createView(this,t).style.position="relative"),i=n=null},i)},t.hideControl=function(e,i){var n,r;e&&e.__top_control&&(e.__top_control=!1,t.__type_query_cache&&t.__clear_type_query(e),(n=e.view)&&(r=n.parentNode)&&r.removeChild(n),(r=e.parent)&&r.remove(e),i!==!1&&e.dispose())},t.findControl=function(e){for(var i;e;){if(i=e.flyingon_id)return t.__uniqueId_controls[i];e=e.parentNode}},_(e,"mousedown",function(i){var n,r,s=t.findControl(i.target);s&&!s.disabled()&&s.trigger(p=new d(i))!==!1&&((r=y)?y={side:r,width:(r=s.boxModel).offsetWidth,height:r.offsetHeight}:(n=s.parent)&&s.movable()&&(r=v=(s.__move_start||a).call(s,i)),r&&(r=s.view)&&(r.setCapture&&r.setCapture(),r=e.body,m=r.ondragstart,r.ondragstart=function(){return!1}))}),_(e,"mousemove",function(e){var i,n,r=p;if(r&&(i=r.target)){var a=e.clientX-r.clientX,h=e.clientY-r.clientY;(n=y)?(n.distanceX=a,n.distanceY=h,o.call(i,n)):(n=v)?(n.distanceX=a,n.distanceY=h,(i.__do_move||l).call(i,n,e)):(e=new d(e),e.mousedown=r,e.distanceX=a,e.distanceY=h,i.trigger(e))}else(i=t.findControl(e.target))&&!i.disabled()&&i.trigger(new d(e))!==!1&&"none"!==(n=i.resizable())&&(y=(i.__check_resize||s).call(i,n,e))}),_(e,"mouseup",function(i){var n,r,s=p;s&&(n=s.target)?((r=y)?y=0:(r=v)&&((n.__move_end||h).call(n,r,i),v=null),i=new d(i),i.mousedown=s,i.distanceX=i.clientX-s.clientX,i.distanceY=i.clientY-s.clientY,n.trigger(i),(r=n.view)&&(r.setCapture&&r.releaseCapture(),r=e.body,(r.ondragstart=m)&&(m=null)),p=null):(n=t.findControl(i.target))&&!n.disabled()&&n.trigger(new d(i))}),_(e,"click",n),_(e,"dblclick",n),_(e,"mouseover",n),_(e,"mouseout",n),_(e,"keydown",r),_(e,"keypress",r),_(e,"keyup",r),e.addEventListener?(_(e,"focus",f,!0),_(e,"blur",u,!0)):(_(e,"focusin",f),_(e,"focusout",u)),t.__dom_scroll=function(e){var i=t.findControl(this);if(i&&!i.disabled())if(i.trigger("scroll")!==!1)i.__do_scroll(i.scrollLeft=this.scrollLeft,i.scrollTop=this.scrollTop);else try{this.onscroll=null,this.scrollTop=i.scrollTop,this.scrollLeft=i.scrollLeft}finally{this.onscroll=scroll}},_(e,e.mozHidden?"DOMMouseScroll":"mousewheel",function(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger("mousewheel","original_event",e,"wheelDelta",e.wheelDelta||40*-e.detail||-120)}),_(e,"change",function(e){var i=t.findControl(e.target);i&&!i.disabled()&&i.trigger("change","original_event",e)})}(flyingon,document),flyingon.Ajax=flyingon.defineClass(flyingon.Async,function(){function t(t,i,n,r){var s,o=t.xhr=new XMLHttpRequest;if(n.start&&(i=i+n.start+n.join("&")),t.CORS&&("withCredentials"in o?o.withCredentials=!0:(s=window.XDomainRequest)&&(o=new s)),(s=t.timeout)>0&&(t.__timer=setTimeout(function(){o.abort(),t.fail("timeout")},s)),o.onreadystatechange=function(){e(t,o,i)},o.open(t.method,i,t.async),s=t.header)for(var a in s)o.setRequestHeader(a,s[a]);o.setRequestHeader("Content-Type",t.contentType),r&&(r=flyingon.encode(r),o.setRequestHeader("Content-Length",r.length)),o.send(r)}function e(t,e,n){var r=e.readyState;if(4===r){if((r=t.__timer)&&(clearTimeout(r),t.__timer=0,r=void 0),e.status<300)switch(t.dataType){case"json":try{t.resolve(JSON.parse(e.responseText))}catch(s){t.reject(s)}break;case"xml":t.resolve(e.responseXML);break;default:t.resolve(e.responseText)}else t.reject(r=e.statusText);i(t,n,r),t.xhr=t.onreadystatechange=null}else t.notify(r)}function i(t,e,i){var n=flyingon.Ajax.end;if(n)for(var r=0,s=n.length;r<s;r++)n[r].call(t,e,i)}function n(t,e,r){var s=n,o=s.cache||(s.cache=[]),a=o.pop()||"flyingon_callback"+(++s.id||(s.id=1));window[a]=function(n){t.resolve(n),i(t,e)},r.push(t.jsonp||"jsonp","=",a),t.version||r.push("jsonp-version="+(++s.version||(s.version=1))),flyingon.script(e=e+r.start+r.join("&"),function(n,r){o.push(a),r&&(t.reject(r),i(t,e,r)),window[a]=void 0,this.parentNode.removeChild(this),t=null})}function r(t,e,i,n){function r(){l?(this.contentWindow.location="about:blank",a(t,e,this.contentWindow.name),s(this),flyingon.dom_off(this,"load",r),t=h=i=n=null):(l=1,this.contentWindow.name=this.name,o(this,e,n,t.method))}var l,h=s();i.push("jsonp=post"),e=e+i.start+i.join("&"),flyingon.dom_on(h,"load",r),h.src="about:blank",document.head.appendChild(h)}function s(t){var e=s.cache||(s.cache=[]);return t?(e.push(t),void t.parentNode.removeChild(t)):(t=e.pop(),t||(t=document.createElement("iframe"),t.name="jsonp-iframe"),t)}function o(t,e,i,n){var r=['<form id="form" enctype="application/x-www-form-urlencoded"'];r.push(' action="',e,'" method="',"GET",'">');for(var s in i)r.push('<input type="hidden" name="',s,'"'),"string"==typeof(s=i[s])&&(s=s.replace(/"/g,'\\"')),r.push(' value="',s,'" />');r.push("</form>","<script>form.submit();</script>"),t.contentWindow.document.write(r.join(""))}function a(t,e,n){try{t.resolve(JSON.parse(n)),i(t,e)}catch(r){t.reject(r),i(t,e,r)}}this.url="",this.version="",this.method="GET",this.dataType="text",this.contentType="application/x-www-form-urlencoded",this.header=null,this.async=!0,this.CORS=!1,this.jsonp="jsonp",this.timeout=0,this.send=function(e,i){var s,o,a,l=[];if(i)for(var h in i)"data"!==h?this[h]=i[h]:s=i[h];if(a=flyingon.Ajax.start){for(var f=0,u=a.length;f<u;f++)if(a[f].call(this,e)===!1)return!1;e=this.url}return!!(this.url=e)&&((o=/get|head|options/i.test(this.method))&&s&&(l.push(flyingon.encode(s)),s=null),a="jsonp"===this.dataType,this.version&&l.push("ajax-version=",this.version),(a||l.length>0)&&(l.start=e.indexOf("?")>=0?"&":"?"),a=a?o?n:r:t,a(this,e,l,s),this)}},!1),flyingon.ajaxStart=function(t){(flyingon.Ajax.start||(flyingon.Ajax.start=[])).push(t)},flyingon.ajaxEnd=function(t){(flyingon.Ajax.end||(flyingon.Ajax.end=[])).push(t)},flyingon.ajax=function(t,e){return(new flyingon.Ajax).send(t,e)},flyingon.ajaxPost=function(t,e){return e=e||{},e.method="POST",(new flyingon.Ajax).send(t,e)},flyingon.jsonp=function(t,e){return e=e||{},e.dataType="jsonp",(new flyingon.Ajax).send(t,e)},flyingon.jsonpPost=function(t,e){return e=e||{},e.dataType="jsonp",e.method="POST",(new flyingon.Ajax).send(t,e)},function(t){function e(e){var i,s,o=r,a=o;if(i=e.match(/\w+/g)){for(var l=0,h=i.length;l<h;l++)(s=a[e=i[l]])?a=s:(s=(s=a.moduleName)?s+"."+e:e,a=o[s]=a[e]=n(null),a.moduleName=s);return a}t.raise("flyingon","error.module_name")}function i(e,i){"function"==typeof i&&i.call(t,e)}var n=t.create,r=t.moudles=n(null);t.moduleName="flyingon",r.flyingon=t,t.use=function(i){switch(typeof i){case"string":return r[i]||e(i);case"object":return i||t}return t},t.defineModule=function(n,s,o){var a,l;switch(typeof n){case"string":if(a=r[n]||e(n),"function"==typeof s)return s.call(t,a),a;break;case"function":return n.call(t,t),t;case"object":return n||t}return s&&t.require(s),"function"==typeof o&&((l=t.require)&&(l=l.callback)&&l(i,[a,o])||i(a,o)),t}}(flyingon),function(t){function e(i,n){if(i){switch(typeof i){case"string":return void e.require([e.path(i)],n);case"function":return void i.call(t,t)}if(i instanceof Array){for(var r,s=[],o=0,a=i.length;o<a;o++)(r=i[o])&&"string"==typeof r&&s.push(e.path(r));if(s.length>0)return void e.require(s,n)}}"function"==typeof n&&n.call(t,t)}var i=t.create,n="",r=i(null),s=i(null),o=i(null),a=i(null),l=i(null),h={layout:"default",skin:"default",i18n:navigator.language||"zh-CN"};e.__root_path="",e.__base_path="",e.base=function(t){return void 0===t?e.__base_path:(t&&"string"==typeof t?("/"===t.charAt(0)?t=e.__root_path+t.substring(1):t.indexOf("://")<0&&(t=e.__root_path+t),"/"!==t.charAt(t.length-1)&&(t+="/")):t=e.__root_path,void(t.__base_path=t))},e.version=function(t,e){if("string"==typeof t?n=t:e=t,e){var i=r;for(var s in e)i[s]=e[s]}},e.merge=function(t){if(t){var e,i=o;for(var n in t)if("string"==typeof(e=t[n]))i[e]=n;else for(var r=0,s=e.length;r<s;r++)i[e[r]]=n}},e.path=function(t,i){var a,f,u,c=t=o[t]||t;if(u=s[c])return u;if((f=t.indexOf("{"))>=0&&(u=t.indexOf("}"))>f&&(a=t.substring(f+1,u))&&(u=h[a])){if(c=t.replace("{"+a+"}",u),u=s[c])return u}else i=!1;return u=(u=r[t]||n)?c+(t.indexOf("?")>=0?"&":"?")+"require-version="+u:c,"/"===t.charAt(0)?u=e.__root_path+u.substring(1):t.indexOf("://")<0&&(u=e.__base_path+u),i!==!1&&((l[a]||(l[a]={}))[u]=t),s[c]=u},e.key=function(t,i,n,r){var s=h;return i?void(i&&s[t]!==i&&(s[t]=i,r&&r(),(s=l[t])&&e.__change_require(s,t,n))):s[t]},t.skin=function(t){return e.key("skin",t)},t.i18ntext=function(t){return a[t]||t},t.i18n=function(t){return e.key("i18n",t,null,function(){a=i(null)})},t.i18nlist=function(t,e){if("object"==typeof t&&(e=t,t=null),!e)return a;var i=a;if(t){t+=".";for(var n in e)i[t+n]=e[n]}else for(t in e)i[t]=e[t]},e.raise={flyingon:"flyingon/i18n/{i18n}.js"},t.raise=function(t,i){var n;if(t){if(void 0!==(n=a[t])||!i)throw n||t;i=e.translate[i]||i,e.require([e.path(i)],function(){throw a[name]||t})}},t.require=e}(flyingon),function(t){function e(e){e.sort(function(t,e){return Math.random()>.5?-1:1});for(var n,r=l,s=0,o=e.length;s<o;s++)r[n=e[s]]||(r[n]=1,f++,t.script(n,i))}function i(){var t=l,i=h,s=u,o=--f,a=this.src,c=s.indexOf(a);c>=0&&s.splice(c,1),s.length>0?(u=[],t[a]=2,s.src=a,e(s)):(t[a]=3,n(t,i,a)),o||r(t,i)}function n(e,i,r){var s,o,a,l=i[r];if(delete i[r],l){for(var h=l.length-1;h>=0;h--)if(s=l[h],(a=s.indexOf(r))>=0&&s.splice(a,1),!(s.length>0)&&(l.splice(h,1),(a=s.src)&&(e[a]=3,(o||(o=[])).push(a)),a=s.callback)){s.callback=null;for(var f=0,u=a.length;f<u;f++)a[f++].apply(t,a[f])}if(o)for(var h=0,u=o.length;h<u;h++)n(e,i,o[h])}}function r(t,e){var i,r,o=[];for(i in e)o.push(i);for(var a=o.length-1;a>=0;a--)if((r=e[i=o[a]])&&s(e,r,i))for(var l=a;l>=0;l--)if(r=e[o[l]])for(var h=r.length-1;h>=0;h--)if(r[h]&&r[h].src===i){n(t,e,i);break}}function s(t,e,i){for(var n,r,o=e.length-1;o>=0;o--)if((r=e[o])&&(n=r.src)){if(n===i)return!0;if((r=t[n])&&s(t,r,i))return!0}}var o=t.create,a=t.require,l=o(null),h=o(null),f=0,u=[];a.__root_path=a.__base_path=t.absoluteUrl("/"),a.__change_require=function(t,e,i){for(var n,r=document.getElementsByTagName("skin"===e?"link":"script"),t=l,s=r.length-1;s>=0;s--)(n=r[s])&&t[n.src||n.href]&&n.parentNode.removeChild(n);r=[];for(n in t)t[n]=0,r.push(a.path(t[n]));a.require(r,i||function(){})},a.callback=function(e,i){var n=u;if(n&&n.length>0)return(n.callback||(n.callback=[])).push(e,i||[t]),!0},a.require=function(i,n){var r,s,o,a,f=l,c=h;r=n?[]:u;for(var d=0,g=i.length;d<g;d++)(s=i[d])&&3!==(a=f[s])&&(s.indexOf(o||".css")>0?a||(f[s]=3,t.link(s)):r[s]||(r[s]=!0,r.push(s),(c[s]||(c[s]=[])).push(r)));n&&(r.length>0?(r.callback=[n,[t]],e(r)):n.call(t,t))}}(flyingon);